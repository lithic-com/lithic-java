// File generated from our OpenAPI spec by Stainless.

package com.lithic.api.models

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import com.lithic.api.core.JsonValue
import com.lithic.api.core.jsonMapper
import com.lithic.api.errors.LithicInvalidDataException
import java.time.LocalDate
import java.time.OffsetDateTime
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test
import org.junit.jupiter.api.assertThrows
import org.junit.jupiter.params.ParameterizedTest
import org.junit.jupiter.params.provider.EnumSource

internal class ParsedWebhookEventTest {

    @Test
    fun ofAccountHolderCreated() {
        val accountHolderCreated =
            AccountHolderCreatedWebhookEvent.builder()
                .eventType(AccountHolderCreatedWebhookEvent.EventType.ACCOUNT_HOLDER_CREATED)
                .token("00000000-0000-0000-0000-000000000001")
                .accountToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .addRequiredDocument(
                    RequiredDocument.builder()
                        .entityToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .addStatusReason("string")
                        .addValidDocument("string")
                        .build()
                )
                .status(AccountHolderCreatedWebhookEvent.Status.ACCEPTED)
                .addStatusReason("string")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofAccountHolderCreated(accountHolderCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).contains(accountHolderCreated)
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofAccountHolderCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofAccountHolderCreated(
                AccountHolderCreatedWebhookEvent.builder()
                    .eventType(AccountHolderCreatedWebhookEvent.EventType.ACCOUNT_HOLDER_CREATED)
                    .token("00000000-0000-0000-0000-000000000001")
                    .accountToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .addRequiredDocument(
                        RequiredDocument.builder()
                            .entityToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .addStatusReason("string")
                            .addValidDocument("string")
                            .build()
                    )
                    .status(AccountHolderCreatedWebhookEvent.Status.ACCEPTED)
                    .addStatusReason("string")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofKybPayload() {
        val kybPayload =
            ParsedWebhookEvent.KybPayload.builder()
                .token("00000000-0000-0000-0000-000000000001")
                .updateRequest(
                    ParsedWebhookEvent.KybPayload.UpdateRequest.builder()
                        .addBeneficialOwnerEntity(
                            KybBusinessEntity.builder()
                                .address(
                                    KybBusinessEntity.Address.builder()
                                        .address1("123 Old Forest Way")
                                        .city("Omaha")
                                        .country("USA")
                                        .postalCode("68022")
                                        .state("NE")
                                        .address2("address2")
                                        .build()
                                )
                                .governmentId("114-123-1513")
                                .legalBusinessName("Acme, Inc.")
                                .addPhoneNumber("+15555555555")
                                .dbaBusinessName("dba_business_name")
                                .parentCompany("parent_company")
                                .build()
                        )
                        .addBeneficialOwnerIndividual(
                            ParsedWebhookEvent.KybPayload.UpdateRequest.Individual.builder()
                                .address(
                                    ParsedWebhookEvent.KybPayload.UpdateRequest.Individual.Address
                                        .builder()
                                        .address1("123 Old Forest Way")
                                        .city("Omaha")
                                        .country("USA")
                                        .postalCode("68022")
                                        .state("NE")
                                        .address2("address2")
                                        .build()
                                )
                                .dob("1991-03-08 08:00:00")
                                .email("tom@middle-earth.com")
                                .firstName("Tom")
                                .governmentId("111-23-1412")
                                .lastName("Bombadil")
                                .phoneNumber("+15555555555")
                                .build()
                        )
                        .businessEntity(
                            KybBusinessEntity.builder()
                                .address(
                                    KybBusinessEntity.Address.builder()
                                        .address1("123 Old Forest Way")
                                        .city("Omaha")
                                        .country("USA")
                                        .postalCode("68022")
                                        .state("NE")
                                        .address2("address2")
                                        .build()
                                )
                                .governmentId("114-123-1513")
                                .legalBusinessName("Acme, Inc.")
                                .addPhoneNumber("+15555555555")
                                .dbaBusinessName("dba_business_name")
                                .parentCompany("parent_company")
                                .build()
                        )
                        .controlPerson(
                            ParsedWebhookEvent.KybPayload.UpdateRequest.Individual.builder()
                                .address(
                                    ParsedWebhookEvent.KybPayload.UpdateRequest.Individual.Address
                                        .builder()
                                        .address1("123 Old Forest Way")
                                        .city("Omaha")
                                        .country("USA")
                                        .postalCode("68022")
                                        .state("NE")
                                        .address2("address2")
                                        .build()
                                )
                                .dob("1991-03-08 08:00:00")
                                .email("tom@middle-earth.com")
                                .firstName("Tom")
                                .governmentId("111-23-1412")
                                .lastName("Bombadil")
                                .phoneNumber("+15555555555")
                                .build()
                        )
                        .build()
                )
                .eventType(ParsedWebhookEvent.KybPayload.EventType.ACCOUNT_HOLDER_UPDATED)
                .externalId("external_id")
                .natureOfBusiness("Software company selling solutions to the restaurant industry")
                .websiteUrl("www.mybusiness.com")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofKybPayload(kybPayload)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).contains(kybPayload)
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofKybPayloadRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofKybPayload(
                ParsedWebhookEvent.KybPayload.builder()
                    .token("00000000-0000-0000-0000-000000000001")
                    .updateRequest(
                        ParsedWebhookEvent.KybPayload.UpdateRequest.builder()
                            .addBeneficialOwnerEntity(
                                KybBusinessEntity.builder()
                                    .address(
                                        KybBusinessEntity.Address.builder()
                                            .address1("123 Old Forest Way")
                                            .city("Omaha")
                                            .country("USA")
                                            .postalCode("68022")
                                            .state("NE")
                                            .address2("address2")
                                            .build()
                                    )
                                    .governmentId("114-123-1513")
                                    .legalBusinessName("Acme, Inc.")
                                    .addPhoneNumber("+15555555555")
                                    .dbaBusinessName("dba_business_name")
                                    .parentCompany("parent_company")
                                    .build()
                            )
                            .addBeneficialOwnerIndividual(
                                ParsedWebhookEvent.KybPayload.UpdateRequest.Individual.builder()
                                    .address(
                                        ParsedWebhookEvent.KybPayload.UpdateRequest.Individual
                                            .Address
                                            .builder()
                                            .address1("123 Old Forest Way")
                                            .city("Omaha")
                                            .country("USA")
                                            .postalCode("68022")
                                            .state("NE")
                                            .address2("address2")
                                            .build()
                                    )
                                    .dob("1991-03-08 08:00:00")
                                    .email("tom@middle-earth.com")
                                    .firstName("Tom")
                                    .governmentId("111-23-1412")
                                    .lastName("Bombadil")
                                    .phoneNumber("+15555555555")
                                    .build()
                            )
                            .businessEntity(
                                KybBusinessEntity.builder()
                                    .address(
                                        KybBusinessEntity.Address.builder()
                                            .address1("123 Old Forest Way")
                                            .city("Omaha")
                                            .country("USA")
                                            .postalCode("68022")
                                            .state("NE")
                                            .address2("address2")
                                            .build()
                                    )
                                    .governmentId("114-123-1513")
                                    .legalBusinessName("Acme, Inc.")
                                    .addPhoneNumber("+15555555555")
                                    .dbaBusinessName("dba_business_name")
                                    .parentCompany("parent_company")
                                    .build()
                            )
                            .controlPerson(
                                ParsedWebhookEvent.KybPayload.UpdateRequest.Individual.builder()
                                    .address(
                                        ParsedWebhookEvent.KybPayload.UpdateRequest.Individual
                                            .Address
                                            .builder()
                                            .address1("123 Old Forest Way")
                                            .city("Omaha")
                                            .country("USA")
                                            .postalCode("68022")
                                            .state("NE")
                                            .address2("address2")
                                            .build()
                                    )
                                    .dob("1991-03-08 08:00:00")
                                    .email("tom@middle-earth.com")
                                    .firstName("Tom")
                                    .governmentId("111-23-1412")
                                    .lastName("Bombadil")
                                    .phoneNumber("+15555555555")
                                    .build()
                            )
                            .build()
                    )
                    .eventType(ParsedWebhookEvent.KybPayload.EventType.ACCOUNT_HOLDER_UPDATED)
                    .externalId("external_id")
                    .natureOfBusiness(
                        "Software company selling solutions to the restaurant industry"
                    )
                    .websiteUrl("www.mybusiness.com")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofKycPayload() {
        val kycPayload =
            ParsedWebhookEvent.KycPayload.builder()
                .token("00000000-0000-0000-0000-000000000001")
                .updateRequest(
                    ParsedWebhookEvent.KycPayload.UpdateRequest.builder()
                        .individual(
                            ParsedWebhookEvent.KycPayload.UpdateRequest.Individual.builder()
                                .address(
                                    ParsedWebhookEvent.KycPayload.UpdateRequest.Individual.Address
                                        .builder()
                                        .address1("123 Old Forest Way")
                                        .city("Omaha")
                                        .country("USA")
                                        .postalCode("68022")
                                        .state("NE")
                                        .address2("address2")
                                        .build()
                                )
                                .dob("1991-03-08 08:00:00")
                                .email("tom@middle-earth.com")
                                .firstName("Tom")
                                .governmentId("111-23-1412")
                                .lastName("Bombadil")
                                .phoneNumber("+15555555555")
                                .build()
                        )
                        .build()
                )
                .eventType(ParsedWebhookEvent.KycPayload.EventType.ACCOUNT_HOLDER_UPDATED)
                .externalId("external_id")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofKycPayload(kycPayload)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).contains(kycPayload)
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofKycPayloadRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofKycPayload(
                ParsedWebhookEvent.KycPayload.builder()
                    .token("00000000-0000-0000-0000-000000000001")
                    .updateRequest(
                        ParsedWebhookEvent.KycPayload.UpdateRequest.builder()
                            .individual(
                                ParsedWebhookEvent.KycPayload.UpdateRequest.Individual.builder()
                                    .address(
                                        ParsedWebhookEvent.KycPayload.UpdateRequest.Individual
                                            .Address
                                            .builder()
                                            .address1("123 Old Forest Way")
                                            .city("Omaha")
                                            .country("USA")
                                            .postalCode("68022")
                                            .state("NE")
                                            .address2("address2")
                                            .build()
                                    )
                                    .dob("1991-03-08 08:00:00")
                                    .email("tom@middle-earth.com")
                                    .firstName("Tom")
                                    .governmentId("111-23-1412")
                                    .lastName("Bombadil")
                                    .phoneNumber("+15555555555")
                                    .build()
                            )
                            .build()
                    )
                    .eventType(ParsedWebhookEvent.KycPayload.EventType.ACCOUNT_HOLDER_UPDATED)
                    .externalId("external_id")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofLegacyPayload() {
        val legacyPayload =
            ParsedWebhookEvent.LegacyPayload.builder()
                .token("00000000-0000-0000-0000-000000000001")
                .businessAccountToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .email("johnny@lithic.com")
                .eventType(ParsedWebhookEvent.LegacyPayload.EventType.ACCOUNT_HOLDER_UPDATED)
                .externalId("00000000-0000-0000-0000-000000000001")
                .firstName("Johnny")
                .lastName("Appleseed")
                .legalBusinessName("Lithic")
                .phoneNumber("+15555555555")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofLegacyPayload(legacyPayload)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).contains(legacyPayload)
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofLegacyPayloadRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofLegacyPayload(
                ParsedWebhookEvent.LegacyPayload.builder()
                    .token("00000000-0000-0000-0000-000000000001")
                    .businessAccountToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .email("johnny@lithic.com")
                    .eventType(ParsedWebhookEvent.LegacyPayload.EventType.ACCOUNT_HOLDER_UPDATED)
                    .externalId("00000000-0000-0000-0000-000000000001")
                    .firstName("Johnny")
                    .lastName("Appleseed")
                    .legalBusinessName("Lithic")
                    .phoneNumber("+15555555555")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofAccountHolderVerification() {
        val accountHolderVerification =
            AccountHolderVerificationWebhookEvent.builder()
                .eventType(
                    AccountHolderVerificationWebhookEvent.EventType.ACCOUNT_HOLDER_VERIFICATION
                )
                .token("00000000-0000-0000-0000-000000000001")
                .accountToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .status(AccountHolderVerificationWebhookEvent.Status.ACCEPTED)
                .addStatusReason("string")
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofAccountHolderVerification(accountHolderVerification)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification())
            .contains(accountHolderVerification)
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofAccountHolderVerificationRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofAccountHolderVerification(
                AccountHolderVerificationWebhookEvent.builder()
                    .eventType(
                        AccountHolderVerificationWebhookEvent.EventType.ACCOUNT_HOLDER_VERIFICATION
                    )
                    .token("00000000-0000-0000-0000-000000000001")
                    .accountToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .status(AccountHolderVerificationWebhookEvent.Status.ACCEPTED)
                    .addStatusReason("string")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofAccountHolderDocumentUpdated() {
        val accountHolderDocumentUpdated =
            AccountHolderDocumentUpdatedWebhookEvent.builder()
                .eventType(
                    AccountHolderDocumentUpdatedWebhookEvent.EventType
                        .ACCOUNT_HOLDER_DOCUMENT_UPDATED
                )
                .token("9175a05c-a9da-4082-8e14-9296427ebba7")
                .accountHolderToken("2b52494a-ae73-4ab1-97e8-2dd1d51d18b0")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .documentType(AccountHolderDocumentUpdatedWebhookEvent.DocumentType.DRIVERS_LICENSE)
                .entityToken("c5f2d594-d957-4781-8877-fbea31f5944a")
                .addRequiredDocumentUpload(
                    AccountHolderDocumentUpdatedWebhookEvent.RequiredDocumentUpload.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .addAcceptedEntityStatusReason("string")
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .imageType(
                            AccountHolderDocumentUpdatedWebhookEvent.RequiredDocumentUpload
                                .ImageType
                                .FRONT
                        )
                        .addRejectedEntityStatusReason("string")
                        .status(
                            AccountHolderDocumentUpdatedWebhookEvent.RequiredDocumentUpload
                                .DocumentUploadStatus
                                .ACCEPTED
                        )
                        .addStatusReason("string")
                        .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofAccountHolderDocumentUpdated(accountHolderDocumentUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated())
            .contains(accountHolderDocumentUpdated)
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofAccountHolderDocumentUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofAccountHolderDocumentUpdated(
                AccountHolderDocumentUpdatedWebhookEvent.builder()
                    .eventType(
                        AccountHolderDocumentUpdatedWebhookEvent.EventType
                            .ACCOUNT_HOLDER_DOCUMENT_UPDATED
                    )
                    .token("9175a05c-a9da-4082-8e14-9296427ebba7")
                    .accountHolderToken("2b52494a-ae73-4ab1-97e8-2dd1d51d18b0")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .documentType(
                        AccountHolderDocumentUpdatedWebhookEvent.DocumentType.DRIVERS_LICENSE
                    )
                    .entityToken("c5f2d594-d957-4781-8877-fbea31f5944a")
                    .addRequiredDocumentUpload(
                        AccountHolderDocumentUpdatedWebhookEvent.RequiredDocumentUpload.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .addAcceptedEntityStatusReason("string")
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .imageType(
                                AccountHolderDocumentUpdatedWebhookEvent.RequiredDocumentUpload
                                    .ImageType
                                    .FRONT
                            )
                            .addRejectedEntityStatusReason("string")
                            .status(
                                AccountHolderDocumentUpdatedWebhookEvent.RequiredDocumentUpload
                                    .DocumentUploadStatus
                                    .ACCEPTED
                            )
                            .addStatusReason("string")
                            .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .build()
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardAuthorizationApprovalRequest() {
        val cardAuthorizationApprovalRequest =
            CardAuthorizationApprovalRequestWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .acquirerFee(0L)
                .amount(0L)
                .authorizationAmount(0L)
                .avs(
                    CardAuthorizationApprovalRequestWebhookEvent.Avs.builder()
                        .address("address")
                        .addressOnFileMatch(
                            CardAuthorizationApprovalRequestWebhookEvent.Avs.AddressMatchResult
                                .MATCH
                        )
                        .zipcode("zipcode")
                        .build()
                )
                .card(
                    CardAuthorizationApprovalRequestWebhookEvent.AsaRequestCard.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .hostname("hostname")
                        .lastFour("last_four")
                        .memo("memo")
                        .spendLimit(0L)
                        .spendLimitDuration(
                            CardAuthorizationApprovalRequestWebhookEvent.AsaRequestCard
                                .SpendLimitDuration
                                .ANNUALLY
                        )
                        .state(
                            CardAuthorizationApprovalRequestWebhookEvent.AsaRequestCard.State.CLOSED
                        )
                        .type(
                            CardAuthorizationApprovalRequestWebhookEvent.AsaRequestCard.CardType
                                .SINGLE_USE
                        )
                        .build()
                )
                .cardholderCurrency("cardholder_currency")
                .cashAmount(0L)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventType(
                    CardAuthorizationApprovalRequestWebhookEvent.EventType
                        .CARD_AUTHORIZATION_APPROVAL_REQUEST
                )
                .merchant(
                    Merchant.builder()
                        .acceptorId("333301802529120")
                        .acquiringInstitutionId("191231")
                        .city("NEW YORK")
                        .country("USA")
                        .descriptor("COFFEE SHOP")
                        .mcc("5812")
                        .state("NY")
                        .build()
                )
                .merchantAmount(0L)
                .merchantCurrency("USD")
                .settledAmount(0L)
                .status(CardAuthorizationApprovalRequestWebhookEvent.AsaRequestStatus.AUTHORIZATION)
                .transactionInitiator(
                    CardAuthorizationApprovalRequestWebhookEvent.TransactionInitiator.CARDHOLDER
                )
                .accountType(CardAuthorizationApprovalRequestWebhookEvent.AccountType.CHECKING)
                .cardholderAuthentication(
                    CardholderAuthentication.builder()
                        .authenticationMethod(
                            CardholderAuthentication.AuthenticationMethod.FRICTIONLESS
                        )
                        .authenticationResult(CardholderAuthentication.AuthenticationResult.SUCCESS)
                        .decisionMadeBy(CardholderAuthentication.DecisionMadeBy.LITHIC_RULES)
                        .liabilityShift(CardholderAuthentication.LiabilityShift._3DS_AUTHENTICATED)
                        .threeDSAuthenticationToken("a6e372d0-b40a-43eb-b0d1-4e1aebef5875")
                        .build()
                )
                .cashback(0L)
                .conversionRate(0.0)
                .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .fleetInfo(
                    CardAuthorizationApprovalRequestWebhookEvent.AsaRequestFleetInfo.builder()
                        .fleetPromptCode(
                            CardAuthorizationApprovalRequestWebhookEvent.AsaRequestFleetInfo
                                .FleetPromptCode
                                .NO_PROMPT
                        )
                        .fleetRestrictionCode(
                            CardAuthorizationApprovalRequestWebhookEvent.AsaRequestFleetInfo
                                .FleetRestrictionCode
                                .NO_RESTRICTIONS
                        )
                        .driverNumber("driver_number")
                        .vehicleNumber("vehicle_number")
                        .build()
                )
                .latestChallenge(
                    CardAuthorizationApprovalRequestWebhookEvent.LatestChallenge.builder()
                        .phoneNumber("phone_number")
                        .status(
                            CardAuthorizationApprovalRequestWebhookEvent.LatestChallenge.Status
                                .COMPLETED
                        )
                        .completedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .network(CardAuthorizationApprovalRequestWebhookEvent.Network.AMEX)
                .networkRiskScore(0L)
                .networkSpecificData(
                    CardAuthorizationApprovalRequestWebhookEvent.AsaNetworkSpecificData.builder()
                        .mastercard(
                            CardAuthorizationApprovalRequestWebhookEvent.AsaNetworkSpecificData
                                .AsaNetworkSpecificDataMastercard
                                .builder()
                                .ecommerceSecurityLevelIndicator("xxx")
                                .addOnBehalfServiceResult(
                                    CardAuthorizationApprovalRequestWebhookEvent
                                        .AsaNetworkSpecificData
                                        .AsaNetworkSpecificDataMastercard
                                        .OnBehalfServiceResult
                                        .builder()
                                        .result1("x")
                                        .result2("x")
                                        .service("xx")
                                        .build()
                                )
                                .transactionTypeIdentifier("xxx")
                                .build()
                        )
                        .visa(
                            CardAuthorizationApprovalRequestWebhookEvent.AsaNetworkSpecificData
                                .AsaNetworkSpecificDataVisa
                                .builder()
                                .businessApplicationIdentifier("xx")
                                .build()
                        )
                        .build()
                )
                .pos(
                    CardAuthorizationApprovalRequestWebhookEvent.Pos.builder()
                        .entryMode(
                            CardAuthorizationApprovalRequestWebhookEvent.Pos.AsaRequestPosEntryMode
                                .builder()
                                .card(
                                    CardAuthorizationApprovalRequestWebhookEvent.Pos
                                        .AsaRequestPosEntryMode
                                        .Card
                                        .PRESENT
                                )
                                .cardholder(
                                    CardAuthorizationApprovalRequestWebhookEvent.Pos
                                        .AsaRequestPosEntryMode
                                        .Cardholder
                                        .DEFERRED_BILLING
                                )
                                .pan(
                                    CardAuthorizationApprovalRequestWebhookEvent.Pos
                                        .AsaRequestPosEntryMode
                                        .Pan
                                        .AUTO_ENTRY
                                )
                                .pinEntered(true)
                                .build()
                        )
                        .terminal(
                            CardAuthorizationApprovalRequestWebhookEvent.Pos.AsaPosTerminal
                                .builder()
                                .attended(true)
                                .cardRetentionCapable(true)
                                .onPremise(true)
                                .operator(
                                    CardAuthorizationApprovalRequestWebhookEvent.Pos.AsaPosTerminal
                                        .Operator
                                        .ADMINISTRATIVE
                                )
                                .partialApprovalCapable(true)
                                .pinCapability(
                                    CardAuthorizationApprovalRequestWebhookEvent.Pos.AsaPosTerminal
                                        .PinCapability
                                        .CAPABLE
                                )
                                .type(
                                    CardAuthorizationApprovalRequestWebhookEvent.Pos.AsaPosTerminal
                                        .Type
                                        .ADMINISTRATIVE
                                )
                                .acceptorTerminalId(" r 0K9tW")
                                .build()
                        )
                        .build()
                )
                .tokenInfo(TokenInfo.builder().walletType(TokenInfo.WalletType.APPLE_PAY).build())
                .ttl(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardAuthorizationApprovalRequest(cardAuthorizationApprovalRequest)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest())
            .contains(cardAuthorizationApprovalRequest)
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardAuthorizationApprovalRequestRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardAuthorizationApprovalRequest(
                CardAuthorizationApprovalRequestWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .acquirerFee(0L)
                    .amount(0L)
                    .authorizationAmount(0L)
                    .avs(
                        CardAuthorizationApprovalRequestWebhookEvent.Avs.builder()
                            .address("address")
                            .addressOnFileMatch(
                                CardAuthorizationApprovalRequestWebhookEvent.Avs.AddressMatchResult
                                    .MATCH
                            )
                            .zipcode("zipcode")
                            .build()
                    )
                    .card(
                        CardAuthorizationApprovalRequestWebhookEvent.AsaRequestCard.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .hostname("hostname")
                            .lastFour("last_four")
                            .memo("memo")
                            .spendLimit(0L)
                            .spendLimitDuration(
                                CardAuthorizationApprovalRequestWebhookEvent.AsaRequestCard
                                    .SpendLimitDuration
                                    .ANNUALLY
                            )
                            .state(
                                CardAuthorizationApprovalRequestWebhookEvent.AsaRequestCard.State
                                    .CLOSED
                            )
                            .type(
                                CardAuthorizationApprovalRequestWebhookEvent.AsaRequestCard.CardType
                                    .SINGLE_USE
                            )
                            .build()
                    )
                    .cardholderCurrency("cardholder_currency")
                    .cashAmount(0L)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .eventType(
                        CardAuthorizationApprovalRequestWebhookEvent.EventType
                            .CARD_AUTHORIZATION_APPROVAL_REQUEST
                    )
                    .merchant(
                        Merchant.builder()
                            .acceptorId("333301802529120")
                            .acquiringInstitutionId("191231")
                            .city("NEW YORK")
                            .country("USA")
                            .descriptor("COFFEE SHOP")
                            .mcc("5812")
                            .state("NY")
                            .build()
                    )
                    .merchantAmount(0L)
                    .merchantCurrency("USD")
                    .settledAmount(0L)
                    .status(
                        CardAuthorizationApprovalRequestWebhookEvent.AsaRequestStatus.AUTHORIZATION
                    )
                    .transactionInitiator(
                        CardAuthorizationApprovalRequestWebhookEvent.TransactionInitiator.CARDHOLDER
                    )
                    .accountType(CardAuthorizationApprovalRequestWebhookEvent.AccountType.CHECKING)
                    .cardholderAuthentication(
                        CardholderAuthentication.builder()
                            .authenticationMethod(
                                CardholderAuthentication.AuthenticationMethod.FRICTIONLESS
                            )
                            .authenticationResult(
                                CardholderAuthentication.AuthenticationResult.SUCCESS
                            )
                            .decisionMadeBy(CardholderAuthentication.DecisionMadeBy.LITHIC_RULES)
                            .liabilityShift(
                                CardholderAuthentication.LiabilityShift._3DS_AUTHENTICATED
                            )
                            .threeDSAuthenticationToken("a6e372d0-b40a-43eb-b0d1-4e1aebef5875")
                            .build()
                    )
                    .cashback(0L)
                    .conversionRate(0.0)
                    .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .fleetInfo(
                        CardAuthorizationApprovalRequestWebhookEvent.AsaRequestFleetInfo.builder()
                            .fleetPromptCode(
                                CardAuthorizationApprovalRequestWebhookEvent.AsaRequestFleetInfo
                                    .FleetPromptCode
                                    .NO_PROMPT
                            )
                            .fleetRestrictionCode(
                                CardAuthorizationApprovalRequestWebhookEvent.AsaRequestFleetInfo
                                    .FleetRestrictionCode
                                    .NO_RESTRICTIONS
                            )
                            .driverNumber("driver_number")
                            .vehicleNumber("vehicle_number")
                            .build()
                    )
                    .latestChallenge(
                        CardAuthorizationApprovalRequestWebhookEvent.LatestChallenge.builder()
                            .phoneNumber("phone_number")
                            .status(
                                CardAuthorizationApprovalRequestWebhookEvent.LatestChallenge.Status
                                    .COMPLETED
                            )
                            .completedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .build()
                    )
                    .network(CardAuthorizationApprovalRequestWebhookEvent.Network.AMEX)
                    .networkRiskScore(0L)
                    .networkSpecificData(
                        CardAuthorizationApprovalRequestWebhookEvent.AsaNetworkSpecificData
                            .builder()
                            .mastercard(
                                CardAuthorizationApprovalRequestWebhookEvent.AsaNetworkSpecificData
                                    .AsaNetworkSpecificDataMastercard
                                    .builder()
                                    .ecommerceSecurityLevelIndicator("xxx")
                                    .addOnBehalfServiceResult(
                                        CardAuthorizationApprovalRequestWebhookEvent
                                            .AsaNetworkSpecificData
                                            .AsaNetworkSpecificDataMastercard
                                            .OnBehalfServiceResult
                                            .builder()
                                            .result1("x")
                                            .result2("x")
                                            .service("xx")
                                            .build()
                                    )
                                    .transactionTypeIdentifier("xxx")
                                    .build()
                            )
                            .visa(
                                CardAuthorizationApprovalRequestWebhookEvent.AsaNetworkSpecificData
                                    .AsaNetworkSpecificDataVisa
                                    .builder()
                                    .businessApplicationIdentifier("xx")
                                    .build()
                            )
                            .build()
                    )
                    .pos(
                        CardAuthorizationApprovalRequestWebhookEvent.Pos.builder()
                            .entryMode(
                                CardAuthorizationApprovalRequestWebhookEvent.Pos
                                    .AsaRequestPosEntryMode
                                    .builder()
                                    .card(
                                        CardAuthorizationApprovalRequestWebhookEvent.Pos
                                            .AsaRequestPosEntryMode
                                            .Card
                                            .PRESENT
                                    )
                                    .cardholder(
                                        CardAuthorizationApprovalRequestWebhookEvent.Pos
                                            .AsaRequestPosEntryMode
                                            .Cardholder
                                            .DEFERRED_BILLING
                                    )
                                    .pan(
                                        CardAuthorizationApprovalRequestWebhookEvent.Pos
                                            .AsaRequestPosEntryMode
                                            .Pan
                                            .AUTO_ENTRY
                                    )
                                    .pinEntered(true)
                                    .build()
                            )
                            .terminal(
                                CardAuthorizationApprovalRequestWebhookEvent.Pos.AsaPosTerminal
                                    .builder()
                                    .attended(true)
                                    .cardRetentionCapable(true)
                                    .onPremise(true)
                                    .operator(
                                        CardAuthorizationApprovalRequestWebhookEvent.Pos
                                            .AsaPosTerminal
                                            .Operator
                                            .ADMINISTRATIVE
                                    )
                                    .partialApprovalCapable(true)
                                    .pinCapability(
                                        CardAuthorizationApprovalRequestWebhookEvent.Pos
                                            .AsaPosTerminal
                                            .PinCapability
                                            .CAPABLE
                                    )
                                    .type(
                                        CardAuthorizationApprovalRequestWebhookEvent.Pos
                                            .AsaPosTerminal
                                            .Type
                                            .ADMINISTRATIVE
                                    )
                                    .acceptorTerminalId(" r 0K9tW")
                                    .build()
                            )
                            .build()
                    )
                    .tokenInfo(
                        TokenInfo.builder().walletType(TokenInfo.WalletType.APPLE_PAY).build()
                    )
                    .ttl(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofTokenizationDecisioningRequest() {
        val tokenizationDecisioningRequest =
            TokenizationDecisioningRequestWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2023-09-18T12:34:56Z"))
                .eventType(
                    TokenizationDecisioningRequestWebhookEvent.EventType
                        .DIGITAL_WALLET_TOKENIZATION_APPROVAL_REQUEST
                )
                .issuerDecision(TokenizationDecisioningRequestWebhookEvent.IssuerDecision.APPROVED)
                .tokenizationChannel(
                    TokenizationDecisioningRequestWebhookEvent.TokenizationChannel.DIGITAL_WALLET
                )
                .tokenizationToken("tok_1234567890abcdef")
                .walletDecisioningInfo(
                    WalletDecisioningInfo.builder()
                        .accountScore("100")
                        .deviceScore("100")
                        .recommendedDecision("Decision1")
                        .addRecommendationReason("Reason1")
                        .build()
                )
                .device(
                    Device.builder()
                        .imei("123456789012345")
                        .ipAddress("1.1.1.1")
                        .location("37.3860517/-122.0838511")
                        .build()
                )
                .digitalWalletTokenMetadata(
                    DigitalWalletTokenMetadata.builder()
                        .paymentAccountInfo(
                            DigitalWalletTokenMetadata.PaymentAccountInfo.builder()
                                .accountHolderData(
                                    DigitalWalletTokenMetadata.PaymentAccountInfo.AccountHolderData
                                        .builder()
                                        .phoneNumber("+15555555555")
                                        .build()
                                )
                                .panUniqueReference("pan_unique_ref_1234567890123456789012345678")
                                .paymentAccountReference("ref_1234567890123456789012")
                                .tokenUniqueReference(
                                    "token_unique_ref_1234567890123456789012345678"
                                )
                                .build()
                        )
                        .status("Pending")
                        .paymentAppInstanceId("app_instance_123456789012345678901234567890")
                        .tokenRequestorId("12345678901")
                        .tokenRequestorName(DigitalWalletTokenMetadata.TokenRequestorName.APPLE_PAY)
                        .build()
                )
                .tokenizationSource(
                    TokenizationDecisioningRequestWebhookEvent.TokenizationSource.PUSH_PROVISION
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationDecisioningRequest(tokenizationDecisioningRequest)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest())
            .contains(tokenizationDecisioningRequest)
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofTokenizationDecisioningRequestRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationDecisioningRequest(
                TokenizationDecisioningRequestWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2023-09-18T12:34:56Z"))
                    .eventType(
                        TokenizationDecisioningRequestWebhookEvent.EventType
                            .DIGITAL_WALLET_TOKENIZATION_APPROVAL_REQUEST
                    )
                    .issuerDecision(
                        TokenizationDecisioningRequestWebhookEvent.IssuerDecision.APPROVED
                    )
                    .tokenizationChannel(
                        TokenizationDecisioningRequestWebhookEvent.TokenizationChannel
                            .DIGITAL_WALLET
                    )
                    .tokenizationToken("tok_1234567890abcdef")
                    .walletDecisioningInfo(
                        WalletDecisioningInfo.builder()
                            .accountScore("100")
                            .deviceScore("100")
                            .recommendedDecision("Decision1")
                            .addRecommendationReason("Reason1")
                            .build()
                    )
                    .device(
                        Device.builder()
                            .imei("123456789012345")
                            .ipAddress("1.1.1.1")
                            .location("37.3860517/-122.0838511")
                            .build()
                    )
                    .digitalWalletTokenMetadata(
                        DigitalWalletTokenMetadata.builder()
                            .paymentAccountInfo(
                                DigitalWalletTokenMetadata.PaymentAccountInfo.builder()
                                    .accountHolderData(
                                        DigitalWalletTokenMetadata.PaymentAccountInfo
                                            .AccountHolderData
                                            .builder()
                                            .phoneNumber("+15555555555")
                                            .build()
                                    )
                                    .panUniqueReference(
                                        "pan_unique_ref_1234567890123456789012345678"
                                    )
                                    .paymentAccountReference("ref_1234567890123456789012")
                                    .tokenUniqueReference(
                                        "token_unique_ref_1234567890123456789012345678"
                                    )
                                    .build()
                            )
                            .status("Pending")
                            .paymentAppInstanceId("app_instance_123456789012345678901234567890")
                            .tokenRequestorId("12345678901")
                            .tokenRequestorName(
                                DigitalWalletTokenMetadata.TokenRequestorName.APPLE_PAY
                            )
                            .build()
                    )
                    .tokenizationSource(
                        TokenizationDecisioningRequestWebhookEvent.TokenizationSource.PUSH_PROVISION
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofAuthRulesBacktestReportCreated() {
        val authRulesBacktestReportCreated =
            AuthRulesBacktestReportCreatedWebhookEvent.builder()
                .backtestToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .results(
                    BacktestResults.Results.builder()
                        .currentVersion(
                            RuleStats.builder()
                                .approved(0L)
                                .challenged(0L)
                                .declined(0L)
                                .addExample(
                                    RuleStats.Example.builder()
                                        .approved(true)
                                        .decision(RuleStats.Example.Decision.APPROVED)
                                        .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .timestamp(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                        .build()
                                )
                                .version(0L)
                                .build()
                        )
                        .draftVersion(
                            RuleStats.builder()
                                .approved(0L)
                                .challenged(0L)
                                .declined(0L)
                                .addExample(
                                    RuleStats.Example.builder()
                                        .approved(true)
                                        .decision(RuleStats.Example.Decision.APPROVED)
                                        .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .timestamp(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                        .build()
                                )
                                .version(0L)
                                .build()
                        )
                        .build()
                )
                .simulationParameters(
                    BacktestResults.SimulationParameters.builder()
                        .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .end(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .start(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .eventType(
                    AuthRulesBacktestReportCreatedWebhookEvent.EventType
                        .AUTH_RULES_BACKTEST_REPORT_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofAuthRulesBacktestReportCreated(authRulesBacktestReportCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated())
            .contains(authRulesBacktestReportCreated)
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofAuthRulesBacktestReportCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofAuthRulesBacktestReportCreated(
                AuthRulesBacktestReportCreatedWebhookEvent.builder()
                    .backtestToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .results(
                        BacktestResults.Results.builder()
                            .currentVersion(
                                RuleStats.builder()
                                    .approved(0L)
                                    .challenged(0L)
                                    .declined(0L)
                                    .addExample(
                                        RuleStats.Example.builder()
                                            .approved(true)
                                            .decision(RuleStats.Example.Decision.APPROVED)
                                            .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                            .timestamp(
                                                OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                            )
                                            .build()
                                    )
                                    .version(0L)
                                    .build()
                            )
                            .draftVersion(
                                RuleStats.builder()
                                    .approved(0L)
                                    .challenged(0L)
                                    .declined(0L)
                                    .addExample(
                                        RuleStats.Example.builder()
                                            .approved(true)
                                            .decision(RuleStats.Example.Decision.APPROVED)
                                            .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                            .timestamp(
                                                OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                            )
                                            .build()
                                    )
                                    .version(0L)
                                    .build()
                            )
                            .build()
                    )
                    .simulationParameters(
                        BacktestResults.SimulationParameters.builder()
                            .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .end(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .start(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .build()
                    )
                    .eventType(
                        AuthRulesBacktestReportCreatedWebhookEvent.EventType
                            .AUTH_RULES_BACKTEST_REPORT_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofBalanceUpdated() {
        val balanceUpdated =
            BalanceUpdatedWebhookEvent.builder()
                .addData(
                    FinancialAccountBalance.builder()
                        .token("3fa85f64-5717-4562-b3fc-2c963f66afa6")
                        .availableAmount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .currency("currency")
                        .lastTransactionEventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .lastTransactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .pendingAmount(0L)
                        .totalAmount(0L)
                        .type(FinancialAccountBalance.Type.ISSUING)
                        .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .build()
                )
                .eventType(BalanceUpdatedWebhookEvent.EventType.BALANCE_UPDATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofBalanceUpdated(balanceUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).contains(balanceUpdated)
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofBalanceUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofBalanceUpdated(
                BalanceUpdatedWebhookEvent.builder()
                    .addData(
                        FinancialAccountBalance.builder()
                            .token("3fa85f64-5717-4562-b3fc-2c963f66afa6")
                            .availableAmount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .currency("currency")
                            .lastTransactionEventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .lastTransactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .pendingAmount(0L)
                            .totalAmount(0L)
                            .type(FinancialAccountBalance.Type.ISSUING)
                            .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .build()
                    )
                    .eventType(BalanceUpdatedWebhookEvent.EventType.BALANCE_UPDATED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofBookTransferTransactionCreated() {
        val bookTransferTransactionCreated =
            BookTransferTransactionCreatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .category(BookTransferResponse.BookTransferCategory.ADJUSTMENT)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("USD")
                .addEvent(
                    BookTransferResponse.BookTransferEvent.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .amount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .addDetailedResult(
                            BookTransferResponse.BookTransferEvent.BookTransferDetailedResults
                                .APPROVED
                        )
                        .memo("memo")
                        .result(BookTransferResponse.BookTransferEvent.Result.APPROVED)
                        .subtype("subtype")
                        .type(
                            BookTransferResponse.BookTransferEvent.BookTransferType
                                .ATM_BALANCE_INQUIRY
                        )
                        .build()
                )
                .family(BookTransferResponse.Family.TRANSFER)
                .fromFinancialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .pendingAmount(1000L)
                .result(BookTransferResponse.TransactionResult.APPROVED)
                .settledAmount(500L)
                .status(BookTransferResponse.TransactionStatus.PENDING)
                .toFinancialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .externalId("external_id")
                .externalResource(
                    ExternalResource.builder()
                        .externalResourceToken("external_resource_token")
                        .externalResourceType(ExternalResourceType.STATEMENT)
                        .externalResourceSubToken("external_resource_sub_token")
                        .build()
                )
                .transactionSeries(
                    BookTransferResponse.TransactionSeries.builder()
                        .relatedTransactionEventToken("123e4567-e89b-12d3-a456-426614174000")
                        .relatedTransactionToken("123e4567-e89b-12d3-a456-426614174000")
                        .type("FEE")
                        .build()
                )
                .eventType(
                    BookTransferTransactionCreatedWebhookEvent.EventType
                        .BOOK_TRANSFER_TRANSACTION_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofBookTransferTransactionCreated(bookTransferTransactionCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated())
            .contains(bookTransferTransactionCreated)
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofBookTransferTransactionCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofBookTransferTransactionCreated(
                BookTransferTransactionCreatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .category(BookTransferResponse.BookTransferCategory.ADJUSTMENT)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("USD")
                    .addEvent(
                        BookTransferResponse.BookTransferEvent.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .amount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .addDetailedResult(
                                BookTransferResponse.BookTransferEvent.BookTransferDetailedResults
                                    .APPROVED
                            )
                            .memo("memo")
                            .result(BookTransferResponse.BookTransferEvent.Result.APPROVED)
                            .subtype("subtype")
                            .type(
                                BookTransferResponse.BookTransferEvent.BookTransferType
                                    .ATM_BALANCE_INQUIRY
                            )
                            .build()
                    )
                    .family(BookTransferResponse.Family.TRANSFER)
                    .fromFinancialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .pendingAmount(1000L)
                    .result(BookTransferResponse.TransactionResult.APPROVED)
                    .settledAmount(500L)
                    .status(BookTransferResponse.TransactionStatus.PENDING)
                    .toFinancialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .externalId("external_id")
                    .externalResource(
                        ExternalResource.builder()
                            .externalResourceToken("external_resource_token")
                            .externalResourceType(ExternalResourceType.STATEMENT)
                            .externalResourceSubToken("external_resource_sub_token")
                            .build()
                    )
                    .transactionSeries(
                        BookTransferResponse.TransactionSeries.builder()
                            .relatedTransactionEventToken("123e4567-e89b-12d3-a456-426614174000")
                            .relatedTransactionToken("123e4567-e89b-12d3-a456-426614174000")
                            .type("FEE")
                            .build()
                    )
                    .eventType(
                        BookTransferTransactionCreatedWebhookEvent.EventType
                            .BOOK_TRANSFER_TRANSACTION_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofBookTransferTransactionUpdated() {
        val bookTransferTransactionUpdated =
            BookTransferTransactionUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .category(BookTransferResponse.BookTransferCategory.ADJUSTMENT)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("USD")
                .addEvent(
                    BookTransferResponse.BookTransferEvent.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .amount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .addDetailedResult(
                            BookTransferResponse.BookTransferEvent.BookTransferDetailedResults
                                .APPROVED
                        )
                        .memo("memo")
                        .result(BookTransferResponse.BookTransferEvent.Result.APPROVED)
                        .subtype("subtype")
                        .type(
                            BookTransferResponse.BookTransferEvent.BookTransferType
                                .ATM_BALANCE_INQUIRY
                        )
                        .build()
                )
                .family(BookTransferResponse.Family.TRANSFER)
                .fromFinancialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .pendingAmount(1000L)
                .result(BookTransferResponse.TransactionResult.APPROVED)
                .settledAmount(500L)
                .status(BookTransferResponse.TransactionStatus.PENDING)
                .toFinancialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .externalId("external_id")
                .externalResource(
                    ExternalResource.builder()
                        .externalResourceToken("external_resource_token")
                        .externalResourceType(ExternalResourceType.STATEMENT)
                        .externalResourceSubToken("external_resource_sub_token")
                        .build()
                )
                .transactionSeries(
                    BookTransferResponse.TransactionSeries.builder()
                        .relatedTransactionEventToken("123e4567-e89b-12d3-a456-426614174000")
                        .relatedTransactionToken("123e4567-e89b-12d3-a456-426614174000")
                        .type("FEE")
                        .build()
                )
                .eventType(
                    BookTransferTransactionUpdatedWebhookEvent.EventType
                        .BOOK_TRANSFER_TRANSACTION_UPDATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofBookTransferTransactionUpdated(bookTransferTransactionUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated())
            .contains(bookTransferTransactionUpdated)
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofBookTransferTransactionUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofBookTransferTransactionUpdated(
                BookTransferTransactionUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .category(BookTransferResponse.BookTransferCategory.ADJUSTMENT)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("USD")
                    .addEvent(
                        BookTransferResponse.BookTransferEvent.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .amount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .addDetailedResult(
                                BookTransferResponse.BookTransferEvent.BookTransferDetailedResults
                                    .APPROVED
                            )
                            .memo("memo")
                            .result(BookTransferResponse.BookTransferEvent.Result.APPROVED)
                            .subtype("subtype")
                            .type(
                                BookTransferResponse.BookTransferEvent.BookTransferType
                                    .ATM_BALANCE_INQUIRY
                            )
                            .build()
                    )
                    .family(BookTransferResponse.Family.TRANSFER)
                    .fromFinancialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .pendingAmount(1000L)
                    .result(BookTransferResponse.TransactionResult.APPROVED)
                    .settledAmount(500L)
                    .status(BookTransferResponse.TransactionStatus.PENDING)
                    .toFinancialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .externalId("external_id")
                    .externalResource(
                        ExternalResource.builder()
                            .externalResourceToken("external_resource_token")
                            .externalResourceType(ExternalResourceType.STATEMENT)
                            .externalResourceSubToken("external_resource_sub_token")
                            .build()
                    )
                    .transactionSeries(
                        BookTransferResponse.TransactionSeries.builder()
                            .relatedTransactionEventToken("123e4567-e89b-12d3-a456-426614174000")
                            .relatedTransactionToken("123e4567-e89b-12d3-a456-426614174000")
                            .type("FEE")
                            .build()
                    )
                    .eventType(
                        BookTransferTransactionUpdatedWebhookEvent.EventType
                            .BOOK_TRANSFER_TRANSACTION_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardCreated() {
        val cardCreated =
            CardCreatedWebhookEvent.builder()
                .cardToken("00000000-0000-0000-0000-000000000001")
                .eventType(CardCreatedWebhookEvent.EventType.CARD_CREATED)
                .replacementFor("00000000-0000-0000-0000-000000000000")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofCardCreated(cardCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).contains(cardCreated)
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardCreated(
                CardCreatedWebhookEvent.builder()
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .eventType(CardCreatedWebhookEvent.EventType.CARD_CREATED)
                    .replacementFor("00000000-0000-0000-0000-000000000000")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardConverted() {
        val cardConverted =
            CardConvertedWebhookEvent.builder()
                .cardToken("00000000-0000-0000-0000-000000000001")
                .eventType(CardConvertedWebhookEvent.EventType.CARD_CONVERTED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofCardConverted(cardConverted)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).contains(cardConverted)
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardConvertedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardConverted(
                CardConvertedWebhookEvent.builder()
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .eventType(CardConvertedWebhookEvent.EventType.CARD_CONVERTED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardRenewed() {
        val cardRenewed =
            CardRenewedWebhookEvent.builder()
                .eventType(CardRenewedWebhookEvent.EventType.CARD_RENEWED)
                .cardToken("00000000-0000-0000-0000-000000000001")
                .expMonth("01")
                .expYear("2030")
                .previousExpMonth("01")
                .previousExpYear("2024")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofCardRenewed(cardRenewed)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).contains(cardRenewed)
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardRenewedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardRenewed(
                CardRenewedWebhookEvent.builder()
                    .eventType(CardRenewedWebhookEvent.EventType.CARD_RENEWED)
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .expMonth("01")
                    .expYear("2030")
                    .previousExpMonth("01")
                    .previousExpYear("2024")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardReissued() {
        val cardReissued =
            CardReissuedWebhookEvent.builder()
                .eventType(CardReissuedWebhookEvent.EventType.CARD_REISSUED)
                .cardToken("00000000-0000-0000-0000-000000000001")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofCardReissued(cardReissued)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).contains(cardReissued)
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardReissuedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardReissued(
                CardReissuedWebhookEvent.builder()
                    .eventType(CardReissuedWebhookEvent.EventType.CARD_REISSUED)
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardShipped() {
        val cardShipped =
            CardShippedWebhookEvent.builder()
                .bulkOrderToken("00000000-0000-0000-0000-000000000002")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .eventType(CardShippedWebhookEvent.EventType.CARD_SHIPPED)
                .shippingMethod(
                    CardShippedWebhookEvent.ShippingMethod.USPS_WITHOUT_TRACKING_ENVELOPE
                )
                .trackingNumber("1Z9999999999999999")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofCardShipped(cardShipped)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).contains(cardShipped)
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardShippedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardShipped(
                CardShippedWebhookEvent.builder()
                    .bulkOrderToken("00000000-0000-0000-0000-000000000002")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .eventType(CardShippedWebhookEvent.EventType.CARD_SHIPPED)
                    .shippingMethod(
                        CardShippedWebhookEvent.ShippingMethod.USPS_WITHOUT_TRACKING_ENVELOPE
                    )
                    .trackingNumber("1Z9999999999999999")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardUpdated() {
        val cardUpdated =
            CardUpdatedWebhookEvent.builder()
                .cardToken("00000000-0000-0000-0000-000000000000")
                .eventType(CardUpdatedWebhookEvent.EventType.CARD_UPDATED)
                .previousFields(JsonValue.from(mapOf("state" to "PAUSED")))
                .state("OPEN")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofCardUpdated(cardUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).contains(cardUpdated)
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardUpdated(
                CardUpdatedWebhookEvent.builder()
                    .cardToken("00000000-0000-0000-0000-000000000000")
                    .eventType(CardUpdatedWebhookEvent.EventType.CARD_UPDATED)
                    .previousFields(JsonValue.from(mapOf("state" to "PAUSED")))
                    .state("OPEN")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardTransactionUpdated() {
        val cardTransactionUpdated =
            CardTransactionUpdatedWebhookEvent.builder()
                .token("c30c2182-1e69-4e0d-b40f-eec0d2a19123")
                .accountToken("db3942f0-0627-4887-a190-1ea83b46d091")
                .acquirerFee(0L)
                .acquirerReferenceNumber(null)
                .amount(1800L)
                .amounts(
                    Transaction.TransactionAmounts.builder()
                        .cardholder(
                            Transaction.TransactionAmounts.Cardholder.builder()
                                .amount(0L)
                                .conversionRate("1.000000")
                                .currency("USD")
                                .build()
                        )
                        .hold(
                            Transaction.TransactionAmounts.Hold.builder()
                                .amount(-1800L)
                                .currency("USD")
                                .build()
                        )
                        .merchant(
                            Transaction.TransactionAmounts.Merchant.builder()
                                .amount(0L)
                                .currency("USD")
                                .build()
                        )
                        .settlement(
                            Transaction.TransactionAmounts.Settlement.builder()
                                .amount(0L)
                                .currency("USD")
                                .build()
                        )
                        .build()
                )
                .authorizationAmount(1800L)
                .authorizationCode("071471")
                .avs(
                    Transaction.Avs.builder()
                        .address("123 Evergreen Terrace")
                        .zipcode("95006")
                        .build()
                )
                .cardToken("aac502f9-aecc-458a-954e-4bcf6edb6123")
                .cardholderAuthentication(
                    CardholderAuthentication.builder()
                        .authenticationMethod(
                            CardholderAuthentication.AuthenticationMethod.FRICTIONLESS
                        )
                        .authenticationResult(CardholderAuthentication.AuthenticationResult.SUCCESS)
                        .decisionMadeBy(CardholderAuthentication.DecisionMadeBy.NETWORK)
                        .liabilityShift(CardholderAuthentication.LiabilityShift._3DS_AUTHENTICATED)
                        .threeDSAuthenticationToken("fc60d37d-95f7-419c-b628-dd9fbf9d80d0")
                        .build()
                )
                .created(OffsetDateTime.parse("2023-08-03T18:42:30Z"))
                .financialAccountToken("a3b113e8-01fe-42d3-b900-b9adf3f15496")
                .merchant(
                    Merchant.builder()
                        .acceptorId("452322000053360")
                        .acquiringInstitutionId("333301802529120")
                        .city("gosq.com")
                        .country("USA")
                        .descriptor("SQ *SOMA EATS")
                        .mcc("5812")
                        .state("CA")
                        .build()
                )
                .merchantAmount(1800L)
                .merchantAuthorizationAmount(1800L)
                .merchantCurrency("USD")
                .network(Transaction.Network.MASTERCARD)
                .networkRiskScore(5L)
                .pos(
                    Transaction.Pos.builder()
                        .entryMode(
                            Transaction.Pos.PosEntryMode.builder()
                                .card(Transaction.Pos.PosEntryMode.Card.NOT_PRESENT)
                                .cardholder(Transaction.Pos.PosEntryMode.Cardholder.NOT_PRESENT)
                                .pan(Transaction.Pos.PosEntryMode.Pan.ECOMMERCE)
                                .pinEntered(false)
                                .build()
                        )
                        .terminal(
                            Transaction.Pos.PosTerminal.builder()
                                .attended(false)
                                .cardRetentionCapable(false)
                                .onPremise(false)
                                .operator(Transaction.Pos.PosTerminal.Operator.UNKNOWN)
                                .partialApprovalCapable(false)
                                .pinCapability(
                                    Transaction.Pos.PosTerminal.PinCapability.NOT_CAPABLE
                                )
                                .type(Transaction.Pos.PosTerminal.Type.UNKNOWN)
                                .acceptorTerminalId("acceptor_terminal_id")
                                .build()
                        )
                        .build()
                )
                .result(Transaction.DeclineResult.APPROVED)
                .settledAmount(0L)
                .status(Transaction.Status.PENDING)
                .tags(
                    Transaction.Tags.builder()
                        .putAdditionalProperty("risk-level", JsonValue.from("high"))
                        .build()
                )
                .tokenInfo(TokenInfo.builder().walletType(TokenInfo.WalletType.APPLE_PAY).build())
                .updated(OffsetDateTime.parse("2023-08-03T18:42:30Z"))
                .addEvent(
                    Transaction.TransactionEvent.builder()
                        .token("bbbf1e86-322d-11ee-9779-00505685a123")
                        .amount(1800L)
                        .amounts(
                            Transaction.TransactionEvent.TransactionEventAmounts.builder()
                                .cardholder(
                                    Transaction.TransactionEvent.TransactionEventAmounts.Cardholder
                                        .builder()
                                        .amount(1800L)
                                        .conversionRate("1.000000")
                                        .currency("USD")
                                        .build()
                                )
                                .merchant(
                                    Transaction.TransactionEvent.TransactionEventAmounts.Merchant
                                        .builder()
                                        .amount(1800L)
                                        .currency("USD")
                                        .build()
                                )
                                .settlement(
                                    Transaction.TransactionEvent.TransactionEventAmounts.Settlement
                                        .builder()
                                        .amount(1000L)
                                        .conversionRate("1.000000")
                                        .currency("USD")
                                        .build()
                                )
                                .build()
                        )
                        .created(OffsetDateTime.parse("2023-08-03T18:42:30Z"))
                        .addDetailedResult(Transaction.TransactionEvent.DetailedResult.APPROVED)
                        .effectivePolarity(Transaction.TransactionEvent.EffectivePolarity.DEBIT)
                        .networkInfo(
                            Transaction.TransactionEvent.NetworkInfo.builder()
                                .acquirer(
                                    Transaction.TransactionEvent.NetworkInfo.Acquirer.builder()
                                        .acquirerReferenceNumber(null)
                                        .retrievalReferenceNumber("064386558597")
                                        .build()
                                )
                                .amex(
                                    Transaction.TransactionEvent.NetworkInfo.Amex.builder()
                                        .originalTransactionId("original_transaction_id")
                                        .transactionId("transaction_id")
                                        .build()
                                )
                                .mastercard(
                                    Transaction.TransactionEvent.NetworkInfo.Mastercard.builder()
                                        .banknetReferenceNumber("U1HSCJ")
                                        .originalBanknetReferenceNumber(null)
                                        .originalSwitchSerialNumber(null)
                                        .switchSerialNumber(null)
                                        .build()
                                )
                                .visa(
                                    Transaction.TransactionEvent.NetworkInfo.Visa.builder()
                                        .originalTransactionId("original_transaction_id")
                                        .transactionId("transaction_id")
                                        .build()
                                )
                                .build()
                        )
                        .result(Transaction.TransactionEvent.DeclineResult.APPROVED)
                        .addRuleResult(
                            Transaction.TransactionEvent.RuleResult.builder()
                                .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .explanation("explanation")
                                .name("name")
                                .result(
                                    Transaction.TransactionEvent.RuleResult.DetailedResult.APPROVED
                                )
                                .build()
                        )
                        .type(Transaction.TransactionEvent.Type.AUTHORIZATION)
                        .accountType(Transaction.TransactionEvent.AccountType.CHECKING)
                        .networkSpecificData(
                            Transaction.TransactionEvent.NetworkSpecificData.builder()
                                .mastercard(
                                    Transaction.TransactionEvent.NetworkSpecificData
                                        .MastercardNetworkSpecificData
                                        .builder()
                                        .ecommerceSecurityLevelIndicator("xxx")
                                        .addOnBehalfServiceResult(
                                            Transaction.TransactionEvent.NetworkSpecificData
                                                .MastercardNetworkSpecificData
                                                .OnBehalfServiceResult
                                                .builder()
                                                .result1("x")
                                                .result2("x")
                                                .service("xx")
                                                .build()
                                        )
                                        .transactionTypeIdentifier("xxx")
                                        .build()
                                )
                                .visa(
                                    Transaction.TransactionEvent.NetworkSpecificData
                                        .VisaNetworkSpecificData
                                        .builder()
                                        .businessApplicationIdentifier("xx")
                                        .build()
                                )
                                .build()
                        )
                        .build()
                )
                .eventType(CardTransactionUpdatedWebhookEvent.EventType.CARD_TRANSACTION_UPDATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofCardTransactionUpdated(cardTransactionUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).contains(cardTransactionUpdated)
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardTransactionUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardTransactionUpdated(
                CardTransactionUpdatedWebhookEvent.builder()
                    .token("c30c2182-1e69-4e0d-b40f-eec0d2a19123")
                    .accountToken("db3942f0-0627-4887-a190-1ea83b46d091")
                    .acquirerFee(0L)
                    .acquirerReferenceNumber(null)
                    .amount(1800L)
                    .amounts(
                        Transaction.TransactionAmounts.builder()
                            .cardholder(
                                Transaction.TransactionAmounts.Cardholder.builder()
                                    .amount(0L)
                                    .conversionRate("1.000000")
                                    .currency("USD")
                                    .build()
                            )
                            .hold(
                                Transaction.TransactionAmounts.Hold.builder()
                                    .amount(-1800L)
                                    .currency("USD")
                                    .build()
                            )
                            .merchant(
                                Transaction.TransactionAmounts.Merchant.builder()
                                    .amount(0L)
                                    .currency("USD")
                                    .build()
                            )
                            .settlement(
                                Transaction.TransactionAmounts.Settlement.builder()
                                    .amount(0L)
                                    .currency("USD")
                                    .build()
                            )
                            .build()
                    )
                    .authorizationAmount(1800L)
                    .authorizationCode("071471")
                    .avs(
                        Transaction.Avs.builder()
                            .address("123 Evergreen Terrace")
                            .zipcode("95006")
                            .build()
                    )
                    .cardToken("aac502f9-aecc-458a-954e-4bcf6edb6123")
                    .cardholderAuthentication(
                        CardholderAuthentication.builder()
                            .authenticationMethod(
                                CardholderAuthentication.AuthenticationMethod.FRICTIONLESS
                            )
                            .authenticationResult(
                                CardholderAuthentication.AuthenticationResult.SUCCESS
                            )
                            .decisionMadeBy(CardholderAuthentication.DecisionMadeBy.NETWORK)
                            .liabilityShift(
                                CardholderAuthentication.LiabilityShift._3DS_AUTHENTICATED
                            )
                            .threeDSAuthenticationToken("fc60d37d-95f7-419c-b628-dd9fbf9d80d0")
                            .build()
                    )
                    .created(OffsetDateTime.parse("2023-08-03T18:42:30Z"))
                    .financialAccountToken("a3b113e8-01fe-42d3-b900-b9adf3f15496")
                    .merchant(
                        Merchant.builder()
                            .acceptorId("452322000053360")
                            .acquiringInstitutionId("333301802529120")
                            .city("gosq.com")
                            .country("USA")
                            .descriptor("SQ *SOMA EATS")
                            .mcc("5812")
                            .state("CA")
                            .build()
                    )
                    .merchantAmount(1800L)
                    .merchantAuthorizationAmount(1800L)
                    .merchantCurrency("USD")
                    .network(Transaction.Network.MASTERCARD)
                    .networkRiskScore(5L)
                    .pos(
                        Transaction.Pos.builder()
                            .entryMode(
                                Transaction.Pos.PosEntryMode.builder()
                                    .card(Transaction.Pos.PosEntryMode.Card.NOT_PRESENT)
                                    .cardholder(Transaction.Pos.PosEntryMode.Cardholder.NOT_PRESENT)
                                    .pan(Transaction.Pos.PosEntryMode.Pan.ECOMMERCE)
                                    .pinEntered(false)
                                    .build()
                            )
                            .terminal(
                                Transaction.Pos.PosTerminal.builder()
                                    .attended(false)
                                    .cardRetentionCapable(false)
                                    .onPremise(false)
                                    .operator(Transaction.Pos.PosTerminal.Operator.UNKNOWN)
                                    .partialApprovalCapable(false)
                                    .pinCapability(
                                        Transaction.Pos.PosTerminal.PinCapability.NOT_CAPABLE
                                    )
                                    .type(Transaction.Pos.PosTerminal.Type.UNKNOWN)
                                    .acceptorTerminalId("acceptor_terminal_id")
                                    .build()
                            )
                            .build()
                    )
                    .result(Transaction.DeclineResult.APPROVED)
                    .settledAmount(0L)
                    .status(Transaction.Status.PENDING)
                    .tags(
                        Transaction.Tags.builder()
                            .putAdditionalProperty("risk-level", JsonValue.from("high"))
                            .build()
                    )
                    .tokenInfo(
                        TokenInfo.builder().walletType(TokenInfo.WalletType.APPLE_PAY).build()
                    )
                    .updated(OffsetDateTime.parse("2023-08-03T18:42:30Z"))
                    .addEvent(
                        Transaction.TransactionEvent.builder()
                            .token("bbbf1e86-322d-11ee-9779-00505685a123")
                            .amount(1800L)
                            .amounts(
                                Transaction.TransactionEvent.TransactionEventAmounts.builder()
                                    .cardholder(
                                        Transaction.TransactionEvent.TransactionEventAmounts
                                            .Cardholder
                                            .builder()
                                            .amount(1800L)
                                            .conversionRate("1.000000")
                                            .currency("USD")
                                            .build()
                                    )
                                    .merchant(
                                        Transaction.TransactionEvent.TransactionEventAmounts
                                            .Merchant
                                            .builder()
                                            .amount(1800L)
                                            .currency("USD")
                                            .build()
                                    )
                                    .settlement(
                                        Transaction.TransactionEvent.TransactionEventAmounts
                                            .Settlement
                                            .builder()
                                            .amount(1000L)
                                            .conversionRate("1.000000")
                                            .currency("USD")
                                            .build()
                                    )
                                    .build()
                            )
                            .created(OffsetDateTime.parse("2023-08-03T18:42:30Z"))
                            .addDetailedResult(Transaction.TransactionEvent.DetailedResult.APPROVED)
                            .effectivePolarity(Transaction.TransactionEvent.EffectivePolarity.DEBIT)
                            .networkInfo(
                                Transaction.TransactionEvent.NetworkInfo.builder()
                                    .acquirer(
                                        Transaction.TransactionEvent.NetworkInfo.Acquirer.builder()
                                            .acquirerReferenceNumber(null)
                                            .retrievalReferenceNumber("064386558597")
                                            .build()
                                    )
                                    .amex(
                                        Transaction.TransactionEvent.NetworkInfo.Amex.builder()
                                            .originalTransactionId("original_transaction_id")
                                            .transactionId("transaction_id")
                                            .build()
                                    )
                                    .mastercard(
                                        Transaction.TransactionEvent.NetworkInfo.Mastercard
                                            .builder()
                                            .banknetReferenceNumber("U1HSCJ")
                                            .originalBanknetReferenceNumber(null)
                                            .originalSwitchSerialNumber(null)
                                            .switchSerialNumber(null)
                                            .build()
                                    )
                                    .visa(
                                        Transaction.TransactionEvent.NetworkInfo.Visa.builder()
                                            .originalTransactionId("original_transaction_id")
                                            .transactionId("transaction_id")
                                            .build()
                                    )
                                    .build()
                            )
                            .result(Transaction.TransactionEvent.DeclineResult.APPROVED)
                            .addRuleResult(
                                Transaction.TransactionEvent.RuleResult.builder()
                                    .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .explanation("explanation")
                                    .name("name")
                                    .result(
                                        Transaction.TransactionEvent.RuleResult.DetailedResult
                                            .APPROVED
                                    )
                                    .build()
                            )
                            .type(Transaction.TransactionEvent.Type.AUTHORIZATION)
                            .accountType(Transaction.TransactionEvent.AccountType.CHECKING)
                            .networkSpecificData(
                                Transaction.TransactionEvent.NetworkSpecificData.builder()
                                    .mastercard(
                                        Transaction.TransactionEvent.NetworkSpecificData
                                            .MastercardNetworkSpecificData
                                            .builder()
                                            .ecommerceSecurityLevelIndicator("xxx")
                                            .addOnBehalfServiceResult(
                                                Transaction.TransactionEvent.NetworkSpecificData
                                                    .MastercardNetworkSpecificData
                                                    .OnBehalfServiceResult
                                                    .builder()
                                                    .result1("x")
                                                    .result2("x")
                                                    .service("xx")
                                                    .build()
                                            )
                                            .transactionTypeIdentifier("xxx")
                                            .build()
                                    )
                                    .visa(
                                        Transaction.TransactionEvent.NetworkSpecificData
                                            .VisaNetworkSpecificData
                                            .builder()
                                            .businessApplicationIdentifier("xx")
                                            .build()
                                    )
                                    .build()
                            )
                            .build()
                    )
                    .eventType(
                        CardTransactionUpdatedWebhookEvent.EventType.CARD_TRANSACTION_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardTransactionEnhancedDataCreated() {
        val cardTransactionEnhancedDataCreated =
            CardTransactionEnhancedDataCreatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .common(
                    EnhancedData.CommonData.builder()
                        .addLineItem(
                            EnhancedData.CommonData.LineItem.builder()
                                .amount("amount")
                                .description("description")
                                .productCode("product_code")
                                .quantity("quantity")
                                .build()
                        )
                        .tax(
                            EnhancedData.CommonData.TaxData.builder()
                                .amount(0L)
                                .exempt(
                                    EnhancedData.CommonData.TaxData.TaxExemptIndicator.TAX_INCLUDED
                                )
                                .merchantTaxId("merchant_tax_id")
                                .build()
                        )
                        .customerReferenceNumber("customer_reference_number")
                        .merchantReferenceNumber("merchant_reference_number")
                        .orderDate(LocalDate.parse("2019-12-27"))
                        .build()
                )
                .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .addFleet(
                    EnhancedData.Fleet.builder()
                        .amountTotals(
                            EnhancedData.Fleet.AmountTotals.builder()
                                .discount(0L)
                                .grossSale(0L)
                                .netSale(0L)
                                .build()
                        )
                        .fuel(
                            EnhancedData.Fleet.FuelData.builder()
                                .quantity("quantity")
                                .type(EnhancedData.Fleet.FuelData.FuelType.UNKNOWN)
                                .unitOfMeasure(
                                    EnhancedData.Fleet.FuelData.FuelUnitOfMeasure.GALLONS
                                )
                                .unitPrice(0L)
                                .build()
                        )
                        .driverNumber("driver_number")
                        .odometer(0L)
                        .serviceType(EnhancedData.Fleet.ServiceType.UNKNOWN)
                        .vehicleNumber("vehicle_number")
                        .build()
                )
                .transactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .eventType(
                    CardTransactionEnhancedDataCreatedWebhookEvent.EventType
                        .CARD_TRANSACTION_ENHANCED_DATA_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardTransactionEnhancedDataCreated(
                cardTransactionEnhancedDataCreated
            )

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated())
            .contains(cardTransactionEnhancedDataCreated)
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardTransactionEnhancedDataCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardTransactionEnhancedDataCreated(
                CardTransactionEnhancedDataCreatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .common(
                        EnhancedData.CommonData.builder()
                            .addLineItem(
                                EnhancedData.CommonData.LineItem.builder()
                                    .amount("amount")
                                    .description("description")
                                    .productCode("product_code")
                                    .quantity("quantity")
                                    .build()
                            )
                            .tax(
                                EnhancedData.CommonData.TaxData.builder()
                                    .amount(0L)
                                    .exempt(
                                        EnhancedData.CommonData.TaxData.TaxExemptIndicator
                                            .TAX_INCLUDED
                                    )
                                    .merchantTaxId("merchant_tax_id")
                                    .build()
                            )
                            .customerReferenceNumber("customer_reference_number")
                            .merchantReferenceNumber("merchant_reference_number")
                            .orderDate(LocalDate.parse("2019-12-27"))
                            .build()
                    )
                    .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .addFleet(
                        EnhancedData.Fleet.builder()
                            .amountTotals(
                                EnhancedData.Fleet.AmountTotals.builder()
                                    .discount(0L)
                                    .grossSale(0L)
                                    .netSale(0L)
                                    .build()
                            )
                            .fuel(
                                EnhancedData.Fleet.FuelData.builder()
                                    .quantity("quantity")
                                    .type(EnhancedData.Fleet.FuelData.FuelType.UNKNOWN)
                                    .unitOfMeasure(
                                        EnhancedData.Fleet.FuelData.FuelUnitOfMeasure.GALLONS
                                    )
                                    .unitPrice(0L)
                                    .build()
                            )
                            .driverNumber("driver_number")
                            .odometer(0L)
                            .serviceType(EnhancedData.Fleet.ServiceType.UNKNOWN)
                            .vehicleNumber("vehicle_number")
                            .build()
                    )
                    .transactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .eventType(
                        CardTransactionEnhancedDataCreatedWebhookEvent.EventType
                            .CARD_TRANSACTION_ENHANCED_DATA_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofCardTransactionEnhancedDataUpdated() {
        val cardTransactionEnhancedDataUpdated =
            CardTransactionEnhancedDataUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .common(
                    EnhancedData.CommonData.builder()
                        .addLineItem(
                            EnhancedData.CommonData.LineItem.builder()
                                .amount("amount")
                                .description("description")
                                .productCode("product_code")
                                .quantity("quantity")
                                .build()
                        )
                        .tax(
                            EnhancedData.CommonData.TaxData.builder()
                                .amount(0L)
                                .exempt(
                                    EnhancedData.CommonData.TaxData.TaxExemptIndicator.TAX_INCLUDED
                                )
                                .merchantTaxId("merchant_tax_id")
                                .build()
                        )
                        .customerReferenceNumber("customer_reference_number")
                        .merchantReferenceNumber("merchant_reference_number")
                        .orderDate(LocalDate.parse("2019-12-27"))
                        .build()
                )
                .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .addFleet(
                    EnhancedData.Fleet.builder()
                        .amountTotals(
                            EnhancedData.Fleet.AmountTotals.builder()
                                .discount(0L)
                                .grossSale(0L)
                                .netSale(0L)
                                .build()
                        )
                        .fuel(
                            EnhancedData.Fleet.FuelData.builder()
                                .quantity("quantity")
                                .type(EnhancedData.Fleet.FuelData.FuelType.UNKNOWN)
                                .unitOfMeasure(
                                    EnhancedData.Fleet.FuelData.FuelUnitOfMeasure.GALLONS
                                )
                                .unitPrice(0L)
                                .build()
                        )
                        .driverNumber("driver_number")
                        .odometer(0L)
                        .serviceType(EnhancedData.Fleet.ServiceType.UNKNOWN)
                        .vehicleNumber("vehicle_number")
                        .build()
                )
                .transactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .eventType(
                    CardTransactionEnhancedDataUpdatedWebhookEvent.EventType
                        .CARD_TRANSACTION_ENHANCED_DATA_UPDATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardTransactionEnhancedDataUpdated(
                cardTransactionEnhancedDataUpdated
            )

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated())
            .contains(cardTransactionEnhancedDataUpdated)
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofCardTransactionEnhancedDataUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofCardTransactionEnhancedDataUpdated(
                CardTransactionEnhancedDataUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .common(
                        EnhancedData.CommonData.builder()
                            .addLineItem(
                                EnhancedData.CommonData.LineItem.builder()
                                    .amount("amount")
                                    .description("description")
                                    .productCode("product_code")
                                    .quantity("quantity")
                                    .build()
                            )
                            .tax(
                                EnhancedData.CommonData.TaxData.builder()
                                    .amount(0L)
                                    .exempt(
                                        EnhancedData.CommonData.TaxData.TaxExemptIndicator
                                            .TAX_INCLUDED
                                    )
                                    .merchantTaxId("merchant_tax_id")
                                    .build()
                            )
                            .customerReferenceNumber("customer_reference_number")
                            .merchantReferenceNumber("merchant_reference_number")
                            .orderDate(LocalDate.parse("2019-12-27"))
                            .build()
                    )
                    .eventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .addFleet(
                        EnhancedData.Fleet.builder()
                            .amountTotals(
                                EnhancedData.Fleet.AmountTotals.builder()
                                    .discount(0L)
                                    .grossSale(0L)
                                    .netSale(0L)
                                    .build()
                            )
                            .fuel(
                                EnhancedData.Fleet.FuelData.builder()
                                    .quantity("quantity")
                                    .type(EnhancedData.Fleet.FuelData.FuelType.UNKNOWN)
                                    .unitOfMeasure(
                                        EnhancedData.Fleet.FuelData.FuelUnitOfMeasure.GALLONS
                                    )
                                    .unitPrice(0L)
                                    .build()
                            )
                            .driverNumber("driver_number")
                            .odometer(0L)
                            .serviceType(EnhancedData.Fleet.ServiceType.UNKNOWN)
                            .vehicleNumber("vehicle_number")
                            .build()
                    )
                    .transactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .eventType(
                        CardTransactionEnhancedDataUpdatedWebhookEvent.EventType
                            .CARD_TRANSACTION_ENHANCED_DATA_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDigitalWalletTokenizationApprovalRequest() {
        val digitalWalletTokenizationApprovalRequest =
            DigitalWalletTokenizationApprovalRequestWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .customerTokenizationDecision(
                    DigitalWalletTokenizationApprovalRequestWebhookEvent
                        .CustomerTokenizationDecision
                        .builder()
                        .outcome(
                            DigitalWalletTokenizationApprovalRequestWebhookEvent
                                .CustomerTokenizationDecision
                                .Outcome
                                .APPROVED
                        )
                        .responderUrl("https://example.com")
                        .latency("100")
                        .responseCode("123456")
                        .build()
                )
                .eventType(
                    DigitalWalletTokenizationApprovalRequestWebhookEvent.EventType
                        .DIGITAL_WALLET_TOKENIZATION_APPROVAL_REQUEST
                )
                .issuerDecision(
                    DigitalWalletTokenizationApprovalRequestWebhookEvent.IssuerDecision.APPROVED
                )
                .tokenizationChannel(
                    DigitalWalletTokenizationApprovalRequestWebhookEvent.TokenizationChannel
                        .DIGITAL_WALLET
                )
                .tokenizationToken("tokenization_token")
                .walletDecisioningInfo(
                    WalletDecisioningInfo.builder()
                        .accountScore("100")
                        .deviceScore("100")
                        .recommendedDecision("Decision1")
                        .addRecommendationReason("string")
                        .build()
                )
                .device(
                    Device.builder()
                        .imei("123456789012345")
                        .ipAddress("1.1.1.1")
                        .location("37.3860517/-122.0838511")
                        .build()
                )
                .digitalWalletTokenMetadata(
                    DigitalWalletTokenMetadata.builder()
                        .paymentAccountInfo(
                            DigitalWalletTokenMetadata.PaymentAccountInfo.builder()
                                .accountHolderData(
                                    DigitalWalletTokenMetadata.PaymentAccountInfo.AccountHolderData
                                        .builder()
                                        .phoneNumber("phone_number")
                                        .build()
                                )
                                .panUniqueReference("pan_unique_reference")
                                .paymentAccountReference("payment_account_reference")
                                .tokenUniqueReference("token_unique_reference")
                                .build()
                        )
                        .status("status")
                        .paymentAppInstanceId("payment_app_instance_id")
                        .tokenRequestorId("xxxxxxxxxxx")
                        .tokenRequestorName(DigitalWalletTokenMetadata.TokenRequestorName.APPLE_PAY)
                        .build()
                )
                .addRuleResult(
                    TokenizationRuleResult.builder()
                        .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .explanation("explanation")
                        .name("name")
                        .result(TokenizationRuleResult.Result.APPROVED)
                        .build()
                )
                .addTokenizationDeclineReason(TokenizationDeclineReason.ACCOUNT_SCORE_1)
                .tokenizationSource(
                    DigitalWalletTokenizationApprovalRequestWebhookEvent.TokenizationSource
                        .PUSH_PROVISION
                )
                .addTokenizationTfaReason(TokenizationTfaReason.WALLET_RECOMMENDED_TFA)
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationApprovalRequest(
                digitalWalletTokenizationApprovalRequest
            )

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest())
            .contains(digitalWalletTokenizationApprovalRequest)
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofDigitalWalletTokenizationApprovalRequestRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationApprovalRequest(
                DigitalWalletTokenizationApprovalRequestWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .customerTokenizationDecision(
                        DigitalWalletTokenizationApprovalRequestWebhookEvent
                            .CustomerTokenizationDecision
                            .builder()
                            .outcome(
                                DigitalWalletTokenizationApprovalRequestWebhookEvent
                                    .CustomerTokenizationDecision
                                    .Outcome
                                    .APPROVED
                            )
                            .responderUrl("https://example.com")
                            .latency("100")
                            .responseCode("123456")
                            .build()
                    )
                    .eventType(
                        DigitalWalletTokenizationApprovalRequestWebhookEvent.EventType
                            .DIGITAL_WALLET_TOKENIZATION_APPROVAL_REQUEST
                    )
                    .issuerDecision(
                        DigitalWalletTokenizationApprovalRequestWebhookEvent.IssuerDecision.APPROVED
                    )
                    .tokenizationChannel(
                        DigitalWalletTokenizationApprovalRequestWebhookEvent.TokenizationChannel
                            .DIGITAL_WALLET
                    )
                    .tokenizationToken("tokenization_token")
                    .walletDecisioningInfo(
                        WalletDecisioningInfo.builder()
                            .accountScore("100")
                            .deviceScore("100")
                            .recommendedDecision("Decision1")
                            .addRecommendationReason("string")
                            .build()
                    )
                    .device(
                        Device.builder()
                            .imei("123456789012345")
                            .ipAddress("1.1.1.1")
                            .location("37.3860517/-122.0838511")
                            .build()
                    )
                    .digitalWalletTokenMetadata(
                        DigitalWalletTokenMetadata.builder()
                            .paymentAccountInfo(
                                DigitalWalletTokenMetadata.PaymentAccountInfo.builder()
                                    .accountHolderData(
                                        DigitalWalletTokenMetadata.PaymentAccountInfo
                                            .AccountHolderData
                                            .builder()
                                            .phoneNumber("phone_number")
                                            .build()
                                    )
                                    .panUniqueReference("pan_unique_reference")
                                    .paymentAccountReference("payment_account_reference")
                                    .tokenUniqueReference("token_unique_reference")
                                    .build()
                            )
                            .status("status")
                            .paymentAppInstanceId("payment_app_instance_id")
                            .tokenRequestorId("xxxxxxxxxxx")
                            .tokenRequestorName(
                                DigitalWalletTokenMetadata.TokenRequestorName.APPLE_PAY
                            )
                            .build()
                    )
                    .addRuleResult(
                        TokenizationRuleResult.builder()
                            .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .explanation("explanation")
                            .name("name")
                            .result(TokenizationRuleResult.Result.APPROVED)
                            .build()
                    )
                    .addTokenizationDeclineReason(TokenizationDeclineReason.ACCOUNT_SCORE_1)
                    .tokenizationSource(
                        DigitalWalletTokenizationApprovalRequestWebhookEvent.TokenizationSource
                            .PUSH_PROVISION
                    )
                    .addTokenizationTfaReason(TokenizationTfaReason.WALLET_RECOMMENDED_TFA)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDigitalWalletTokenizationResult() {
        val digitalWalletTokenizationResult =
            DigitalWalletTokenizationResultWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                .eventType(
                    DigitalWalletTokenizationResultWebhookEvent.EventType
                        .DIGITAL_WALLET_TOKENIZATION_RESULT
                )
                .tokenizationResultDetails(
                    DigitalWalletTokenizationResultWebhookEvent.TokenizationResultDetails.builder()
                        .issuerDecision("issuer_decision")
                        .addTokenizationDeclineReason(
                            DigitalWalletTokenizationResultWebhookEvent.TokenizationResultDetails
                                .TokenizationDeclineReason
                                .ACCOUNT_SCORE_1
                        )
                        .addTokenizationDeclineReason(
                            DigitalWalletTokenizationResultWebhookEvent.TokenizationResultDetails
                                .TokenizationDeclineReason
                                .DEVICE_SCORE_1
                        )
                        .customerDecision("customer_decision")
                        .addRuleResult(
                            TokenizationRuleResult.builder()
                                .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .explanation("explanation")
                                .name("name")
                                .result(TokenizationRuleResult.Result.APPROVED)
                                .build()
                        )
                        .tokenActivatedDateTime(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                        .addTokenizationTfaReason(TokenizationTfaReason.WALLET_RECOMMENDED_TFA)
                        .walletDecision("APPROVED")
                        .build()
                )
                .tokenizationToken("00000000-0000-0000-0000-000000000003")
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationResult(digitalWalletTokenizationResult)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult())
            .contains(digitalWalletTokenizationResult)
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofDigitalWalletTokenizationResultRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationResult(
                DigitalWalletTokenizationResultWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                    .eventType(
                        DigitalWalletTokenizationResultWebhookEvent.EventType
                            .DIGITAL_WALLET_TOKENIZATION_RESULT
                    )
                    .tokenizationResultDetails(
                        DigitalWalletTokenizationResultWebhookEvent.TokenizationResultDetails
                            .builder()
                            .issuerDecision("issuer_decision")
                            .addTokenizationDeclineReason(
                                DigitalWalletTokenizationResultWebhookEvent
                                    .TokenizationResultDetails
                                    .TokenizationDeclineReason
                                    .ACCOUNT_SCORE_1
                            )
                            .addTokenizationDeclineReason(
                                DigitalWalletTokenizationResultWebhookEvent
                                    .TokenizationResultDetails
                                    .TokenizationDeclineReason
                                    .DEVICE_SCORE_1
                            )
                            .customerDecision("customer_decision")
                            .addRuleResult(
                                TokenizationRuleResult.builder()
                                    .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .explanation("explanation")
                                    .name("name")
                                    .result(TokenizationRuleResult.Result.APPROVED)
                                    .build()
                            )
                            .tokenActivatedDateTime(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                            .addTokenizationTfaReason(TokenizationTfaReason.WALLET_RECOMMENDED_TFA)
                            .walletDecision("APPROVED")
                            .build()
                    )
                    .tokenizationToken("00000000-0000-0000-0000-000000000003")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDigitalWalletTokenizationTwoFactorAuthenticationCode() {
        val digitalWalletTokenizationTwoFactorAuthenticationCode =
            DigitalWalletTokenizationTwoFactorAuthenticationCodeWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .activationMethod(
                    DigitalWalletTokenizationTwoFactorAuthenticationCodeWebhookEvent
                        .ActivationMethod
                        .builder()
                        .type(
                            DigitalWalletTokenizationTwoFactorAuthenticationCodeWebhookEvent
                                .ActivationMethod
                                .Type
                                .TEXT_TO_CARDHOLDER_NUMBER
                        )
                        .value("+15555555555")
                        .build()
                )
                .authenticationCode("123456")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                .eventType(
                    DigitalWalletTokenizationTwoFactorAuthenticationCodeWebhookEvent.EventType
                        .DIGITAL_WALLET_TOKENIZATION_TWO_FACTOR_AUTHENTICATION_CODE
                )
                .tokenizationToken("00000000-0000-0000-0000-000000000003")
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationTwoFactorAuthenticationCode(
                digitalWalletTokenizationTwoFactorAuthenticationCode
            )

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .contains(digitalWalletTokenizationTwoFactorAuthenticationCode)
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofDigitalWalletTokenizationTwoFactorAuthenticationCodeRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationTwoFactorAuthenticationCode(
                DigitalWalletTokenizationTwoFactorAuthenticationCodeWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .activationMethod(
                        DigitalWalletTokenizationTwoFactorAuthenticationCodeWebhookEvent
                            .ActivationMethod
                            .builder()
                            .type(
                                DigitalWalletTokenizationTwoFactorAuthenticationCodeWebhookEvent
                                    .ActivationMethod
                                    .Type
                                    .TEXT_TO_CARDHOLDER_NUMBER
                            )
                            .value("+15555555555")
                            .build()
                    )
                    .authenticationCode("123456")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                    .eventType(
                        DigitalWalletTokenizationTwoFactorAuthenticationCodeWebhookEvent.EventType
                            .DIGITAL_WALLET_TOKENIZATION_TWO_FACTOR_AUTHENTICATION_CODE
                    )
                    .tokenizationToken("00000000-0000-0000-0000-000000000003")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDigitalWalletTokenizationTwoFactorAuthenticationCodeSent() {
        val digitalWalletTokenizationTwoFactorAuthenticationCodeSent =
            DigitalWalletTokenizationTwoFactorAuthenticationCodeSentWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .activationMethod(
                    DigitalWalletTokenizationTwoFactorAuthenticationCodeSentWebhookEvent
                        .ActivationMethod
                        .builder()
                        .type(
                            DigitalWalletTokenizationTwoFactorAuthenticationCodeSentWebhookEvent
                                .ActivationMethod
                                .Type
                                .TEXT_TO_CARDHOLDER_NUMBER
                        )
                        .value("+15555555555")
                        .build()
                )
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                .eventType(
                    DigitalWalletTokenizationTwoFactorAuthenticationCodeSentWebhookEvent.EventType
                        .DIGITAL_WALLET_TOKENIZATION_TWO_FACTOR_AUTHENTICATION_CODE_SENT
                )
                .tokenizationToken("00000000-0000-0000-0000-000000000003")
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationTwoFactorAuthenticationCodeSent(
                digitalWalletTokenizationTwoFactorAuthenticationCodeSent
            )

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .contains(digitalWalletTokenizationTwoFactorAuthenticationCodeSent)
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofDigitalWalletTokenizationTwoFactorAuthenticationCodeSentRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationTwoFactorAuthenticationCodeSent(
                DigitalWalletTokenizationTwoFactorAuthenticationCodeSentWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .activationMethod(
                        DigitalWalletTokenizationTwoFactorAuthenticationCodeSentWebhookEvent
                            .ActivationMethod
                            .builder()
                            .type(
                                DigitalWalletTokenizationTwoFactorAuthenticationCodeSentWebhookEvent
                                    .ActivationMethod
                                    .Type
                                    .TEXT_TO_CARDHOLDER_NUMBER
                            )
                            .value("+15555555555")
                            .build()
                    )
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                    .eventType(
                        DigitalWalletTokenizationTwoFactorAuthenticationCodeSentWebhookEvent
                            .EventType
                            .DIGITAL_WALLET_TOKENIZATION_TWO_FACTOR_AUTHENTICATION_CODE_SENT
                    )
                    .tokenizationToken("00000000-0000-0000-0000-000000000003")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDigitalWalletTokenizationUpdated() {
        val digitalWalletTokenizationUpdated =
            DigitalWalletTokenizationUpdatedWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                .eventType(
                    DigitalWalletTokenizationUpdatedWebhookEvent.EventType
                        .DIGITAL_WALLET_TOKENIZATION_UPDATED
                )
                .tokenization(
                    Tokenization.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .dpan("dpan")
                        .status(Tokenization.Status.ACTIVE)
                        .tokenRequestorName(Tokenization.TokenRequestorName.AMAZON_ONE)
                        .tokenUniqueReference("token_unique_reference")
                        .tokenizationChannel(Tokenization.TokenizationChannel.DIGITAL_WALLET)
                        .updatedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .deviceId("device_id")
                        .digitalCardArtToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .addEvent(
                            Tokenization.TokenizationEvent.builder()
                                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .result(
                                    Tokenization.TokenizationEvent.TokenizationEventOutcome.APPROVED
                                )
                                .addRuleResult(
                                    TokenizationRuleResult.builder()
                                        .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .explanation("explanation")
                                        .name("name")
                                        .result(TokenizationRuleResult.Result.APPROVED)
                                        .build()
                                )
                                .addTokenizationDeclineReason(
                                    TokenizationDeclineReason.ACCOUNT_SCORE_1
                                )
                                .addTokenizationTfaReason(
                                    TokenizationTfaReason.WALLET_RECOMMENDED_TFA
                                )
                                .type(Tokenization.TokenizationEvent.Type.TOKENIZATION_2_FA)
                                .build()
                        )
                        .paymentAccountReferenceId("payment_account_reference_id")
                        .build()
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationUpdated(digitalWalletTokenizationUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated())
            .contains(digitalWalletTokenizationUpdated)
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofDigitalWalletTokenizationUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDigitalWalletTokenizationUpdated(
                DigitalWalletTokenizationUpdatedWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                    .eventType(
                        DigitalWalletTokenizationUpdatedWebhookEvent.EventType
                            .DIGITAL_WALLET_TOKENIZATION_UPDATED
                    )
                    .tokenization(
                        Tokenization.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .dpan("dpan")
                            .status(Tokenization.Status.ACTIVE)
                            .tokenRequestorName(Tokenization.TokenRequestorName.AMAZON_ONE)
                            .tokenUniqueReference("token_unique_reference")
                            .tokenizationChannel(Tokenization.TokenizationChannel.DIGITAL_WALLET)
                            .updatedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .deviceId("device_id")
                            .digitalCardArtToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .addEvent(
                                Tokenization.TokenizationEvent.builder()
                                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                    .result(
                                        Tokenization.TokenizationEvent.TokenizationEventOutcome
                                            .APPROVED
                                    )
                                    .addRuleResult(
                                        TokenizationRuleResult.builder()
                                            .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                            .explanation("explanation")
                                            .name("name")
                                            .result(TokenizationRuleResult.Result.APPROVED)
                                            .build()
                                    )
                                    .addTokenizationDeclineReason(
                                        TokenizationDeclineReason.ACCOUNT_SCORE_1
                                    )
                                    .addTokenizationTfaReason(
                                        TokenizationTfaReason.WALLET_RECOMMENDED_TFA
                                    )
                                    .type(Tokenization.TokenizationEvent.Type.TOKENIZATION_2_FA)
                                    .build()
                            )
                            .paymentAccountReferenceId("payment_account_reference_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDisputeUpdated() {
        val disputeUpdated =
            DisputeUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .amount(0L)
                .arbitrationDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .customerFiledDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .customerNote("customer_note")
                .addNetworkClaimId("string")
                .networkFiledDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .networkReasonCode("network_reason_code")
                .prearbitrationDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .primaryClaimId("primary_claim_id")
                .reason(Dispute.Reason.ATM_CASH_MISDISPENSE)
                .representmentDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .resolutionDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .resolutionNote("resolution_note")
                .resolutionReason(Dispute.ResolutionReason.CASE_LOST)
                .status(Dispute.Status.ARBITRATION)
                .transactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .eventType(DisputeUpdatedWebhookEvent.EventType.DISPUTE_UPDATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofDisputeUpdated(disputeUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).contains(disputeUpdated)
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofDisputeUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDisputeUpdated(
                DisputeUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .amount(0L)
                    .arbitrationDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .customerFiledDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .customerNote("customer_note")
                    .addNetworkClaimId("string")
                    .networkFiledDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .networkReasonCode("network_reason_code")
                    .prearbitrationDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .primaryClaimId("primary_claim_id")
                    .reason(Dispute.Reason.ATM_CASH_MISDISPENSE)
                    .representmentDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .resolutionDate(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .resolutionNote("resolution_note")
                    .resolutionReason(Dispute.ResolutionReason.CASE_LOST)
                    .status(Dispute.Status.ARBITRATION)
                    .transactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .eventType(DisputeUpdatedWebhookEvent.EventType.DISPUTE_UPDATED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDisputeEvidenceUploadFailed() {
        val disputeEvidenceUploadFailed =
            DisputeEvidenceUploadFailedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .disputeToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .uploadStatus(DisputeEvidence.UploadStatus.DELETED)
                .downloadUrl("download_url")
                .filename("filename")
                .uploadUrl("upload_url")
                .eventType(
                    DisputeEvidenceUploadFailedWebhookEvent.EventType.DISPUTE_EVIDENCE_UPLOAD_FAILED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDisputeEvidenceUploadFailed(disputeEvidenceUploadFailed)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed())
            .contains(disputeEvidenceUploadFailed)
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofDisputeEvidenceUploadFailedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDisputeEvidenceUploadFailed(
                DisputeEvidenceUploadFailedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .disputeToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .uploadStatus(DisputeEvidence.UploadStatus.DELETED)
                    .downloadUrl("download_url")
                    .filename("filename")
                    .uploadUrl("upload_url")
                    .eventType(
                        DisputeEvidenceUploadFailedWebhookEvent.EventType
                            .DISPUTE_EVIDENCE_UPLOAD_FAILED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofExternalBankAccountCreated() {
        val externalBankAccountCreated =
            ExternalBankAccountCreatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .country("country")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("currency")
                .lastFour("last_four")
                .owner("owner")
                .ownerType(OwnerType.INDIVIDUAL)
                .routingNumber("routing_number")
                .state(ExternalBankAccount.State.ENABLED)
                .type(ExternalBankAccount.AccountType.CHECKING)
                .verificationAttempts(0L)
                .verificationMethod(VerificationMethod.MANUAL)
                .verificationState(ExternalBankAccount.VerificationState.PENDING)
                .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .address(
                    ExternalBankAccountAddress.builder()
                        .address1("x")
                        .city("x")
                        .country("USD")
                        .postalCode("11201")
                        .state("xx")
                        .address2("x")
                        .build()
                )
                .companyId("company_id")
                .dob(LocalDate.parse("2019-12-27"))
                .doingBusinessAs("doing_business_as")
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .name("name")
                .userDefinedId("user_defined_id")
                .verificationFailedReason("verification_failed_reason")
                .eventType(
                    ExternalBankAccountCreatedWebhookEvent.EventType.EXTERNAL_BANK_ACCOUNT_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofExternalBankAccountCreated(externalBankAccountCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated())
            .contains(externalBankAccountCreated)
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofExternalBankAccountCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofExternalBankAccountCreated(
                ExternalBankAccountCreatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .country("country")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("currency")
                    .lastFour("last_four")
                    .owner("owner")
                    .ownerType(OwnerType.INDIVIDUAL)
                    .routingNumber("routing_number")
                    .state(ExternalBankAccount.State.ENABLED)
                    .type(ExternalBankAccount.AccountType.CHECKING)
                    .verificationAttempts(0L)
                    .verificationMethod(VerificationMethod.MANUAL)
                    .verificationState(ExternalBankAccount.VerificationState.PENDING)
                    .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .address(
                        ExternalBankAccountAddress.builder()
                            .address1("x")
                            .city("x")
                            .country("USD")
                            .postalCode("11201")
                            .state("xx")
                            .address2("x")
                            .build()
                    )
                    .companyId("company_id")
                    .dob(LocalDate.parse("2019-12-27"))
                    .doingBusinessAs("doing_business_as")
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .name("name")
                    .userDefinedId("user_defined_id")
                    .verificationFailedReason("verification_failed_reason")
                    .eventType(
                        ExternalBankAccountCreatedWebhookEvent.EventType
                            .EXTERNAL_BANK_ACCOUNT_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofExternalBankAccountUpdated() {
        val externalBankAccountUpdated =
            ExternalBankAccountUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .country("country")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("currency")
                .lastFour("last_four")
                .owner("owner")
                .ownerType(OwnerType.INDIVIDUAL)
                .routingNumber("routing_number")
                .state(ExternalBankAccount.State.ENABLED)
                .type(ExternalBankAccount.AccountType.CHECKING)
                .verificationAttempts(0L)
                .verificationMethod(VerificationMethod.MANUAL)
                .verificationState(ExternalBankAccount.VerificationState.PENDING)
                .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .address(
                    ExternalBankAccountAddress.builder()
                        .address1("x")
                        .city("x")
                        .country("USD")
                        .postalCode("11201")
                        .state("xx")
                        .address2("x")
                        .build()
                )
                .companyId("company_id")
                .dob(LocalDate.parse("2019-12-27"))
                .doingBusinessAs("doing_business_as")
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .name("name")
                .userDefinedId("user_defined_id")
                .verificationFailedReason("verification_failed_reason")
                .eventType(
                    ExternalBankAccountUpdatedWebhookEvent.EventType.EXTERNAL_BANK_ACCOUNT_UPDATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofExternalBankAccountUpdated(externalBankAccountUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated())
            .contains(externalBankAccountUpdated)
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofExternalBankAccountUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofExternalBankAccountUpdated(
                ExternalBankAccountUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .country("country")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("currency")
                    .lastFour("last_four")
                    .owner("owner")
                    .ownerType(OwnerType.INDIVIDUAL)
                    .routingNumber("routing_number")
                    .state(ExternalBankAccount.State.ENABLED)
                    .type(ExternalBankAccount.AccountType.CHECKING)
                    .verificationAttempts(0L)
                    .verificationMethod(VerificationMethod.MANUAL)
                    .verificationState(ExternalBankAccount.VerificationState.PENDING)
                    .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .address(
                        ExternalBankAccountAddress.builder()
                            .address1("x")
                            .city("x")
                            .country("USD")
                            .postalCode("11201")
                            .state("xx")
                            .address2("x")
                            .build()
                    )
                    .companyId("company_id")
                    .dob(LocalDate.parse("2019-12-27"))
                    .doingBusinessAs("doing_business_as")
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .name("name")
                    .userDefinedId("user_defined_id")
                    .verificationFailedReason("verification_failed_reason")
                    .eventType(
                        ExternalBankAccountUpdatedWebhookEvent.EventType
                            .EXTERNAL_BANK_ACCOUNT_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofExternalPaymentCreated() {
        val externalPaymentCreated =
            ExternalPaymentCreatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .status(ExternalPayment.TransactionStatus.PENDING)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .category(ExternalPayment.ExternalPaymentCategory.EXTERNAL_WIRE)
                .currency("currency")
                .addEvent(
                    ExternalPayment.ExternalPaymentEvent.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .amount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .addDetailedResult(
                            ExternalPayment.ExternalPaymentEvent.DetailedResults.APPROVED
                        )
                        .effectiveDate(LocalDate.parse("2019-12-27"))
                        .memo("memo")
                        .result(ExternalPayment.ExternalPaymentEvent.TransactionResult.APPROVED)
                        .type(
                            ExternalPayment.ExternalPaymentEvent.ExternalPaymentEventType
                                .EXTERNAL_WIRE_INITIATED
                        )
                        .build()
                )
                .family(ExternalPayment.Family.EXTERNAL_PAYMENT)
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .paymentType(ExternalPayment.ExternalPaymentDirection.DEPOSIT)
                .pendingAmount(0L)
                .result(ExternalPayment.TransactionResult.APPROVED)
                .settledAmount(0L)
                .userDefinedId("user_defined_id")
                .eventType(ExternalPaymentCreatedWebhookEvent.EventType.EXTERNAL_PAYMENT_CREATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofExternalPaymentCreated(externalPaymentCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).contains(externalPaymentCreated)
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofExternalPaymentCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofExternalPaymentCreated(
                ExternalPaymentCreatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .status(ExternalPayment.TransactionStatus.PENDING)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .category(ExternalPayment.ExternalPaymentCategory.EXTERNAL_WIRE)
                    .currency("currency")
                    .addEvent(
                        ExternalPayment.ExternalPaymentEvent.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .amount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .addDetailedResult(
                                ExternalPayment.ExternalPaymentEvent.DetailedResults.APPROVED
                            )
                            .effectiveDate(LocalDate.parse("2019-12-27"))
                            .memo("memo")
                            .result(ExternalPayment.ExternalPaymentEvent.TransactionResult.APPROVED)
                            .type(
                                ExternalPayment.ExternalPaymentEvent.ExternalPaymentEventType
                                    .EXTERNAL_WIRE_INITIATED
                            )
                            .build()
                    )
                    .family(ExternalPayment.Family.EXTERNAL_PAYMENT)
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .paymentType(ExternalPayment.ExternalPaymentDirection.DEPOSIT)
                    .pendingAmount(0L)
                    .result(ExternalPayment.TransactionResult.APPROVED)
                    .settledAmount(0L)
                    .userDefinedId("user_defined_id")
                    .eventType(
                        ExternalPaymentCreatedWebhookEvent.EventType.EXTERNAL_PAYMENT_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofExternalPaymentUpdated() {
        val externalPaymentUpdated =
            ExternalPaymentUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .status(ExternalPayment.TransactionStatus.PENDING)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .category(ExternalPayment.ExternalPaymentCategory.EXTERNAL_WIRE)
                .currency("currency")
                .addEvent(
                    ExternalPayment.ExternalPaymentEvent.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .amount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .addDetailedResult(
                            ExternalPayment.ExternalPaymentEvent.DetailedResults.APPROVED
                        )
                        .effectiveDate(LocalDate.parse("2019-12-27"))
                        .memo("memo")
                        .result(ExternalPayment.ExternalPaymentEvent.TransactionResult.APPROVED)
                        .type(
                            ExternalPayment.ExternalPaymentEvent.ExternalPaymentEventType
                                .EXTERNAL_WIRE_INITIATED
                        )
                        .build()
                )
                .family(ExternalPayment.Family.EXTERNAL_PAYMENT)
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .paymentType(ExternalPayment.ExternalPaymentDirection.DEPOSIT)
                .pendingAmount(0L)
                .result(ExternalPayment.TransactionResult.APPROVED)
                .settledAmount(0L)
                .userDefinedId("user_defined_id")
                .eventType(ExternalPaymentUpdatedWebhookEvent.EventType.EXTERNAL_PAYMENT_UPDATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofExternalPaymentUpdated(externalPaymentUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).contains(externalPaymentUpdated)
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofExternalPaymentUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofExternalPaymentUpdated(
                ExternalPaymentUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .status(ExternalPayment.TransactionStatus.PENDING)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .category(ExternalPayment.ExternalPaymentCategory.EXTERNAL_WIRE)
                    .currency("currency")
                    .addEvent(
                        ExternalPayment.ExternalPaymentEvent.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .amount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .addDetailedResult(
                                ExternalPayment.ExternalPaymentEvent.DetailedResults.APPROVED
                            )
                            .effectiveDate(LocalDate.parse("2019-12-27"))
                            .memo("memo")
                            .result(ExternalPayment.ExternalPaymentEvent.TransactionResult.APPROVED)
                            .type(
                                ExternalPayment.ExternalPaymentEvent.ExternalPaymentEventType
                                    .EXTERNAL_WIRE_INITIATED
                            )
                            .build()
                    )
                    .family(ExternalPayment.Family.EXTERNAL_PAYMENT)
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .paymentType(ExternalPayment.ExternalPaymentDirection.DEPOSIT)
                    .pendingAmount(0L)
                    .result(ExternalPayment.TransactionResult.APPROVED)
                    .settledAmount(0L)
                    .userDefinedId("user_defined_id")
                    .eventType(
                        ExternalPaymentUpdatedWebhookEvent.EventType.EXTERNAL_PAYMENT_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofFinancialAccountCreated() {
        val financialAccountCreated =
            FinancialAccountCreatedWebhookEvent.builder()
                .token("b68b7424-aa69-4cbc-a946-30d90181b621")
                .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditConfiguration(
                    FinancialAccount.FinancialAccountCreditConfig.builder()
                        .autoCollectionConfiguration(
                            FinancialAccount.FinancialAccountCreditConfig
                                .AutoCollectionConfigurationResponse
                                .builder()
                                .autoCollectionEnabled(true)
                                .build()
                        )
                        .creditLimit(0L)
                        .creditProductToken("credit_product_token")
                        .externalBankAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .tier("tier")
                        .build()
                )
                .isForBenefitOf(true)
                .nickname("nickname")
                .status(FinancialAccount.FinancialAccountStatus.OPEN)
                .substatus(FinancialAccount.FinancialAccountSubstatus.CHARGED_OFF_DELINQUENT)
                .type(FinancialAccount.Type.ISSUING)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .userDefinedStatus("user_defined_status")
                .accountNumber("account_number")
                .routingNumber("routing_number")
                .eventType(FinancialAccountCreatedWebhookEvent.EventType.FINANCIAL_ACCOUNT_CREATED)
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofFinancialAccountCreated(financialAccountCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).contains(financialAccountCreated)
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofFinancialAccountCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofFinancialAccountCreated(
                FinancialAccountCreatedWebhookEvent.builder()
                    .token("b68b7424-aa69-4cbc-a946-30d90181b621")
                    .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditConfiguration(
                        FinancialAccount.FinancialAccountCreditConfig.builder()
                            .autoCollectionConfiguration(
                                FinancialAccount.FinancialAccountCreditConfig
                                    .AutoCollectionConfigurationResponse
                                    .builder()
                                    .autoCollectionEnabled(true)
                                    .build()
                            )
                            .creditLimit(0L)
                            .creditProductToken("credit_product_token")
                            .externalBankAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .tier("tier")
                            .build()
                    )
                    .isForBenefitOf(true)
                    .nickname("nickname")
                    .status(FinancialAccount.FinancialAccountStatus.OPEN)
                    .substatus(FinancialAccount.FinancialAccountSubstatus.CHARGED_OFF_DELINQUENT)
                    .type(FinancialAccount.Type.ISSUING)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .userDefinedStatus("user_defined_status")
                    .accountNumber("account_number")
                    .routingNumber("routing_number")
                    .eventType(
                        FinancialAccountCreatedWebhookEvent.EventType.FINANCIAL_ACCOUNT_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofFinancialAccountUpdated() {
        val financialAccountUpdated =
            FinancialAccountUpdatedWebhookEvent.builder()
                .token("b68b7424-aa69-4cbc-a946-30d90181b621")
                .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditConfiguration(
                    FinancialAccount.FinancialAccountCreditConfig.builder()
                        .autoCollectionConfiguration(
                            FinancialAccount.FinancialAccountCreditConfig
                                .AutoCollectionConfigurationResponse
                                .builder()
                                .autoCollectionEnabled(true)
                                .build()
                        )
                        .creditLimit(0L)
                        .creditProductToken("credit_product_token")
                        .externalBankAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .tier("tier")
                        .build()
                )
                .isForBenefitOf(true)
                .nickname("nickname")
                .status(FinancialAccount.FinancialAccountStatus.OPEN)
                .substatus(FinancialAccount.FinancialAccountSubstatus.CHARGED_OFF_DELINQUENT)
                .type(FinancialAccount.Type.ISSUING)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .userDefinedStatus("user_defined_status")
                .accountNumber("account_number")
                .routingNumber("routing_number")
                .eventType(FinancialAccountUpdatedWebhookEvent.EventType.FINANCIAL_ACCOUNT_UPDATED)
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofFinancialAccountUpdated(financialAccountUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).contains(financialAccountUpdated)
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofFinancialAccountUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofFinancialAccountUpdated(
                FinancialAccountUpdatedWebhookEvent.builder()
                    .token("b68b7424-aa69-4cbc-a946-30d90181b621")
                    .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditConfiguration(
                        FinancialAccount.FinancialAccountCreditConfig.builder()
                            .autoCollectionConfiguration(
                                FinancialAccount.FinancialAccountCreditConfig
                                    .AutoCollectionConfigurationResponse
                                    .builder()
                                    .autoCollectionEnabled(true)
                                    .build()
                            )
                            .creditLimit(0L)
                            .creditProductToken("credit_product_token")
                            .externalBankAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .tier("tier")
                            .build()
                    )
                    .isForBenefitOf(true)
                    .nickname("nickname")
                    .status(FinancialAccount.FinancialAccountStatus.OPEN)
                    .substatus(FinancialAccount.FinancialAccountSubstatus.CHARGED_OFF_DELINQUENT)
                    .type(FinancialAccount.Type.ISSUING)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .userDefinedStatus("user_defined_status")
                    .accountNumber("account_number")
                    .routingNumber("routing_number")
                    .eventType(
                        FinancialAccountUpdatedWebhookEvent.EventType.FINANCIAL_ACCOUNT_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofFundingEventCreated() {
        val fundingEventCreated =
            FundingEventCreatedWebhookEvent.builder()
                .token("b68b7424-aa69-4cbc-a946-30d90181b621")
                .collectionResourceType(FundingEvent.CollectionResourceType.PAYMENT)
                .addCollectionToken("b68b7424-aa69-4cbc-a946-30d90181b621")
                .created(OffsetDateTime.parse("2024-01-01T00:00:00Z"))
                .highWatermark(OffsetDateTime.parse("2024-01-01T00:00:00Z"))
                .addNetworkSettlementSummary(
                    FundingEvent.FundingEventSettlement.builder()
                        .networkSettlementDate(LocalDate.parse("2024-01-01"))
                        .settledGrossAmount(0L)
                        .build()
                )
                .previousHighWatermark(OffsetDateTime.parse("2024-01-01T00:00:00Z"))
                .updated(OffsetDateTime.parse("2024-01-01T00:00:00Z"))
                .eventType(FundingEventCreatedWebhookEvent.EventType.FUNDING_EVENT_CREATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofFundingEventCreated(fundingEventCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).contains(fundingEventCreated)
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofFundingEventCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofFundingEventCreated(
                FundingEventCreatedWebhookEvent.builder()
                    .token("b68b7424-aa69-4cbc-a946-30d90181b621")
                    .collectionResourceType(FundingEvent.CollectionResourceType.PAYMENT)
                    .addCollectionToken("b68b7424-aa69-4cbc-a946-30d90181b621")
                    .created(OffsetDateTime.parse("2024-01-01T00:00:00Z"))
                    .highWatermark(OffsetDateTime.parse("2024-01-01T00:00:00Z"))
                    .addNetworkSettlementSummary(
                        FundingEvent.FundingEventSettlement.builder()
                            .networkSettlementDate(LocalDate.parse("2024-01-01"))
                            .settledGrossAmount(0L)
                            .build()
                    )
                    .previousHighWatermark(OffsetDateTime.parse("2024-01-01T00:00:00Z"))
                    .updated(OffsetDateTime.parse("2024-01-01T00:00:00Z"))
                    .eventType(FundingEventCreatedWebhookEvent.EventType.FUNDING_EVENT_CREATED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofLoanTapeCreated() {
        val loanTapeCreated =
            LoanTapeCreatedWebhookEvent.builder()
                .token("token")
                .accountStanding(
                    LoanTape.AccountStanding.builder()
                        .consecutiveFullPaymentsMade(0L)
                        .consecutiveMinimumPaymentsMade(0L)
                        .consecutiveMinimumPaymentsMissed(0L)
                        .daysPastDue(0L)
                        .financialAccountState(
                            LoanTape.AccountStanding.FinancialAccountState.builder()
                                .status(
                                    LoanTape.AccountStanding.FinancialAccountState
                                        .FinancialAccountStatus
                                        .OPEN
                                )
                                .substatus(
                                    LoanTape.AccountStanding.FinancialAccountState
                                        .FinancialAccountSubstatus
                                        .CHARGED_OFF_DELINQUENT
                                )
                                .build()
                        )
                        .hasGrace(true)
                        .periodNumber(0L)
                        .periodState(LoanTape.AccountStanding.PeriodState.STANDARD)
                        .build()
                )
                .availableCredit(0L)
                .balances(
                    LoanTape.Balances.builder()
                        .due(CategoryBalances.builder().fees(0L).interest(0L).principal(0L).build())
                        .nextStatementDue(
                            CategoryBalances.builder().fees(0L).interest(0L).principal(0L).build()
                        )
                        .pastDue(
                            CategoryBalances.builder().fees(0L).interest(0L).principal(0L).build()
                        )
                        .pastStatementsDue(
                            CategoryBalances.builder().fees(0L).interest(0L).principal(0L).build()
                        )
                        .build()
                )
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditLimit(0L)
                .creditProductToken("credit_product_token")
                .date(LocalDate.parse("2019-12-27"))
                .dayTotals(
                    StatementTotals.builder()
                        .balanceTransfers(0L)
                        .cashAdvances(0L)
                        .credits(0L)
                        .debits(0L)
                        .fees(0L)
                        .interest(0L)
                        .payments(0L)
                        .purchases(0L)
                        .creditDetails(JsonValue.from(mapOf<String, Any>()))
                        .debitDetails(JsonValue.from(mapOf<String, Any>()))
                        .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .endingBalance(0L)
                .excessCredits(0L)
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .interestDetails(
                    LoanTape.InterestDetails.builder()
                        .actualInterestCharged(0L)
                        .dailyBalanceAmounts(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .effectiveApr(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .interestCalculationMethod(
                            LoanTape.InterestDetails.InterestCalculationMethod.DAILY
                        )
                        .interestForPeriod(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .primeRate("prime_rate")
                        .minimumInterestCharged(0L)
                        .build()
                )
                .minimumPaymentBalance(
                    LoanTape.BalanceDetails.builder().amount(0L).remaining(0L).build()
                )
                .paymentAllocation(
                    LoanTape.PaymentAllocation.builder()
                        .feeDetails(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .fees(0L)
                        .interest(0L)
                        .interestDetails(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .principal(0L)
                        .principalDetails(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .build()
                )
                .periodTotals(
                    StatementTotals.builder()
                        .balanceTransfers(0L)
                        .cashAdvances(0L)
                        .credits(0L)
                        .debits(0L)
                        .fees(0L)
                        .interest(0L)
                        .payments(0L)
                        .purchases(0L)
                        .creditDetails(JsonValue.from(mapOf<String, Any>()))
                        .debitDetails(JsonValue.from(mapOf<String, Any>()))
                        .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .previousStatementBalance(
                    LoanTape.BalanceDetails.builder().amount(0L).remaining(0L).build()
                )
                .startingBalance(0L)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .version(0L)
                .ytdTotals(
                    StatementTotals.builder()
                        .balanceTransfers(0L)
                        .cashAdvances(0L)
                        .credits(0L)
                        .debits(0L)
                        .fees(0L)
                        .interest(0L)
                        .payments(0L)
                        .purchases(0L)
                        .creditDetails(JsonValue.from(mapOf<String, Any>()))
                        .debitDetails(JsonValue.from(mapOf<String, Any>()))
                        .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .tier("tier")
                .eventType(LoanTapeCreatedWebhookEvent.EventType.LOAN_TAPE_CREATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofLoanTapeCreated(loanTapeCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).contains(loanTapeCreated)
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofLoanTapeCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofLoanTapeCreated(
                LoanTapeCreatedWebhookEvent.builder()
                    .token("token")
                    .accountStanding(
                        LoanTape.AccountStanding.builder()
                            .consecutiveFullPaymentsMade(0L)
                            .consecutiveMinimumPaymentsMade(0L)
                            .consecutiveMinimumPaymentsMissed(0L)
                            .daysPastDue(0L)
                            .financialAccountState(
                                LoanTape.AccountStanding.FinancialAccountState.builder()
                                    .status(
                                        LoanTape.AccountStanding.FinancialAccountState
                                            .FinancialAccountStatus
                                            .OPEN
                                    )
                                    .substatus(
                                        LoanTape.AccountStanding.FinancialAccountState
                                            .FinancialAccountSubstatus
                                            .CHARGED_OFF_DELINQUENT
                                    )
                                    .build()
                            )
                            .hasGrace(true)
                            .periodNumber(0L)
                            .periodState(LoanTape.AccountStanding.PeriodState.STANDARD)
                            .build()
                    )
                    .availableCredit(0L)
                    .balances(
                        LoanTape.Balances.builder()
                            .due(
                                CategoryBalances.builder()
                                    .fees(0L)
                                    .interest(0L)
                                    .principal(0L)
                                    .build()
                            )
                            .nextStatementDue(
                                CategoryBalances.builder()
                                    .fees(0L)
                                    .interest(0L)
                                    .principal(0L)
                                    .build()
                            )
                            .pastDue(
                                CategoryBalances.builder()
                                    .fees(0L)
                                    .interest(0L)
                                    .principal(0L)
                                    .build()
                            )
                            .pastStatementsDue(
                                CategoryBalances.builder()
                                    .fees(0L)
                                    .interest(0L)
                                    .principal(0L)
                                    .build()
                            )
                            .build()
                    )
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditLimit(0L)
                    .creditProductToken("credit_product_token")
                    .date(LocalDate.parse("2019-12-27"))
                    .dayTotals(
                        StatementTotals.builder()
                            .balanceTransfers(0L)
                            .cashAdvances(0L)
                            .credits(0L)
                            .debits(0L)
                            .fees(0L)
                            .interest(0L)
                            .payments(0L)
                            .purchases(0L)
                            .creditDetails(JsonValue.from(mapOf<String, Any>()))
                            .debitDetails(JsonValue.from(mapOf<String, Any>()))
                            .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                            .build()
                    )
                    .endingBalance(0L)
                    .excessCredits(0L)
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .interestDetails(
                        LoanTape.InterestDetails.builder()
                            .actualInterestCharged(0L)
                            .dailyBalanceAmounts(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .effectiveApr(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .interestCalculationMethod(
                                LoanTape.InterestDetails.InterestCalculationMethod.DAILY
                            )
                            .interestForPeriod(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .primeRate("prime_rate")
                            .minimumInterestCharged(0L)
                            .build()
                    )
                    .minimumPaymentBalance(
                        LoanTape.BalanceDetails.builder().amount(0L).remaining(0L).build()
                    )
                    .paymentAllocation(
                        LoanTape.PaymentAllocation.builder()
                            .feeDetails(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .fees(0L)
                            .interest(0L)
                            .interestDetails(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .principal(0L)
                            .principalDetails(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .build()
                    )
                    .periodTotals(
                        StatementTotals.builder()
                            .balanceTransfers(0L)
                            .cashAdvances(0L)
                            .credits(0L)
                            .debits(0L)
                            .fees(0L)
                            .interest(0L)
                            .payments(0L)
                            .purchases(0L)
                            .creditDetails(JsonValue.from(mapOf<String, Any>()))
                            .debitDetails(JsonValue.from(mapOf<String, Any>()))
                            .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                            .build()
                    )
                    .previousStatementBalance(
                        LoanTape.BalanceDetails.builder().amount(0L).remaining(0L).build()
                    )
                    .startingBalance(0L)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .version(0L)
                    .ytdTotals(
                        StatementTotals.builder()
                            .balanceTransfers(0L)
                            .cashAdvances(0L)
                            .credits(0L)
                            .debits(0L)
                            .fees(0L)
                            .interest(0L)
                            .payments(0L)
                            .purchases(0L)
                            .creditDetails(JsonValue.from(mapOf<String, Any>()))
                            .debitDetails(JsonValue.from(mapOf<String, Any>()))
                            .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                            .build()
                    )
                    .tier("tier")
                    .eventType(LoanTapeCreatedWebhookEvent.EventType.LOAN_TAPE_CREATED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofLoanTapeUpdated() {
        val loanTapeUpdated =
            LoanTapeUpdatedWebhookEvent.builder()
                .token("token")
                .accountStanding(
                    LoanTape.AccountStanding.builder()
                        .consecutiveFullPaymentsMade(0L)
                        .consecutiveMinimumPaymentsMade(0L)
                        .consecutiveMinimumPaymentsMissed(0L)
                        .daysPastDue(0L)
                        .financialAccountState(
                            LoanTape.AccountStanding.FinancialAccountState.builder()
                                .status(
                                    LoanTape.AccountStanding.FinancialAccountState
                                        .FinancialAccountStatus
                                        .OPEN
                                )
                                .substatus(
                                    LoanTape.AccountStanding.FinancialAccountState
                                        .FinancialAccountSubstatus
                                        .CHARGED_OFF_DELINQUENT
                                )
                                .build()
                        )
                        .hasGrace(true)
                        .periodNumber(0L)
                        .periodState(LoanTape.AccountStanding.PeriodState.STANDARD)
                        .build()
                )
                .availableCredit(0L)
                .balances(
                    LoanTape.Balances.builder()
                        .due(CategoryBalances.builder().fees(0L).interest(0L).principal(0L).build())
                        .nextStatementDue(
                            CategoryBalances.builder().fees(0L).interest(0L).principal(0L).build()
                        )
                        .pastDue(
                            CategoryBalances.builder().fees(0L).interest(0L).principal(0L).build()
                        )
                        .pastStatementsDue(
                            CategoryBalances.builder().fees(0L).interest(0L).principal(0L).build()
                        )
                        .build()
                )
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditLimit(0L)
                .creditProductToken("credit_product_token")
                .date(LocalDate.parse("2019-12-27"))
                .dayTotals(
                    StatementTotals.builder()
                        .balanceTransfers(0L)
                        .cashAdvances(0L)
                        .credits(0L)
                        .debits(0L)
                        .fees(0L)
                        .interest(0L)
                        .payments(0L)
                        .purchases(0L)
                        .creditDetails(JsonValue.from(mapOf<String, Any>()))
                        .debitDetails(JsonValue.from(mapOf<String, Any>()))
                        .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .endingBalance(0L)
                .excessCredits(0L)
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .interestDetails(
                    LoanTape.InterestDetails.builder()
                        .actualInterestCharged(0L)
                        .dailyBalanceAmounts(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .effectiveApr(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .interestCalculationMethod(
                            LoanTape.InterestDetails.InterestCalculationMethod.DAILY
                        )
                        .interestForPeriod(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .primeRate("prime_rate")
                        .minimumInterestCharged(0L)
                        .build()
                )
                .minimumPaymentBalance(
                    LoanTape.BalanceDetails.builder().amount(0L).remaining(0L).build()
                )
                .paymentAllocation(
                    LoanTape.PaymentAllocation.builder()
                        .feeDetails(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .fees(0L)
                        .interest(0L)
                        .interestDetails(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .principal(0L)
                        .principalDetails(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .build()
                )
                .periodTotals(
                    StatementTotals.builder()
                        .balanceTransfers(0L)
                        .cashAdvances(0L)
                        .credits(0L)
                        .debits(0L)
                        .fees(0L)
                        .interest(0L)
                        .payments(0L)
                        .purchases(0L)
                        .creditDetails(JsonValue.from(mapOf<String, Any>()))
                        .debitDetails(JsonValue.from(mapOf<String, Any>()))
                        .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .previousStatementBalance(
                    LoanTape.BalanceDetails.builder().amount(0L).remaining(0L).build()
                )
                .startingBalance(0L)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .version(0L)
                .ytdTotals(
                    StatementTotals.builder()
                        .balanceTransfers(0L)
                        .cashAdvances(0L)
                        .credits(0L)
                        .debits(0L)
                        .fees(0L)
                        .interest(0L)
                        .payments(0L)
                        .purchases(0L)
                        .creditDetails(JsonValue.from(mapOf<String, Any>()))
                        .debitDetails(JsonValue.from(mapOf<String, Any>()))
                        .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .tier("tier")
                .eventType(LoanTapeUpdatedWebhookEvent.EventType.LOAN_TAPE_UPDATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofLoanTapeUpdated(loanTapeUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).contains(loanTapeUpdated)
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofLoanTapeUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofLoanTapeUpdated(
                LoanTapeUpdatedWebhookEvent.builder()
                    .token("token")
                    .accountStanding(
                        LoanTape.AccountStanding.builder()
                            .consecutiveFullPaymentsMade(0L)
                            .consecutiveMinimumPaymentsMade(0L)
                            .consecutiveMinimumPaymentsMissed(0L)
                            .daysPastDue(0L)
                            .financialAccountState(
                                LoanTape.AccountStanding.FinancialAccountState.builder()
                                    .status(
                                        LoanTape.AccountStanding.FinancialAccountState
                                            .FinancialAccountStatus
                                            .OPEN
                                    )
                                    .substatus(
                                        LoanTape.AccountStanding.FinancialAccountState
                                            .FinancialAccountSubstatus
                                            .CHARGED_OFF_DELINQUENT
                                    )
                                    .build()
                            )
                            .hasGrace(true)
                            .periodNumber(0L)
                            .periodState(LoanTape.AccountStanding.PeriodState.STANDARD)
                            .build()
                    )
                    .availableCredit(0L)
                    .balances(
                        LoanTape.Balances.builder()
                            .due(
                                CategoryBalances.builder()
                                    .fees(0L)
                                    .interest(0L)
                                    .principal(0L)
                                    .build()
                            )
                            .nextStatementDue(
                                CategoryBalances.builder()
                                    .fees(0L)
                                    .interest(0L)
                                    .principal(0L)
                                    .build()
                            )
                            .pastDue(
                                CategoryBalances.builder()
                                    .fees(0L)
                                    .interest(0L)
                                    .principal(0L)
                                    .build()
                            )
                            .pastStatementsDue(
                                CategoryBalances.builder()
                                    .fees(0L)
                                    .interest(0L)
                                    .principal(0L)
                                    .build()
                            )
                            .build()
                    )
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditLimit(0L)
                    .creditProductToken("credit_product_token")
                    .date(LocalDate.parse("2019-12-27"))
                    .dayTotals(
                        StatementTotals.builder()
                            .balanceTransfers(0L)
                            .cashAdvances(0L)
                            .credits(0L)
                            .debits(0L)
                            .fees(0L)
                            .interest(0L)
                            .payments(0L)
                            .purchases(0L)
                            .creditDetails(JsonValue.from(mapOf<String, Any>()))
                            .debitDetails(JsonValue.from(mapOf<String, Any>()))
                            .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                            .build()
                    )
                    .endingBalance(0L)
                    .excessCredits(0L)
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .interestDetails(
                        LoanTape.InterestDetails.builder()
                            .actualInterestCharged(0L)
                            .dailyBalanceAmounts(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .effectiveApr(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .interestCalculationMethod(
                                LoanTape.InterestDetails.InterestCalculationMethod.DAILY
                            )
                            .interestForPeriod(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .primeRate("prime_rate")
                            .minimumInterestCharged(0L)
                            .build()
                    )
                    .minimumPaymentBalance(
                        LoanTape.BalanceDetails.builder().amount(0L).remaining(0L).build()
                    )
                    .paymentAllocation(
                        LoanTape.PaymentAllocation.builder()
                            .feeDetails(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .fees(0L)
                            .interest(0L)
                            .interestDetails(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .principal(0L)
                            .principalDetails(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .build()
                    )
                    .periodTotals(
                        StatementTotals.builder()
                            .balanceTransfers(0L)
                            .cashAdvances(0L)
                            .credits(0L)
                            .debits(0L)
                            .fees(0L)
                            .interest(0L)
                            .payments(0L)
                            .purchases(0L)
                            .creditDetails(JsonValue.from(mapOf<String, Any>()))
                            .debitDetails(JsonValue.from(mapOf<String, Any>()))
                            .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                            .build()
                    )
                    .previousStatementBalance(
                        LoanTape.BalanceDetails.builder().amount(0L).remaining(0L).build()
                    )
                    .startingBalance(0L)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .version(0L)
                    .ytdTotals(
                        StatementTotals.builder()
                            .balanceTransfers(0L)
                            .cashAdvances(0L)
                            .credits(0L)
                            .debits(0L)
                            .fees(0L)
                            .interest(0L)
                            .payments(0L)
                            .purchases(0L)
                            .creditDetails(JsonValue.from(mapOf<String, Any>()))
                            .debitDetails(JsonValue.from(mapOf<String, Any>()))
                            .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                            .build()
                    )
                    .tier("tier")
                    .eventType(LoanTapeUpdatedWebhookEvent.EventType.LOAN_TAPE_UPDATED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofManagementOperationCreated() {
        val managementOperationCreated =
            ManagementOperationCreatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .status(ManagementOperationTransaction.TransactionStatus.PENDING)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .category(ManagementOperationTransaction.ManagementOperationCategory.MANAGEMENT_FEE)
                .currency("currency")
                .direction(ManagementOperationTransaction.ManagementOperationDirection.CREDIT)
                .addEvent(
                    ManagementOperationTransaction.ManagementOperationEvent.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .amount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .addDetailedResult(
                            ManagementOperationTransaction.ManagementOperationEvent.DetailedResults
                                .APPROVED
                        )
                        .effectiveDate(LocalDate.parse("2019-12-27"))
                        .memo("memo")
                        .result(
                            ManagementOperationTransaction.ManagementOperationEvent
                                .TransactionResult
                                .APPROVED
                        )
                        .type(
                            ManagementOperationTransaction.ManagementOperationEvent
                                .ManagementOperationEventType
                                .LOSS_WRITE_OFF
                        )
                        .subtype("subtype")
                        .build()
                )
                .externalResource(
                    ExternalResource.builder()
                        .externalResourceToken("external_resource_token")
                        .externalResourceType(ExternalResourceType.STATEMENT)
                        .externalResourceSubToken("external_resource_sub_token")
                        .build()
                )
                .family(ManagementOperationTransaction.Family.MANAGEMENT_OPERATION)
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .pendingAmount(0L)
                .result(ManagementOperationTransaction.TransactionResult.APPROVED)
                .settledAmount(0L)
                .transactionSeries(
                    ManagementOperationTransaction.TransactionSeries.builder()
                        .relatedTransactionEventToken("123e4567-e89b-12d3-a456-426614174000")
                        .relatedTransactionToken("123e4567-e89b-12d3-a456-426614174000")
                        .type("FEE")
                        .build()
                )
                .userDefinedId("user_defined_id")
                .eventType(
                    ManagementOperationCreatedWebhookEvent.EventType.MANAGEMENT_OPERATION_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofManagementOperationCreated(managementOperationCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated())
            .contains(managementOperationCreated)
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofManagementOperationCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofManagementOperationCreated(
                ManagementOperationCreatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .status(ManagementOperationTransaction.TransactionStatus.PENDING)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .category(
                        ManagementOperationTransaction.ManagementOperationCategory.MANAGEMENT_FEE
                    )
                    .currency("currency")
                    .direction(ManagementOperationTransaction.ManagementOperationDirection.CREDIT)
                    .addEvent(
                        ManagementOperationTransaction.ManagementOperationEvent.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .amount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .addDetailedResult(
                                ManagementOperationTransaction.ManagementOperationEvent
                                    .DetailedResults
                                    .APPROVED
                            )
                            .effectiveDate(LocalDate.parse("2019-12-27"))
                            .memo("memo")
                            .result(
                                ManagementOperationTransaction.ManagementOperationEvent
                                    .TransactionResult
                                    .APPROVED
                            )
                            .type(
                                ManagementOperationTransaction.ManagementOperationEvent
                                    .ManagementOperationEventType
                                    .LOSS_WRITE_OFF
                            )
                            .subtype("subtype")
                            .build()
                    )
                    .externalResource(
                        ExternalResource.builder()
                            .externalResourceToken("external_resource_token")
                            .externalResourceType(ExternalResourceType.STATEMENT)
                            .externalResourceSubToken("external_resource_sub_token")
                            .build()
                    )
                    .family(ManagementOperationTransaction.Family.MANAGEMENT_OPERATION)
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .pendingAmount(0L)
                    .result(ManagementOperationTransaction.TransactionResult.APPROVED)
                    .settledAmount(0L)
                    .transactionSeries(
                        ManagementOperationTransaction.TransactionSeries.builder()
                            .relatedTransactionEventToken("123e4567-e89b-12d3-a456-426614174000")
                            .relatedTransactionToken("123e4567-e89b-12d3-a456-426614174000")
                            .type("FEE")
                            .build()
                    )
                    .userDefinedId("user_defined_id")
                    .eventType(
                        ManagementOperationCreatedWebhookEvent.EventType
                            .MANAGEMENT_OPERATION_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofManagementOperationUpdated() {
        val managementOperationUpdated =
            ManagementOperationUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .status(ManagementOperationTransaction.TransactionStatus.PENDING)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .category(ManagementOperationTransaction.ManagementOperationCategory.MANAGEMENT_FEE)
                .currency("currency")
                .direction(ManagementOperationTransaction.ManagementOperationDirection.CREDIT)
                .addEvent(
                    ManagementOperationTransaction.ManagementOperationEvent.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .amount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .addDetailedResult(
                            ManagementOperationTransaction.ManagementOperationEvent.DetailedResults
                                .APPROVED
                        )
                        .effectiveDate(LocalDate.parse("2019-12-27"))
                        .memo("memo")
                        .result(
                            ManagementOperationTransaction.ManagementOperationEvent
                                .TransactionResult
                                .APPROVED
                        )
                        .type(
                            ManagementOperationTransaction.ManagementOperationEvent
                                .ManagementOperationEventType
                                .LOSS_WRITE_OFF
                        )
                        .subtype("subtype")
                        .build()
                )
                .externalResource(
                    ExternalResource.builder()
                        .externalResourceToken("external_resource_token")
                        .externalResourceType(ExternalResourceType.STATEMENT)
                        .externalResourceSubToken("external_resource_sub_token")
                        .build()
                )
                .family(ManagementOperationTransaction.Family.MANAGEMENT_OPERATION)
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .pendingAmount(0L)
                .result(ManagementOperationTransaction.TransactionResult.APPROVED)
                .settledAmount(0L)
                .transactionSeries(
                    ManagementOperationTransaction.TransactionSeries.builder()
                        .relatedTransactionEventToken("123e4567-e89b-12d3-a456-426614174000")
                        .relatedTransactionToken("123e4567-e89b-12d3-a456-426614174000")
                        .type("FEE")
                        .build()
                )
                .userDefinedId("user_defined_id")
                .eventType(
                    ManagementOperationUpdatedWebhookEvent.EventType.MANAGEMENT_OPERATION_UPDATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofManagementOperationUpdated(managementOperationUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated())
            .contains(managementOperationUpdated)
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofManagementOperationUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofManagementOperationUpdated(
                ManagementOperationUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .status(ManagementOperationTransaction.TransactionStatus.PENDING)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .category(
                        ManagementOperationTransaction.ManagementOperationCategory.MANAGEMENT_FEE
                    )
                    .currency("currency")
                    .direction(ManagementOperationTransaction.ManagementOperationDirection.CREDIT)
                    .addEvent(
                        ManagementOperationTransaction.ManagementOperationEvent.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .amount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .addDetailedResult(
                                ManagementOperationTransaction.ManagementOperationEvent
                                    .DetailedResults
                                    .APPROVED
                            )
                            .effectiveDate(LocalDate.parse("2019-12-27"))
                            .memo("memo")
                            .result(
                                ManagementOperationTransaction.ManagementOperationEvent
                                    .TransactionResult
                                    .APPROVED
                            )
                            .type(
                                ManagementOperationTransaction.ManagementOperationEvent
                                    .ManagementOperationEventType
                                    .LOSS_WRITE_OFF
                            )
                            .subtype("subtype")
                            .build()
                    )
                    .externalResource(
                        ExternalResource.builder()
                            .externalResourceToken("external_resource_token")
                            .externalResourceType(ExternalResourceType.STATEMENT)
                            .externalResourceSubToken("external_resource_sub_token")
                            .build()
                    )
                    .family(ManagementOperationTransaction.Family.MANAGEMENT_OPERATION)
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .pendingAmount(0L)
                    .result(ManagementOperationTransaction.TransactionResult.APPROVED)
                    .settledAmount(0L)
                    .transactionSeries(
                        ManagementOperationTransaction.TransactionSeries.builder()
                            .relatedTransactionEventToken("123e4567-e89b-12d3-a456-426614174000")
                            .relatedTransactionToken("123e4567-e89b-12d3-a456-426614174000")
                            .type("FEE")
                            .build()
                    )
                    .userDefinedId("user_defined_id")
                    .eventType(
                        ManagementOperationUpdatedWebhookEvent.EventType
                            .MANAGEMENT_OPERATION_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofInternalTransactionCreated() {
        val internalTransactionCreated =
            InternalTransactionCreatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .category(InternalTransaction.Category.INTERNAL)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("currency")
                .descriptor("descriptor")
                .addEvent(
                    InternalTransaction.InternalAdjustmentEvent.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .amount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .result(
                            InternalTransaction.InternalAdjustmentEvent.TransactionResult.APPROVED
                        )
                        .type(InternalTransaction.InternalAdjustmentEvent.Type.INTERNAL_ADJUSTMENT)
                        .build()
                )
                .pendingAmount(0L)
                .result(InternalTransaction.TransactionResult.APPROVED)
                .settledAmount(0L)
                .status(InternalTransaction.TransactionStatus.PENDING)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventType(
                    InternalTransactionCreatedWebhookEvent.EventType.INTERNAL_TRANSACTION_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofInternalTransactionCreated(internalTransactionCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated())
            .contains(internalTransactionCreated)
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofInternalTransactionCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofInternalTransactionCreated(
                InternalTransactionCreatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .category(InternalTransaction.Category.INTERNAL)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("currency")
                    .descriptor("descriptor")
                    .addEvent(
                        InternalTransaction.InternalAdjustmentEvent.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .amount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .result(
                                InternalTransaction.InternalAdjustmentEvent.TransactionResult
                                    .APPROVED
                            )
                            .type(
                                InternalTransaction.InternalAdjustmentEvent.Type.INTERNAL_ADJUSTMENT
                            )
                            .build()
                    )
                    .pendingAmount(0L)
                    .result(InternalTransaction.TransactionResult.APPROVED)
                    .settledAmount(0L)
                    .status(InternalTransaction.TransactionStatus.PENDING)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .eventType(
                        InternalTransactionCreatedWebhookEvent.EventType
                            .INTERNAL_TRANSACTION_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofInternalTransactionUpdated() {
        val internalTransactionUpdated =
            InternalTransactionUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .category(InternalTransaction.Category.INTERNAL)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("currency")
                .descriptor("descriptor")
                .addEvent(
                    InternalTransaction.InternalAdjustmentEvent.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .amount(0L)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .result(
                            InternalTransaction.InternalAdjustmentEvent.TransactionResult.APPROVED
                        )
                        .type(InternalTransaction.InternalAdjustmentEvent.Type.INTERNAL_ADJUSTMENT)
                        .build()
                )
                .pendingAmount(0L)
                .result(InternalTransaction.TransactionResult.APPROVED)
                .settledAmount(0L)
                .status(InternalTransaction.TransactionStatus.PENDING)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventType(
                    InternalTransactionUpdatedWebhookEvent.EventType.INTERNAL_TRANSACTION_UPDATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofInternalTransactionUpdated(internalTransactionUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated())
            .contains(internalTransactionUpdated)
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofInternalTransactionUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofInternalTransactionUpdated(
                InternalTransactionUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .category(InternalTransaction.Category.INTERNAL)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("currency")
                    .descriptor("descriptor")
                    .addEvent(
                        InternalTransaction.InternalAdjustmentEvent.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .amount(0L)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .result(
                                InternalTransaction.InternalAdjustmentEvent.TransactionResult
                                    .APPROVED
                            )
                            .type(
                                InternalTransaction.InternalAdjustmentEvent.Type.INTERNAL_ADJUSTMENT
                            )
                            .build()
                    )
                    .pendingAmount(0L)
                    .result(InternalTransaction.TransactionResult.APPROVED)
                    .settledAmount(0L)
                    .status(InternalTransaction.TransactionStatus.PENDING)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .eventType(
                        InternalTransactionUpdatedWebhookEvent.EventType
                            .INTERNAL_TRANSACTION_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofNetworkTotalCreated() {
        val networkTotalCreated =
            NetworkTotalCreatedWebhookEvent.builder()
                .token("12cf7505-06a8-435e-b1c7-4c430d02f6c3")
                .amounts(
                    NetworkTotal.Amounts.builder()
                        .grossSettlement(100L)
                        .interchangeFees(-25L)
                        .netSettlement(85L)
                        .visaCharges(10L)
                        .build()
                )
                .created(OffsetDateTime.parse("2025-02-25T13:07:31.419631Z"))
                .currency("CAD")
                .institutionId("1000000000")
                .isComplete(true)
                .network(NetworkTotal.Network.VISA)
                .reportDate(LocalDate.parse("2025-02-25"))
                .settlementInstitutionId("1000000001")
                .settlementService("015")
                .updated(OffsetDateTime.parse("2025-02-25T13:07:31.419631Z"))
                .cycle(0L)
                .eventType(NetworkTotalCreatedWebhookEvent.EventType.NETWORK_TOTAL_CREATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofNetworkTotalCreated(networkTotalCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).contains(networkTotalCreated)
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofNetworkTotalCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofNetworkTotalCreated(
                NetworkTotalCreatedWebhookEvent.builder()
                    .token("12cf7505-06a8-435e-b1c7-4c430d02f6c3")
                    .amounts(
                        NetworkTotal.Amounts.builder()
                            .grossSettlement(100L)
                            .interchangeFees(-25L)
                            .netSettlement(85L)
                            .visaCharges(10L)
                            .build()
                    )
                    .created(OffsetDateTime.parse("2025-02-25T13:07:31.419631Z"))
                    .currency("CAD")
                    .institutionId("1000000000")
                    .isComplete(true)
                    .network(NetworkTotal.Network.VISA)
                    .reportDate(LocalDate.parse("2025-02-25"))
                    .settlementInstitutionId("1000000001")
                    .settlementService("015")
                    .updated(OffsetDateTime.parse("2025-02-25T13:07:31.419631Z"))
                    .cycle(0L)
                    .eventType(NetworkTotalCreatedWebhookEvent.EventType.NETWORK_TOTAL_CREATED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofNetworkTotalUpdated() {
        val networkTotalUpdated =
            NetworkTotalUpdatedWebhookEvent.builder()
                .token("12cf7505-06a8-435e-b1c7-4c430d02f6c3")
                .amounts(
                    NetworkTotal.Amounts.builder()
                        .grossSettlement(100L)
                        .interchangeFees(-25L)
                        .netSettlement(85L)
                        .visaCharges(10L)
                        .build()
                )
                .created(OffsetDateTime.parse("2025-02-25T13:07:31.419631Z"))
                .currency("CAD")
                .institutionId("1000000000")
                .isComplete(true)
                .network(NetworkTotal.Network.VISA)
                .reportDate(LocalDate.parse("2025-02-25"))
                .settlementInstitutionId("1000000001")
                .settlementService("015")
                .updated(OffsetDateTime.parse("2025-02-25T13:07:31.419631Z"))
                .cycle(0L)
                .eventType(NetworkTotalUpdatedWebhookEvent.EventType.NETWORK_TOTAL_UPDATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofNetworkTotalUpdated(networkTotalUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).contains(networkTotalUpdated)
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofNetworkTotalUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofNetworkTotalUpdated(
                NetworkTotalUpdatedWebhookEvent.builder()
                    .token("12cf7505-06a8-435e-b1c7-4c430d02f6c3")
                    .amounts(
                        NetworkTotal.Amounts.builder()
                            .grossSettlement(100L)
                            .interchangeFees(-25L)
                            .netSettlement(85L)
                            .visaCharges(10L)
                            .build()
                    )
                    .created(OffsetDateTime.parse("2025-02-25T13:07:31.419631Z"))
                    .currency("CAD")
                    .institutionId("1000000000")
                    .isComplete(true)
                    .network(NetworkTotal.Network.VISA)
                    .reportDate(LocalDate.parse("2025-02-25"))
                    .settlementInstitutionId("1000000001")
                    .settlementService("015")
                    .updated(OffsetDateTime.parse("2025-02-25T13:07:31.419631Z"))
                    .cycle(0L)
                    .eventType(NetworkTotalUpdatedWebhookEvent.EventType.NETWORK_TOTAL_UPDATED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofPaymentTransactionCreated() {
        val paymentTransactionCreated =
            PaymentTransactionCreatedWebhookEvent.builder()
                .token("bd4efddb-771b-49e3-9af9-49b077ab5eb8")
                .category(Payment.TransactionCategory.ACH)
                .created(OffsetDateTime.parse("2025-10-27T20:12:22Z"))
                .descriptor("ach_origination_credit")
                .direction(Payment.Direction.CREDIT)
                .addEvent(
                    Payment.PaymentEvent.builder()
                        .token("327dccc3-fe42-54d2-962c-7f8135805464")
                        .amount(-1588L)
                        .created(OffsetDateTime.parse("2025-10-27T20:12:22Z"))
                        .result(Payment.PaymentEvent.Result.APPROVED)
                        .type(Payment.PaymentEvent.PaymentEventType.ACH_ORIGINATION_INITIATED)
                        .addDetailedResult(Payment.PaymentEvent.DetailedResult.APPROVED)
                        .externalId("external_id")
                        .build()
                )
                .addEvent(
                    Payment.PaymentEvent.builder()
                        .token("f9165477-7cfc-53c6-98f1-84e9ec856a60")
                        .amount(-1588L)
                        .created(OffsetDateTime.parse("2025-10-27T20:12:25Z"))
                        .result(Payment.PaymentEvent.Result.APPROVED)
                        .type(Payment.PaymentEvent.PaymentEventType.ACH_ORIGINATION_REVIEWED)
                        .addDetailedResult(Payment.PaymentEvent.DetailedResult.APPROVED)
                        .externalId("external_id")
                        .build()
                )
                .family(Payment.Family.PAYMENT)
                .financialAccountToken("35b0c466-a3e3-519a-9549-ead6a6a2277d")
                .method(Payment.Method.ACH_NEXT_DAY)
                .methodAttributes(
                    Payment.MethodAttributes.AchMethodAttributes.builder()
                        .secCode(Payment.MethodAttributes.AchMethodAttributes.SecCode.CCD)
                        .achHoldPeriod(1L)
                        .addenda(null)
                        .companyId("1111111111")
                        .receiptRoutingNumber(null)
                        .retries(0L)
                        .returnReasonCode(null)
                        .addTraceNumber("string")
                        .build()
                )
                .pendingAmount(-1588L)
                .relatedAccountTokens(
                    Payment.RelatedAccountTokens.builder()
                        .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .businessAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .build()
                )
                .result(Payment.TransactionResult.APPROVED)
                .settledAmount(0L)
                .source(Payment.Source.LITHIC)
                .status(Payment.TransactionStatus.PENDING)
                .updated(OffsetDateTime.parse("2025-10-27T20:12:25Z"))
                .currency("USD")
                .expectedReleaseDate(null)
                .externalBankAccountToken("feb4fee1-2414-4c38-a5f6-9deac293c8f4")
                .type(Payment.TransferType.ORIGINATION_CREDIT)
                .userDefinedId(null)
                .eventType(
                    PaymentTransactionCreatedWebhookEvent.EventType.PAYMENT_TRANSACTION_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofPaymentTransactionCreated(paymentTransactionCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated())
            .contains(paymentTransactionCreated)
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofPaymentTransactionCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofPaymentTransactionCreated(
                PaymentTransactionCreatedWebhookEvent.builder()
                    .token("bd4efddb-771b-49e3-9af9-49b077ab5eb8")
                    .category(Payment.TransactionCategory.ACH)
                    .created(OffsetDateTime.parse("2025-10-27T20:12:22Z"))
                    .descriptor("ach_origination_credit")
                    .direction(Payment.Direction.CREDIT)
                    .addEvent(
                        Payment.PaymentEvent.builder()
                            .token("327dccc3-fe42-54d2-962c-7f8135805464")
                            .amount(-1588L)
                            .created(OffsetDateTime.parse("2025-10-27T20:12:22Z"))
                            .result(Payment.PaymentEvent.Result.APPROVED)
                            .type(Payment.PaymentEvent.PaymentEventType.ACH_ORIGINATION_INITIATED)
                            .addDetailedResult(Payment.PaymentEvent.DetailedResult.APPROVED)
                            .externalId("external_id")
                            .build()
                    )
                    .addEvent(
                        Payment.PaymentEvent.builder()
                            .token("f9165477-7cfc-53c6-98f1-84e9ec856a60")
                            .amount(-1588L)
                            .created(OffsetDateTime.parse("2025-10-27T20:12:25Z"))
                            .result(Payment.PaymentEvent.Result.APPROVED)
                            .type(Payment.PaymentEvent.PaymentEventType.ACH_ORIGINATION_REVIEWED)
                            .addDetailedResult(Payment.PaymentEvent.DetailedResult.APPROVED)
                            .externalId("external_id")
                            .build()
                    )
                    .family(Payment.Family.PAYMENT)
                    .financialAccountToken("35b0c466-a3e3-519a-9549-ead6a6a2277d")
                    .method(Payment.Method.ACH_NEXT_DAY)
                    .methodAttributes(
                        Payment.MethodAttributes.AchMethodAttributes.builder()
                            .secCode(Payment.MethodAttributes.AchMethodAttributes.SecCode.CCD)
                            .achHoldPeriod(1L)
                            .addenda(null)
                            .companyId("1111111111")
                            .receiptRoutingNumber(null)
                            .retries(0L)
                            .returnReasonCode(null)
                            .addTraceNumber("string")
                            .build()
                    )
                    .pendingAmount(-1588L)
                    .relatedAccountTokens(
                        Payment.RelatedAccountTokens.builder()
                            .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .businessAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .build()
                    )
                    .result(Payment.TransactionResult.APPROVED)
                    .settledAmount(0L)
                    .source(Payment.Source.LITHIC)
                    .status(Payment.TransactionStatus.PENDING)
                    .updated(OffsetDateTime.parse("2025-10-27T20:12:25Z"))
                    .currency("USD")
                    .expectedReleaseDate(null)
                    .externalBankAccountToken("feb4fee1-2414-4c38-a5f6-9deac293c8f4")
                    .type(Payment.TransferType.ORIGINATION_CREDIT)
                    .userDefinedId(null)
                    .eventType(
                        PaymentTransactionCreatedWebhookEvent.EventType.PAYMENT_TRANSACTION_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofPaymentTransactionUpdated() {
        val paymentTransactionUpdated =
            PaymentTransactionUpdatedWebhookEvent.builder()
                .token("bd4efddb-771b-49e3-9af9-49b077ab5eb8")
                .category(Payment.TransactionCategory.ACH)
                .created(OffsetDateTime.parse("2025-10-27T20:12:22Z"))
                .descriptor("ach_origination_credit")
                .direction(Payment.Direction.CREDIT)
                .addEvent(
                    Payment.PaymentEvent.builder()
                        .token("327dccc3-fe42-54d2-962c-7f8135805464")
                        .amount(-1588L)
                        .created(OffsetDateTime.parse("2025-10-27T20:12:22Z"))
                        .result(Payment.PaymentEvent.Result.APPROVED)
                        .type(Payment.PaymentEvent.PaymentEventType.ACH_ORIGINATION_INITIATED)
                        .addDetailedResult(Payment.PaymentEvent.DetailedResult.APPROVED)
                        .externalId("external_id")
                        .build()
                )
                .addEvent(
                    Payment.PaymentEvent.builder()
                        .token("f9165477-7cfc-53c6-98f1-84e9ec856a60")
                        .amount(-1588L)
                        .created(OffsetDateTime.parse("2025-10-27T20:12:25Z"))
                        .result(Payment.PaymentEvent.Result.APPROVED)
                        .type(Payment.PaymentEvent.PaymentEventType.ACH_ORIGINATION_REVIEWED)
                        .addDetailedResult(Payment.PaymentEvent.DetailedResult.APPROVED)
                        .externalId("external_id")
                        .build()
                )
                .family(Payment.Family.PAYMENT)
                .financialAccountToken("35b0c466-a3e3-519a-9549-ead6a6a2277d")
                .method(Payment.Method.ACH_NEXT_DAY)
                .methodAttributes(
                    Payment.MethodAttributes.AchMethodAttributes.builder()
                        .secCode(Payment.MethodAttributes.AchMethodAttributes.SecCode.CCD)
                        .achHoldPeriod(1L)
                        .addenda(null)
                        .companyId("1111111111")
                        .receiptRoutingNumber(null)
                        .retries(0L)
                        .returnReasonCode(null)
                        .addTraceNumber("string")
                        .build()
                )
                .pendingAmount(-1588L)
                .relatedAccountTokens(
                    Payment.RelatedAccountTokens.builder()
                        .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .businessAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .build()
                )
                .result(Payment.TransactionResult.APPROVED)
                .settledAmount(0L)
                .source(Payment.Source.LITHIC)
                .status(Payment.TransactionStatus.PENDING)
                .updated(OffsetDateTime.parse("2025-10-27T20:12:25Z"))
                .currency("USD")
                .expectedReleaseDate(null)
                .externalBankAccountToken("feb4fee1-2414-4c38-a5f6-9deac293c8f4")
                .type(Payment.TransferType.ORIGINATION_CREDIT)
                .userDefinedId(null)
                .eventType(
                    PaymentTransactionUpdatedWebhookEvent.EventType.PAYMENT_TRANSACTION_UPDATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofPaymentTransactionUpdated(paymentTransactionUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated())
            .contains(paymentTransactionUpdated)
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofPaymentTransactionUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofPaymentTransactionUpdated(
                PaymentTransactionUpdatedWebhookEvent.builder()
                    .token("bd4efddb-771b-49e3-9af9-49b077ab5eb8")
                    .category(Payment.TransactionCategory.ACH)
                    .created(OffsetDateTime.parse("2025-10-27T20:12:22Z"))
                    .descriptor("ach_origination_credit")
                    .direction(Payment.Direction.CREDIT)
                    .addEvent(
                        Payment.PaymentEvent.builder()
                            .token("327dccc3-fe42-54d2-962c-7f8135805464")
                            .amount(-1588L)
                            .created(OffsetDateTime.parse("2025-10-27T20:12:22Z"))
                            .result(Payment.PaymentEvent.Result.APPROVED)
                            .type(Payment.PaymentEvent.PaymentEventType.ACH_ORIGINATION_INITIATED)
                            .addDetailedResult(Payment.PaymentEvent.DetailedResult.APPROVED)
                            .externalId("external_id")
                            .build()
                    )
                    .addEvent(
                        Payment.PaymentEvent.builder()
                            .token("f9165477-7cfc-53c6-98f1-84e9ec856a60")
                            .amount(-1588L)
                            .created(OffsetDateTime.parse("2025-10-27T20:12:25Z"))
                            .result(Payment.PaymentEvent.Result.APPROVED)
                            .type(Payment.PaymentEvent.PaymentEventType.ACH_ORIGINATION_REVIEWED)
                            .addDetailedResult(Payment.PaymentEvent.DetailedResult.APPROVED)
                            .externalId("external_id")
                            .build()
                    )
                    .family(Payment.Family.PAYMENT)
                    .financialAccountToken("35b0c466-a3e3-519a-9549-ead6a6a2277d")
                    .method(Payment.Method.ACH_NEXT_DAY)
                    .methodAttributes(
                        Payment.MethodAttributes.AchMethodAttributes.builder()
                            .secCode(Payment.MethodAttributes.AchMethodAttributes.SecCode.CCD)
                            .achHoldPeriod(1L)
                            .addenda(null)
                            .companyId("1111111111")
                            .receiptRoutingNumber(null)
                            .retries(0L)
                            .returnReasonCode(null)
                            .addTraceNumber("string")
                            .build()
                    )
                    .pendingAmount(-1588L)
                    .relatedAccountTokens(
                        Payment.RelatedAccountTokens.builder()
                            .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .businessAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .build()
                    )
                    .result(Payment.TransactionResult.APPROVED)
                    .settledAmount(0L)
                    .source(Payment.Source.LITHIC)
                    .status(Payment.TransactionStatus.PENDING)
                    .updated(OffsetDateTime.parse("2025-10-27T20:12:25Z"))
                    .currency("USD")
                    .expectedReleaseDate(null)
                    .externalBankAccountToken("feb4fee1-2414-4c38-a5f6-9deac293c8f4")
                    .type(Payment.TransferType.ORIGINATION_CREDIT)
                    .userDefinedId(null)
                    .eventType(
                        PaymentTransactionUpdatedWebhookEvent.EventType.PAYMENT_TRANSACTION_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofSettlementReportUpdated() {
        val settlementReportUpdated =
            SettlementReportUpdatedWebhookEvent.builder()
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("USD")
                .addDetail(
                    SettlementSummaryDetails.builder()
                        .currency("USD")
                        .disputesGrossAmount(0L)
                        .institution("00001")
                        .interchangeGrossAmount(-7L)
                        .network(SettlementSummaryDetails.Network.MASTERCARD)
                        .otherFeesGrossAmount(0L)
                        .settledNetAmount(1893L)
                        .transactionsGrossAmount(1900L)
                        .build()
                )
                .disputesGrossAmount(0L)
                .interchangeGrossAmount(-7L)
                .isComplete(true)
                .otherFeesGrossAmount(0L)
                .reportDate("2023-06-01")
                .settledNetAmount(1893L)
                .transactionsGrossAmount(1900L)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventType(SettlementReportUpdatedWebhookEvent.EventType.SETTLEMENT_REPORT_UPDATED)
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofSettlementReportUpdated(settlementReportUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).contains(settlementReportUpdated)
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofSettlementReportUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofSettlementReportUpdated(
                SettlementReportUpdatedWebhookEvent.builder()
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("USD")
                    .addDetail(
                        SettlementSummaryDetails.builder()
                            .currency("USD")
                            .disputesGrossAmount(0L)
                            .institution("00001")
                            .interchangeGrossAmount(-7L)
                            .network(SettlementSummaryDetails.Network.MASTERCARD)
                            .otherFeesGrossAmount(0L)
                            .settledNetAmount(1893L)
                            .transactionsGrossAmount(1900L)
                            .build()
                    )
                    .disputesGrossAmount(0L)
                    .interchangeGrossAmount(-7L)
                    .isComplete(true)
                    .otherFeesGrossAmount(0L)
                    .reportDate("2023-06-01")
                    .settledNetAmount(1893L)
                    .transactionsGrossAmount(1900L)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .eventType(
                        SettlementReportUpdatedWebhookEvent.EventType.SETTLEMENT_REPORT_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofStatementsCreated() {
        val statementsCreated =
            StatementsCreatedWebhookEvent.builder()
                .token("token")
                .accountStanding(
                    Statement.AccountStanding.builder()
                        .consecutiveFullPaymentsMade(0L)
                        .consecutiveMinimumPaymentsMade(0L)
                        .consecutiveMinimumPaymentsMissed(0L)
                        .daysPastDue(0L)
                        .financialAccountState(
                            Statement.AccountStanding.FinancialAccountState.builder()
                                .status(
                                    Statement.AccountStanding.FinancialAccountState
                                        .FinancialAccountStatus
                                        .OPEN
                                )
                                .substatus(
                                    Statement.AccountStanding.FinancialAccountState
                                        .FinancialAccountSubstatus
                                        .CHARGED_OFF_DELINQUENT
                                )
                                .build()
                        )
                        .hasGrace(true)
                        .periodNumber(0L)
                        .periodState(Statement.AccountStanding.PeriodState.STANDARD)
                        .build()
                )
                .amountDue(Statement.AmountDue.builder().amount(0L).pastDue(0L).build())
                .availableCredit(0L)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .creditLimit(0L)
                .creditProductToken("credit_product_token")
                .daysInBillingCycle(0L)
                .endingBalance(0L)
                .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .paymentDueDate(LocalDate.parse("2019-12-27"))
                .periodTotals(
                    StatementTotals.builder()
                        .balanceTransfers(0L)
                        .cashAdvances(0L)
                        .credits(0L)
                        .debits(0L)
                        .fees(0L)
                        .interest(0L)
                        .payments(0L)
                        .purchases(0L)
                        .creditDetails(JsonValue.from(mapOf<String, Any>()))
                        .debitDetails(JsonValue.from(mapOf<String, Any>()))
                        .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .startingBalance(0L)
                .statementEndDate(LocalDate.parse("2019-12-27"))
                .statementStartDate(LocalDate.parse("2019-12-27"))
                .statementType(Statement.StatementType.INITIAL)
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .ytdTotals(
                    StatementTotals.builder()
                        .balanceTransfers(0L)
                        .cashAdvances(0L)
                        .credits(0L)
                        .debits(0L)
                        .fees(0L)
                        .interest(0L)
                        .payments(0L)
                        .purchases(0L)
                        .creditDetails(JsonValue.from(mapOf<String, Any>()))
                        .debitDetails(JsonValue.from(mapOf<String, Any>()))
                        .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                        .build()
                )
                .interestDetails(
                    Statement.InterestDetails.builder()
                        .actualInterestCharged(0L)
                        .dailyBalanceAmounts(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .effectiveApr(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .interestCalculationMethod(
                            Statement.InterestDetails.InterestCalculationMethod.DAILY
                        )
                        .interestForPeriod(
                            CategoryDetails.builder()
                                .balanceTransfers("balance_transfers")
                                .cashAdvances("cash_advances")
                                .purchases("purchases")
                                .build()
                        )
                        .primeRate("prime_rate")
                        .minimumInterestCharged(0L)
                        .build()
                )
                .nextPaymentDueDate(LocalDate.parse("2019-12-27"))
                .nextStatementEndDate(LocalDate.parse("2019-12-27"))
                .payoffDetails(
                    Statement.PayoffDetails.builder()
                        .minimumPaymentMonths("minimum_payment_months")
                        .minimumPaymentTotal("minimum_payment_total")
                        .payoffPeriodLengthMonths(0L)
                        .payoffPeriodMonthlyPaymentAmount(0L)
                        .payoffPeriodPaymentTotal(0L)
                        .build()
                )
                .eventType(StatementsCreatedWebhookEvent.EventType.STATEMENTS_CREATED)
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofStatementsCreated(statementsCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).contains(statementsCreated)
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofStatementsCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofStatementsCreated(
                StatementsCreatedWebhookEvent.builder()
                    .token("token")
                    .accountStanding(
                        Statement.AccountStanding.builder()
                            .consecutiveFullPaymentsMade(0L)
                            .consecutiveMinimumPaymentsMade(0L)
                            .consecutiveMinimumPaymentsMissed(0L)
                            .daysPastDue(0L)
                            .financialAccountState(
                                Statement.AccountStanding.FinancialAccountState.builder()
                                    .status(
                                        Statement.AccountStanding.FinancialAccountState
                                            .FinancialAccountStatus
                                            .OPEN
                                    )
                                    .substatus(
                                        Statement.AccountStanding.FinancialAccountState
                                            .FinancialAccountSubstatus
                                            .CHARGED_OFF_DELINQUENT
                                    )
                                    .build()
                            )
                            .hasGrace(true)
                            .periodNumber(0L)
                            .periodState(Statement.AccountStanding.PeriodState.STANDARD)
                            .build()
                    )
                    .amountDue(Statement.AmountDue.builder().amount(0L).pastDue(0L).build())
                    .availableCredit(0L)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .creditLimit(0L)
                    .creditProductToken("credit_product_token")
                    .daysInBillingCycle(0L)
                    .endingBalance(0L)
                    .financialAccountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .paymentDueDate(LocalDate.parse("2019-12-27"))
                    .periodTotals(
                        StatementTotals.builder()
                            .balanceTransfers(0L)
                            .cashAdvances(0L)
                            .credits(0L)
                            .debits(0L)
                            .fees(0L)
                            .interest(0L)
                            .payments(0L)
                            .purchases(0L)
                            .creditDetails(JsonValue.from(mapOf<String, Any>()))
                            .debitDetails(JsonValue.from(mapOf<String, Any>()))
                            .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                            .build()
                    )
                    .startingBalance(0L)
                    .statementEndDate(LocalDate.parse("2019-12-27"))
                    .statementStartDate(LocalDate.parse("2019-12-27"))
                    .statementType(Statement.StatementType.INITIAL)
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .ytdTotals(
                        StatementTotals.builder()
                            .balanceTransfers(0L)
                            .cashAdvances(0L)
                            .credits(0L)
                            .debits(0L)
                            .fees(0L)
                            .interest(0L)
                            .payments(0L)
                            .purchases(0L)
                            .creditDetails(JsonValue.from(mapOf<String, Any>()))
                            .debitDetails(JsonValue.from(mapOf<String, Any>()))
                            .paymentDetails(JsonValue.from(mapOf<String, Any>()))
                            .build()
                    )
                    .interestDetails(
                        Statement.InterestDetails.builder()
                            .actualInterestCharged(0L)
                            .dailyBalanceAmounts(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .effectiveApr(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .interestCalculationMethod(
                                Statement.InterestDetails.InterestCalculationMethod.DAILY
                            )
                            .interestForPeriod(
                                CategoryDetails.builder()
                                    .balanceTransfers("balance_transfers")
                                    .cashAdvances("cash_advances")
                                    .purchases("purchases")
                                    .build()
                            )
                            .primeRate("prime_rate")
                            .minimumInterestCharged(0L)
                            .build()
                    )
                    .nextPaymentDueDate(LocalDate.parse("2019-12-27"))
                    .nextStatementEndDate(LocalDate.parse("2019-12-27"))
                    .payoffDetails(
                        Statement.PayoffDetails.builder()
                            .minimumPaymentMonths("minimum_payment_months")
                            .minimumPaymentTotal("minimum_payment_total")
                            .payoffPeriodLengthMonths(0L)
                            .payoffPeriodMonthlyPaymentAmount(0L)
                            .payoffPeriodPaymentTotal(0L)
                            .build()
                    )
                    .eventType(StatementsCreatedWebhookEvent.EventType.STATEMENTS_CREATED)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofThreeDSAuthenticationCreated() {
        val threeDSAuthenticationCreated =
            ThreeDSAuthenticationCreatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .accountType(ThreeDSAuthentication.AccountType.CREDIT)
                .authenticationResult(ThreeDSAuthentication.AuthenticationResult.DECLINE)
                .cardExpiryCheck(ThreeDSAuthentication.CardExpiryCheck.MATCH)
                .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .cardholder(
                    ThreeDSAuthentication.Cardholder.builder()
                        .addressMatch(true)
                        .addressOnFileMatch(
                            ThreeDSAuthentication.Cardholder.AddressMatchResult.MATCH
                        )
                        .billingAddress(
                            ThreeDSAuthentication.Cardholder.BillingAddress.builder()
                                .address1("address1")
                                .address2("address2")
                                .address3("address3")
                                .city("city")
                                .country("xxx")
                                .postalCode("postal_code")
                                .build()
                        )
                        .email("x")
                        .name("x")
                        .phoneNumberHome("x")
                        .phoneNumberMobile("x")
                        .phoneNumberWork("x")
                        .shippingAddress(
                            ThreeDSAuthentication.Cardholder.ShippingAddress.builder()
                                .address1("address1")
                                .address2("address2")
                                .address3("address3")
                                .city("city")
                                .country("xxx")
                                .postalCode("postal_code")
                                .build()
                        )
                        .build()
                )
                .channel(ThreeDSAuthentication.Channel.APP_BASED)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .merchant(
                    ThreeDSAuthentication.Merchant.builder()
                        .riskIndicator(
                            ThreeDSAuthentication.Merchant.RiskIndicator.builder()
                                .deliveryEmailAddress("delivery_email_address")
                                .deliveryTimeFrame(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.DeliveryTimeFrame
                                        .ELECTRONIC_DELIVERY
                                )
                                .giftCardAmount(0L)
                                .giftCardCount(0L)
                                .giftCardCurrency("xxx")
                                .orderAvailability(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.OrderAvailability
                                        .FUTURE_AVAILABILITY
                                )
                                .preOrderAvailableDate(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .reorderItems(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.ReorderItems
                                        .FIRST_TIME_ORDERED
                                )
                                .shippingMethod(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.ShippingMethod
                                        .DIGITAL_GOODS
                                )
                                .build()
                        )
                        .id("id")
                        .country("xxx")
                        .mcc("xxxx")
                        .name("name")
                        .build()
                )
                .messageCategory(ThreeDSAuthentication.MessageCategory.NON_PAYMENT_AUTHENTICATION)
                .threeDSRequestorChallengeIndicator(
                    ThreeDSAuthentication.ThreeDSRequestorChallengeIndicator.NO_PREFERENCE
                )
                .additionalData(
                    ThreeDSAuthentication.AdditionalData.builder()
                        .networkDecision(
                            ThreeDSAuthentication.AdditionalData.NetworkDecision.LOW_RISK
                        )
                        .networkRiskScore(0L)
                        .build()
                )
                .app(
                    ThreeDSAuthentication.App.builder()
                        .device("device")
                        .deviceInfo("device_info")
                        .ip("ip")
                        .latitude(-90.0)
                        .locale("locale")
                        .longitude(-180.0)
                        .os("os")
                        .platform("platform")
                        .screenHeight(0L)
                        .screenWidth(0L)
                        .timeZone("time_zone")
                        .build()
                )
                .authenticationRequestType(ThreeDSAuthentication.AuthenticationRequestType.ADD_CARD)
                .browser(
                    ThreeDSAuthentication.Browser.builder()
                        .acceptHeader("accept_header")
                        .ip("ip")
                        .javaEnabled(true)
                        .javascriptEnabled(true)
                        .language("language")
                        .timeZone("time_zone")
                        .userAgent("user_agent")
                        .build()
                )
                .challengeMetadata(
                    ThreeDSAuthentication.ChallengeMetadata.builder()
                        .methodType(ThreeDSAuthentication.ChallengeMetadata.MethodType.SMS_OTP)
                        .status(ThreeDSAuthentication.ChallengeMetadata.Status.SUCCESS)
                        .phoneNumber("phone_number")
                        .build()
                )
                .challengeOrchestratedBy(ThreeDSAuthentication.ChallengeOrchestratedBy.LITHIC)
                .decisionMadeBy(ThreeDSAuthentication.DecisionMadeBy.LITHIC_RULES)
                .threeRiRequestType(ThreeDSAuthentication.ThreeRiRequestType.ACCOUNT_VERIFICATION)
                .transaction(
                    ThreeDSAuthentication.Transaction.builder()
                        .amount(0.0)
                        .cardholderAmount(0.0)
                        .currency("xxx")
                        .currencyExponent(0.0)
                        .dateTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .type(ThreeDSAuthentication.Transaction.Type.ACCOUNT_FUNDING)
                        .build()
                )
                .eventType(
                    ThreeDSAuthenticationCreatedWebhookEvent.EventType
                        .THREE_DS_AUTHENTICATION_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofThreeDSAuthenticationCreated(threeDSAuthenticationCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated())
            .contains(threeDSAuthenticationCreated)
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofThreeDSAuthenticationCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofThreeDSAuthenticationCreated(
                ThreeDSAuthenticationCreatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .accountType(ThreeDSAuthentication.AccountType.CREDIT)
                    .authenticationResult(ThreeDSAuthentication.AuthenticationResult.DECLINE)
                    .cardExpiryCheck(ThreeDSAuthentication.CardExpiryCheck.MATCH)
                    .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .cardholder(
                        ThreeDSAuthentication.Cardholder.builder()
                            .addressMatch(true)
                            .addressOnFileMatch(
                                ThreeDSAuthentication.Cardholder.AddressMatchResult.MATCH
                            )
                            .billingAddress(
                                ThreeDSAuthentication.Cardholder.BillingAddress.builder()
                                    .address1("address1")
                                    .address2("address2")
                                    .address3("address3")
                                    .city("city")
                                    .country("xxx")
                                    .postalCode("postal_code")
                                    .build()
                            )
                            .email("x")
                            .name("x")
                            .phoneNumberHome("x")
                            .phoneNumberMobile("x")
                            .phoneNumberWork("x")
                            .shippingAddress(
                                ThreeDSAuthentication.Cardholder.ShippingAddress.builder()
                                    .address1("address1")
                                    .address2("address2")
                                    .address3("address3")
                                    .city("city")
                                    .country("xxx")
                                    .postalCode("postal_code")
                                    .build()
                            )
                            .build()
                    )
                    .channel(ThreeDSAuthentication.Channel.APP_BASED)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .merchant(
                        ThreeDSAuthentication.Merchant.builder()
                            .riskIndicator(
                                ThreeDSAuthentication.Merchant.RiskIndicator.builder()
                                    .deliveryEmailAddress("delivery_email_address")
                                    .deliveryTimeFrame(
                                        ThreeDSAuthentication.Merchant.RiskIndicator
                                            .DeliveryTimeFrame
                                            .ELECTRONIC_DELIVERY
                                    )
                                    .giftCardAmount(0L)
                                    .giftCardCount(0L)
                                    .giftCardCurrency("xxx")
                                    .orderAvailability(
                                        ThreeDSAuthentication.Merchant.RiskIndicator
                                            .OrderAvailability
                                            .FUTURE_AVAILABILITY
                                    )
                                    .preOrderAvailableDate(
                                        OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                    )
                                    .reorderItems(
                                        ThreeDSAuthentication.Merchant.RiskIndicator.ReorderItems
                                            .FIRST_TIME_ORDERED
                                    )
                                    .shippingMethod(
                                        ThreeDSAuthentication.Merchant.RiskIndicator.ShippingMethod
                                            .DIGITAL_GOODS
                                    )
                                    .build()
                            )
                            .id("id")
                            .country("xxx")
                            .mcc("xxxx")
                            .name("name")
                            .build()
                    )
                    .messageCategory(
                        ThreeDSAuthentication.MessageCategory.NON_PAYMENT_AUTHENTICATION
                    )
                    .threeDSRequestorChallengeIndicator(
                        ThreeDSAuthentication.ThreeDSRequestorChallengeIndicator.NO_PREFERENCE
                    )
                    .additionalData(
                        ThreeDSAuthentication.AdditionalData.builder()
                            .networkDecision(
                                ThreeDSAuthentication.AdditionalData.NetworkDecision.LOW_RISK
                            )
                            .networkRiskScore(0L)
                            .build()
                    )
                    .app(
                        ThreeDSAuthentication.App.builder()
                            .device("device")
                            .deviceInfo("device_info")
                            .ip("ip")
                            .latitude(-90.0)
                            .locale("locale")
                            .longitude(-180.0)
                            .os("os")
                            .platform("platform")
                            .screenHeight(0L)
                            .screenWidth(0L)
                            .timeZone("time_zone")
                            .build()
                    )
                    .authenticationRequestType(
                        ThreeDSAuthentication.AuthenticationRequestType.ADD_CARD
                    )
                    .browser(
                        ThreeDSAuthentication.Browser.builder()
                            .acceptHeader("accept_header")
                            .ip("ip")
                            .javaEnabled(true)
                            .javascriptEnabled(true)
                            .language("language")
                            .timeZone("time_zone")
                            .userAgent("user_agent")
                            .build()
                    )
                    .challengeMetadata(
                        ThreeDSAuthentication.ChallengeMetadata.builder()
                            .methodType(ThreeDSAuthentication.ChallengeMetadata.MethodType.SMS_OTP)
                            .status(ThreeDSAuthentication.ChallengeMetadata.Status.SUCCESS)
                            .phoneNumber("phone_number")
                            .build()
                    )
                    .challengeOrchestratedBy(ThreeDSAuthentication.ChallengeOrchestratedBy.LITHIC)
                    .decisionMadeBy(ThreeDSAuthentication.DecisionMadeBy.LITHIC_RULES)
                    .threeRiRequestType(
                        ThreeDSAuthentication.ThreeRiRequestType.ACCOUNT_VERIFICATION
                    )
                    .transaction(
                        ThreeDSAuthentication.Transaction.builder()
                            .amount(0.0)
                            .cardholderAmount(0.0)
                            .currency("xxx")
                            .currencyExponent(0.0)
                            .dateTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .type(ThreeDSAuthentication.Transaction.Type.ACCOUNT_FUNDING)
                            .build()
                    )
                    .eventType(
                        ThreeDSAuthenticationCreatedWebhookEvent.EventType
                            .THREE_DS_AUTHENTICATION_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofThreeDSAuthenticationUpdated() {
        val threeDSAuthenticationUpdated =
            ThreeDSAuthenticationUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .accountType(ThreeDSAuthentication.AccountType.CREDIT)
                .authenticationResult(ThreeDSAuthentication.AuthenticationResult.DECLINE)
                .cardExpiryCheck(ThreeDSAuthentication.CardExpiryCheck.MATCH)
                .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .cardholder(
                    ThreeDSAuthentication.Cardholder.builder()
                        .addressMatch(true)
                        .addressOnFileMatch(
                            ThreeDSAuthentication.Cardholder.AddressMatchResult.MATCH
                        )
                        .billingAddress(
                            ThreeDSAuthentication.Cardholder.BillingAddress.builder()
                                .address1("address1")
                                .address2("address2")
                                .address3("address3")
                                .city("city")
                                .country("xxx")
                                .postalCode("postal_code")
                                .build()
                        )
                        .email("x")
                        .name("x")
                        .phoneNumberHome("x")
                        .phoneNumberMobile("x")
                        .phoneNumberWork("x")
                        .shippingAddress(
                            ThreeDSAuthentication.Cardholder.ShippingAddress.builder()
                                .address1("address1")
                                .address2("address2")
                                .address3("address3")
                                .city("city")
                                .country("xxx")
                                .postalCode("postal_code")
                                .build()
                        )
                        .build()
                )
                .channel(ThreeDSAuthentication.Channel.APP_BASED)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .merchant(
                    ThreeDSAuthentication.Merchant.builder()
                        .riskIndicator(
                            ThreeDSAuthentication.Merchant.RiskIndicator.builder()
                                .deliveryEmailAddress("delivery_email_address")
                                .deliveryTimeFrame(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.DeliveryTimeFrame
                                        .ELECTRONIC_DELIVERY
                                )
                                .giftCardAmount(0L)
                                .giftCardCount(0L)
                                .giftCardCurrency("xxx")
                                .orderAvailability(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.OrderAvailability
                                        .FUTURE_AVAILABILITY
                                )
                                .preOrderAvailableDate(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .reorderItems(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.ReorderItems
                                        .FIRST_TIME_ORDERED
                                )
                                .shippingMethod(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.ShippingMethod
                                        .DIGITAL_GOODS
                                )
                                .build()
                        )
                        .id("id")
                        .country("xxx")
                        .mcc("xxxx")
                        .name("name")
                        .build()
                )
                .messageCategory(ThreeDSAuthentication.MessageCategory.NON_PAYMENT_AUTHENTICATION)
                .threeDSRequestorChallengeIndicator(
                    ThreeDSAuthentication.ThreeDSRequestorChallengeIndicator.NO_PREFERENCE
                )
                .additionalData(
                    ThreeDSAuthentication.AdditionalData.builder()
                        .networkDecision(
                            ThreeDSAuthentication.AdditionalData.NetworkDecision.LOW_RISK
                        )
                        .networkRiskScore(0L)
                        .build()
                )
                .app(
                    ThreeDSAuthentication.App.builder()
                        .device("device")
                        .deviceInfo("device_info")
                        .ip("ip")
                        .latitude(-90.0)
                        .locale("locale")
                        .longitude(-180.0)
                        .os("os")
                        .platform("platform")
                        .screenHeight(0L)
                        .screenWidth(0L)
                        .timeZone("time_zone")
                        .build()
                )
                .authenticationRequestType(ThreeDSAuthentication.AuthenticationRequestType.ADD_CARD)
                .browser(
                    ThreeDSAuthentication.Browser.builder()
                        .acceptHeader("accept_header")
                        .ip("ip")
                        .javaEnabled(true)
                        .javascriptEnabled(true)
                        .language("language")
                        .timeZone("time_zone")
                        .userAgent("user_agent")
                        .build()
                )
                .challengeMetadata(
                    ThreeDSAuthentication.ChallengeMetadata.builder()
                        .methodType(ThreeDSAuthentication.ChallengeMetadata.MethodType.SMS_OTP)
                        .status(ThreeDSAuthentication.ChallengeMetadata.Status.SUCCESS)
                        .phoneNumber("phone_number")
                        .build()
                )
                .challengeOrchestratedBy(ThreeDSAuthentication.ChallengeOrchestratedBy.LITHIC)
                .decisionMadeBy(ThreeDSAuthentication.DecisionMadeBy.LITHIC_RULES)
                .threeRiRequestType(ThreeDSAuthentication.ThreeRiRequestType.ACCOUNT_VERIFICATION)
                .transaction(
                    ThreeDSAuthentication.Transaction.builder()
                        .amount(0.0)
                        .cardholderAmount(0.0)
                        .currency("xxx")
                        .currencyExponent(0.0)
                        .dateTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .type(ThreeDSAuthentication.Transaction.Type.ACCOUNT_FUNDING)
                        .build()
                )
                .eventType(
                    ThreeDSAuthenticationUpdatedWebhookEvent.EventType
                        .THREE_DS_AUTHENTICATION_UPDATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofThreeDSAuthenticationUpdated(threeDSAuthenticationUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated())
            .contains(threeDSAuthenticationUpdated)
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofThreeDSAuthenticationUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofThreeDSAuthenticationUpdated(
                ThreeDSAuthenticationUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .accountType(ThreeDSAuthentication.AccountType.CREDIT)
                    .authenticationResult(ThreeDSAuthentication.AuthenticationResult.DECLINE)
                    .cardExpiryCheck(ThreeDSAuthentication.CardExpiryCheck.MATCH)
                    .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .cardholder(
                        ThreeDSAuthentication.Cardholder.builder()
                            .addressMatch(true)
                            .addressOnFileMatch(
                                ThreeDSAuthentication.Cardholder.AddressMatchResult.MATCH
                            )
                            .billingAddress(
                                ThreeDSAuthentication.Cardholder.BillingAddress.builder()
                                    .address1("address1")
                                    .address2("address2")
                                    .address3("address3")
                                    .city("city")
                                    .country("xxx")
                                    .postalCode("postal_code")
                                    .build()
                            )
                            .email("x")
                            .name("x")
                            .phoneNumberHome("x")
                            .phoneNumberMobile("x")
                            .phoneNumberWork("x")
                            .shippingAddress(
                                ThreeDSAuthentication.Cardholder.ShippingAddress.builder()
                                    .address1("address1")
                                    .address2("address2")
                                    .address3("address3")
                                    .city("city")
                                    .country("xxx")
                                    .postalCode("postal_code")
                                    .build()
                            )
                            .build()
                    )
                    .channel(ThreeDSAuthentication.Channel.APP_BASED)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .merchant(
                        ThreeDSAuthentication.Merchant.builder()
                            .riskIndicator(
                                ThreeDSAuthentication.Merchant.RiskIndicator.builder()
                                    .deliveryEmailAddress("delivery_email_address")
                                    .deliveryTimeFrame(
                                        ThreeDSAuthentication.Merchant.RiskIndicator
                                            .DeliveryTimeFrame
                                            .ELECTRONIC_DELIVERY
                                    )
                                    .giftCardAmount(0L)
                                    .giftCardCount(0L)
                                    .giftCardCurrency("xxx")
                                    .orderAvailability(
                                        ThreeDSAuthentication.Merchant.RiskIndicator
                                            .OrderAvailability
                                            .FUTURE_AVAILABILITY
                                    )
                                    .preOrderAvailableDate(
                                        OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                    )
                                    .reorderItems(
                                        ThreeDSAuthentication.Merchant.RiskIndicator.ReorderItems
                                            .FIRST_TIME_ORDERED
                                    )
                                    .shippingMethod(
                                        ThreeDSAuthentication.Merchant.RiskIndicator.ShippingMethod
                                            .DIGITAL_GOODS
                                    )
                                    .build()
                            )
                            .id("id")
                            .country("xxx")
                            .mcc("xxxx")
                            .name("name")
                            .build()
                    )
                    .messageCategory(
                        ThreeDSAuthentication.MessageCategory.NON_PAYMENT_AUTHENTICATION
                    )
                    .threeDSRequestorChallengeIndicator(
                        ThreeDSAuthentication.ThreeDSRequestorChallengeIndicator.NO_PREFERENCE
                    )
                    .additionalData(
                        ThreeDSAuthentication.AdditionalData.builder()
                            .networkDecision(
                                ThreeDSAuthentication.AdditionalData.NetworkDecision.LOW_RISK
                            )
                            .networkRiskScore(0L)
                            .build()
                    )
                    .app(
                        ThreeDSAuthentication.App.builder()
                            .device("device")
                            .deviceInfo("device_info")
                            .ip("ip")
                            .latitude(-90.0)
                            .locale("locale")
                            .longitude(-180.0)
                            .os("os")
                            .platform("platform")
                            .screenHeight(0L)
                            .screenWidth(0L)
                            .timeZone("time_zone")
                            .build()
                    )
                    .authenticationRequestType(
                        ThreeDSAuthentication.AuthenticationRequestType.ADD_CARD
                    )
                    .browser(
                        ThreeDSAuthentication.Browser.builder()
                            .acceptHeader("accept_header")
                            .ip("ip")
                            .javaEnabled(true)
                            .javascriptEnabled(true)
                            .language("language")
                            .timeZone("time_zone")
                            .userAgent("user_agent")
                            .build()
                    )
                    .challengeMetadata(
                        ThreeDSAuthentication.ChallengeMetadata.builder()
                            .methodType(ThreeDSAuthentication.ChallengeMetadata.MethodType.SMS_OTP)
                            .status(ThreeDSAuthentication.ChallengeMetadata.Status.SUCCESS)
                            .phoneNumber("phone_number")
                            .build()
                    )
                    .challengeOrchestratedBy(ThreeDSAuthentication.ChallengeOrchestratedBy.LITHIC)
                    .decisionMadeBy(ThreeDSAuthentication.DecisionMadeBy.LITHIC_RULES)
                    .threeRiRequestType(
                        ThreeDSAuthentication.ThreeRiRequestType.ACCOUNT_VERIFICATION
                    )
                    .transaction(
                        ThreeDSAuthentication.Transaction.builder()
                            .amount(0.0)
                            .cardholderAmount(0.0)
                            .currency("xxx")
                            .currencyExponent(0.0)
                            .dateTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .type(ThreeDSAuthentication.Transaction.Type.ACCOUNT_FUNDING)
                            .build()
                    )
                    .eventType(
                        ThreeDSAuthenticationUpdatedWebhookEvent.EventType
                            .THREE_DS_AUTHENTICATION_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofThreeDSAuthenticationChallenge() {
        val threeDSAuthenticationChallenge =
            ThreeDSAuthenticationChallengeWebhookEvent.builder()
                .authenticationObject(
                    ThreeDSAuthentication.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .accountType(ThreeDSAuthentication.AccountType.CREDIT)
                        .authenticationResult(ThreeDSAuthentication.AuthenticationResult.DECLINE)
                        .cardExpiryCheck(ThreeDSAuthentication.CardExpiryCheck.MATCH)
                        .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .cardholder(
                            ThreeDSAuthentication.Cardholder.builder()
                                .addressMatch(true)
                                .addressOnFileMatch(
                                    ThreeDSAuthentication.Cardholder.AddressMatchResult.MATCH
                                )
                                .billingAddress(
                                    ThreeDSAuthentication.Cardholder.BillingAddress.builder()
                                        .address1("address1")
                                        .address2("address2")
                                        .address3("address3")
                                        .city("city")
                                        .country("xxx")
                                        .postalCode("postal_code")
                                        .build()
                                )
                                .email("x")
                                .name("x")
                                .phoneNumberHome("x")
                                .phoneNumberMobile("x")
                                .phoneNumberWork("x")
                                .shippingAddress(
                                    ThreeDSAuthentication.Cardholder.ShippingAddress.builder()
                                        .address1("address1")
                                        .address2("address2")
                                        .address3("address3")
                                        .city("city")
                                        .country("xxx")
                                        .postalCode("postal_code")
                                        .build()
                                )
                                .build()
                        )
                        .channel(ThreeDSAuthentication.Channel.APP_BASED)
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .merchant(
                            ThreeDSAuthentication.Merchant.builder()
                                .riskIndicator(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.builder()
                                        .deliveryEmailAddress("delivery_email_address")
                                        .deliveryTimeFrame(
                                            ThreeDSAuthentication.Merchant.RiskIndicator
                                                .DeliveryTimeFrame
                                                .ELECTRONIC_DELIVERY
                                        )
                                        .giftCardAmount(0L)
                                        .giftCardCount(0L)
                                        .giftCardCurrency("xxx")
                                        .orderAvailability(
                                            ThreeDSAuthentication.Merchant.RiskIndicator
                                                .OrderAvailability
                                                .FUTURE_AVAILABILITY
                                        )
                                        .preOrderAvailableDate(
                                            OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                        )
                                        .reorderItems(
                                            ThreeDSAuthentication.Merchant.RiskIndicator
                                                .ReorderItems
                                                .FIRST_TIME_ORDERED
                                        )
                                        .shippingMethod(
                                            ThreeDSAuthentication.Merchant.RiskIndicator
                                                .ShippingMethod
                                                .DIGITAL_GOODS
                                        )
                                        .build()
                                )
                                .id("id")
                                .country("xxx")
                                .mcc("xxxx")
                                .name("name")
                                .build()
                        )
                        .messageCategory(
                            ThreeDSAuthentication.MessageCategory.NON_PAYMENT_AUTHENTICATION
                        )
                        .threeDSRequestorChallengeIndicator(
                            ThreeDSAuthentication.ThreeDSRequestorChallengeIndicator.NO_PREFERENCE
                        )
                        .additionalData(
                            ThreeDSAuthentication.AdditionalData.builder()
                                .networkDecision(
                                    ThreeDSAuthentication.AdditionalData.NetworkDecision.LOW_RISK
                                )
                                .networkRiskScore(0L)
                                .build()
                        )
                        .app(
                            ThreeDSAuthentication.App.builder()
                                .device("device")
                                .deviceInfo("device_info")
                                .ip("ip")
                                .latitude(-90.0)
                                .locale("locale")
                                .longitude(-180.0)
                                .os("os")
                                .platform("platform")
                                .screenHeight(0L)
                                .screenWidth(0L)
                                .timeZone("time_zone")
                                .build()
                        )
                        .authenticationRequestType(
                            ThreeDSAuthentication.AuthenticationRequestType.ADD_CARD
                        )
                        .browser(
                            ThreeDSAuthentication.Browser.builder()
                                .acceptHeader("accept_header")
                                .ip("ip")
                                .javaEnabled(true)
                                .javascriptEnabled(true)
                                .language("language")
                                .timeZone("time_zone")
                                .userAgent("user_agent")
                                .build()
                        )
                        .challengeMetadata(
                            ThreeDSAuthentication.ChallengeMetadata.builder()
                                .methodType(
                                    ThreeDSAuthentication.ChallengeMetadata.MethodType.SMS_OTP
                                )
                                .status(ThreeDSAuthentication.ChallengeMetadata.Status.SUCCESS)
                                .phoneNumber("phone_number")
                                .build()
                        )
                        .challengeOrchestratedBy(
                            ThreeDSAuthentication.ChallengeOrchestratedBy.LITHIC
                        )
                        .decisionMadeBy(ThreeDSAuthentication.DecisionMadeBy.LITHIC_RULES)
                        .threeRiRequestType(
                            ThreeDSAuthentication.ThreeRiRequestType.ACCOUNT_VERIFICATION
                        )
                        .transaction(
                            ThreeDSAuthentication.Transaction.builder()
                                .amount(0.0)
                                .cardholderAmount(0.0)
                                .currency("xxx")
                                .currencyExponent(0.0)
                                .dateTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .type(ThreeDSAuthentication.Transaction.Type.ACCOUNT_FUNDING)
                                .build()
                        )
                        .build()
                )
                .challenge(
                    ThreeDSAuthenticationChallengeWebhookEvent.Challenge.builder()
                        .challengeMethodType(
                            ThreeDSAuthenticationChallengeWebhookEvent.Challenge.ChallengeMethodType
                                .OUT_OF_BAND
                        )
                        .expiryTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .appRequestorUrl("https://example.com")
                        .build()
                )
                .eventType(
                    ThreeDSAuthenticationChallengeWebhookEvent.EventType
                        .THREE_DS_AUTHENTICATION_CHALLENGE
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofThreeDSAuthenticationChallenge(threeDSAuthenticationChallenge)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge())
            .contains(threeDSAuthenticationChallenge)
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofThreeDSAuthenticationChallengeRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofThreeDSAuthenticationChallenge(
                ThreeDSAuthenticationChallengeWebhookEvent.builder()
                    .authenticationObject(
                        ThreeDSAuthentication.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .accountType(ThreeDSAuthentication.AccountType.CREDIT)
                            .authenticationResult(
                                ThreeDSAuthentication.AuthenticationResult.DECLINE
                            )
                            .cardExpiryCheck(ThreeDSAuthentication.CardExpiryCheck.MATCH)
                            .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .cardholder(
                                ThreeDSAuthentication.Cardholder.builder()
                                    .addressMatch(true)
                                    .addressOnFileMatch(
                                        ThreeDSAuthentication.Cardholder.AddressMatchResult.MATCH
                                    )
                                    .billingAddress(
                                        ThreeDSAuthentication.Cardholder.BillingAddress.builder()
                                            .address1("address1")
                                            .address2("address2")
                                            .address3("address3")
                                            .city("city")
                                            .country("xxx")
                                            .postalCode("postal_code")
                                            .build()
                                    )
                                    .email("x")
                                    .name("x")
                                    .phoneNumberHome("x")
                                    .phoneNumberMobile("x")
                                    .phoneNumberWork("x")
                                    .shippingAddress(
                                        ThreeDSAuthentication.Cardholder.ShippingAddress.builder()
                                            .address1("address1")
                                            .address2("address2")
                                            .address3("address3")
                                            .city("city")
                                            .country("xxx")
                                            .postalCode("postal_code")
                                            .build()
                                    )
                                    .build()
                            )
                            .channel(ThreeDSAuthentication.Channel.APP_BASED)
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .merchant(
                                ThreeDSAuthentication.Merchant.builder()
                                    .riskIndicator(
                                        ThreeDSAuthentication.Merchant.RiskIndicator.builder()
                                            .deliveryEmailAddress("delivery_email_address")
                                            .deliveryTimeFrame(
                                                ThreeDSAuthentication.Merchant.RiskIndicator
                                                    .DeliveryTimeFrame
                                                    .ELECTRONIC_DELIVERY
                                            )
                                            .giftCardAmount(0L)
                                            .giftCardCount(0L)
                                            .giftCardCurrency("xxx")
                                            .orderAvailability(
                                                ThreeDSAuthentication.Merchant.RiskIndicator
                                                    .OrderAvailability
                                                    .FUTURE_AVAILABILITY
                                            )
                                            .preOrderAvailableDate(
                                                OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                            )
                                            .reorderItems(
                                                ThreeDSAuthentication.Merchant.RiskIndicator
                                                    .ReorderItems
                                                    .FIRST_TIME_ORDERED
                                            )
                                            .shippingMethod(
                                                ThreeDSAuthentication.Merchant.RiskIndicator
                                                    .ShippingMethod
                                                    .DIGITAL_GOODS
                                            )
                                            .build()
                                    )
                                    .id("id")
                                    .country("xxx")
                                    .mcc("xxxx")
                                    .name("name")
                                    .build()
                            )
                            .messageCategory(
                                ThreeDSAuthentication.MessageCategory.NON_PAYMENT_AUTHENTICATION
                            )
                            .threeDSRequestorChallengeIndicator(
                                ThreeDSAuthentication.ThreeDSRequestorChallengeIndicator
                                    .NO_PREFERENCE
                            )
                            .additionalData(
                                ThreeDSAuthentication.AdditionalData.builder()
                                    .networkDecision(
                                        ThreeDSAuthentication.AdditionalData.NetworkDecision
                                            .LOW_RISK
                                    )
                                    .networkRiskScore(0L)
                                    .build()
                            )
                            .app(
                                ThreeDSAuthentication.App.builder()
                                    .device("device")
                                    .deviceInfo("device_info")
                                    .ip("ip")
                                    .latitude(-90.0)
                                    .locale("locale")
                                    .longitude(-180.0)
                                    .os("os")
                                    .platform("platform")
                                    .screenHeight(0L)
                                    .screenWidth(0L)
                                    .timeZone("time_zone")
                                    .build()
                            )
                            .authenticationRequestType(
                                ThreeDSAuthentication.AuthenticationRequestType.ADD_CARD
                            )
                            .browser(
                                ThreeDSAuthentication.Browser.builder()
                                    .acceptHeader("accept_header")
                                    .ip("ip")
                                    .javaEnabled(true)
                                    .javascriptEnabled(true)
                                    .language("language")
                                    .timeZone("time_zone")
                                    .userAgent("user_agent")
                                    .build()
                            )
                            .challengeMetadata(
                                ThreeDSAuthentication.ChallengeMetadata.builder()
                                    .methodType(
                                        ThreeDSAuthentication.ChallengeMetadata.MethodType.SMS_OTP
                                    )
                                    .status(ThreeDSAuthentication.ChallengeMetadata.Status.SUCCESS)
                                    .phoneNumber("phone_number")
                                    .build()
                            )
                            .challengeOrchestratedBy(
                                ThreeDSAuthentication.ChallengeOrchestratedBy.LITHIC
                            )
                            .decisionMadeBy(ThreeDSAuthentication.DecisionMadeBy.LITHIC_RULES)
                            .threeRiRequestType(
                                ThreeDSAuthentication.ThreeRiRequestType.ACCOUNT_VERIFICATION
                            )
                            .transaction(
                                ThreeDSAuthentication.Transaction.builder()
                                    .amount(0.0)
                                    .cardholderAmount(0.0)
                                    .currency("xxx")
                                    .currencyExponent(0.0)
                                    .dateTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                    .type(ThreeDSAuthentication.Transaction.Type.ACCOUNT_FUNDING)
                                    .build()
                            )
                            .build()
                    )
                    .challenge(
                        ThreeDSAuthenticationChallengeWebhookEvent.Challenge.builder()
                            .challengeMethodType(
                                ThreeDSAuthenticationChallengeWebhookEvent.Challenge
                                    .ChallengeMethodType
                                    .OUT_OF_BAND
                            )
                            .expiryTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .startTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .appRequestorUrl("https://example.com")
                            .build()
                    )
                    .eventType(
                        ThreeDSAuthenticationChallengeWebhookEvent.EventType
                            .THREE_DS_AUTHENTICATION_CHALLENGE
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofTokenizationApprovalRequest() {
        val tokenizationApprovalRequest =
            TokenizationApprovalRequestWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .customerTokenizationDecision(
                    TokenizationApprovalRequestWebhookEvent.CustomerTokenizationDecision.builder()
                        .outcome(
                            TokenizationApprovalRequestWebhookEvent.CustomerTokenizationDecision
                                .Outcome
                                .APPROVED
                        )
                        .responderUrl("https://example.com")
                        .latency("100")
                        .responseCode("123456")
                        .build()
                )
                .eventType(
                    TokenizationApprovalRequestWebhookEvent.EventType.TOKENIZATION_APPROVAL_REQUEST
                )
                .issuerDecision(TokenizationApprovalRequestWebhookEvent.IssuerDecision.APPROVED)
                .tokenizationChannel(
                    TokenizationApprovalRequestWebhookEvent.TokenizationChannel.DIGITAL_WALLET
                )
                .tokenizationToken("tokenization_token")
                .walletDecisioningInfo(
                    WalletDecisioningInfo.builder()
                        .accountScore("100")
                        .deviceScore("100")
                        .recommendedDecision("Decision1")
                        .addRecommendationReason("string")
                        .build()
                )
                .device(
                    Device.builder()
                        .imei("123456789012345")
                        .ipAddress("1.1.1.1")
                        .location("37.3860517/-122.0838511")
                        .build()
                )
                .digitalWalletTokenMetadata(
                    DigitalWalletTokenMetadata.builder()
                        .paymentAccountInfo(
                            DigitalWalletTokenMetadata.PaymentAccountInfo.builder()
                                .accountHolderData(
                                    DigitalWalletTokenMetadata.PaymentAccountInfo.AccountHolderData
                                        .builder()
                                        .phoneNumber("phone_number")
                                        .build()
                                )
                                .panUniqueReference("pan_unique_reference")
                                .paymentAccountReference("payment_account_reference")
                                .tokenUniqueReference("token_unique_reference")
                                .build()
                        )
                        .status("status")
                        .paymentAppInstanceId("payment_app_instance_id")
                        .tokenRequestorId("xxxxxxxxxxx")
                        .tokenRequestorName(DigitalWalletTokenMetadata.TokenRequestorName.APPLE_PAY)
                        .build()
                )
                .addRuleResult(
                    TokenizationRuleResult.builder()
                        .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .explanation("explanation")
                        .name("name")
                        .result(TokenizationRuleResult.Result.APPROVED)
                        .build()
                )
                .addTokenizationDeclineReason(TokenizationDeclineReason.ACCOUNT_SCORE_1)
                .tokenizationSource(
                    TokenizationApprovalRequestWebhookEvent.TokenizationSource.PUSH_PROVISION
                )
                .addTokenizationTfaReason(TokenizationTfaReason.WALLET_RECOMMENDED_TFA)
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationApprovalRequest(tokenizationApprovalRequest)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest())
            .contains(tokenizationApprovalRequest)
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofTokenizationApprovalRequestRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationApprovalRequest(
                TokenizationApprovalRequestWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .customerTokenizationDecision(
                        TokenizationApprovalRequestWebhookEvent.CustomerTokenizationDecision
                            .builder()
                            .outcome(
                                TokenizationApprovalRequestWebhookEvent.CustomerTokenizationDecision
                                    .Outcome
                                    .APPROVED
                            )
                            .responderUrl("https://example.com")
                            .latency("100")
                            .responseCode("123456")
                            .build()
                    )
                    .eventType(
                        TokenizationApprovalRequestWebhookEvent.EventType
                            .TOKENIZATION_APPROVAL_REQUEST
                    )
                    .issuerDecision(TokenizationApprovalRequestWebhookEvent.IssuerDecision.APPROVED)
                    .tokenizationChannel(
                        TokenizationApprovalRequestWebhookEvent.TokenizationChannel.DIGITAL_WALLET
                    )
                    .tokenizationToken("tokenization_token")
                    .walletDecisioningInfo(
                        WalletDecisioningInfo.builder()
                            .accountScore("100")
                            .deviceScore("100")
                            .recommendedDecision("Decision1")
                            .addRecommendationReason("string")
                            .build()
                    )
                    .device(
                        Device.builder()
                            .imei("123456789012345")
                            .ipAddress("1.1.1.1")
                            .location("37.3860517/-122.0838511")
                            .build()
                    )
                    .digitalWalletTokenMetadata(
                        DigitalWalletTokenMetadata.builder()
                            .paymentAccountInfo(
                                DigitalWalletTokenMetadata.PaymentAccountInfo.builder()
                                    .accountHolderData(
                                        DigitalWalletTokenMetadata.PaymentAccountInfo
                                            .AccountHolderData
                                            .builder()
                                            .phoneNumber("phone_number")
                                            .build()
                                    )
                                    .panUniqueReference("pan_unique_reference")
                                    .paymentAccountReference("payment_account_reference")
                                    .tokenUniqueReference("token_unique_reference")
                                    .build()
                            )
                            .status("status")
                            .paymentAppInstanceId("payment_app_instance_id")
                            .tokenRequestorId("xxxxxxxxxxx")
                            .tokenRequestorName(
                                DigitalWalletTokenMetadata.TokenRequestorName.APPLE_PAY
                            )
                            .build()
                    )
                    .addRuleResult(
                        TokenizationRuleResult.builder()
                            .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .explanation("explanation")
                            .name("name")
                            .result(TokenizationRuleResult.Result.APPROVED)
                            .build()
                    )
                    .addTokenizationDeclineReason(TokenizationDeclineReason.ACCOUNT_SCORE_1)
                    .tokenizationSource(
                        TokenizationApprovalRequestWebhookEvent.TokenizationSource.PUSH_PROVISION
                    )
                    .addTokenizationTfaReason(TokenizationTfaReason.WALLET_RECOMMENDED_TFA)
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofTokenizationResult() {
        val tokenizationResult =
            TokenizationResultWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                .eventType(TokenizationResultWebhookEvent.EventType.TOKENIZATION_RESULT)
                .tokenizationResultDetails(
                    TokenizationResultWebhookEvent.TokenizationResultDetails.builder()
                        .issuerDecision("issuer_decision")
                        .addTokenizationDeclineReason(
                            TokenizationResultWebhookEvent.TokenizationResultDetails
                                .TokenizationDeclineReason
                                .ACCOUNT_SCORE_1
                        )
                        .addTokenizationDeclineReason(
                            TokenizationResultWebhookEvent.TokenizationResultDetails
                                .TokenizationDeclineReason
                                .DEVICE_SCORE_1
                        )
                        .customerDecision("customer_decision")
                        .addRuleResult(
                            TokenizationRuleResult.builder()
                                .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .explanation("explanation")
                                .name("name")
                                .result(TokenizationRuleResult.Result.APPROVED)
                                .build()
                        )
                        .tokenActivatedDateTime(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                        .addTokenizationTfaReason(TokenizationTfaReason.WALLET_RECOMMENDED_TFA)
                        .walletDecision("APPROVED")
                        .build()
                )
                .tokenizationToken("00000000-0000-0000-0000-000000000003")
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofTokenizationResult(tokenizationResult)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).contains(tokenizationResult)
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofTokenizationResultRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationResult(
                TokenizationResultWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                    .eventType(TokenizationResultWebhookEvent.EventType.TOKENIZATION_RESULT)
                    .tokenizationResultDetails(
                        TokenizationResultWebhookEvent.TokenizationResultDetails.builder()
                            .issuerDecision("issuer_decision")
                            .addTokenizationDeclineReason(
                                TokenizationResultWebhookEvent.TokenizationResultDetails
                                    .TokenizationDeclineReason
                                    .ACCOUNT_SCORE_1
                            )
                            .addTokenizationDeclineReason(
                                TokenizationResultWebhookEvent.TokenizationResultDetails
                                    .TokenizationDeclineReason
                                    .DEVICE_SCORE_1
                            )
                            .customerDecision("customer_decision")
                            .addRuleResult(
                                TokenizationRuleResult.builder()
                                    .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .explanation("explanation")
                                    .name("name")
                                    .result(TokenizationRuleResult.Result.APPROVED)
                                    .build()
                            )
                            .tokenActivatedDateTime(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                            .addTokenizationTfaReason(TokenizationTfaReason.WALLET_RECOMMENDED_TFA)
                            .walletDecision("APPROVED")
                            .build()
                    )
                    .tokenizationToken("00000000-0000-0000-0000-000000000003")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofTokenizationTwoFactorAuthenticationCode() {
        val tokenizationTwoFactorAuthenticationCode =
            TokenizationTwoFactorAuthenticationCodeWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .activationMethod(
                    TokenizationTwoFactorAuthenticationCodeWebhookEvent.ActivationMethod.builder()
                        .type(
                            TokenizationTwoFactorAuthenticationCodeWebhookEvent.ActivationMethod
                                .Type
                                .TEXT_TO_CARDHOLDER_NUMBER
                        )
                        .value("+15555555555")
                        .build()
                )
                .authenticationCode("123456")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                .eventType(
                    TokenizationTwoFactorAuthenticationCodeWebhookEvent.EventType
                        .TOKENIZATION_TWO_FACTOR_AUTHENTICATION_CODE
                )
                .tokenizationToken("00000000-0000-0000-0000-000000000003")
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationTwoFactorAuthenticationCode(
                tokenizationTwoFactorAuthenticationCode
            )

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode())
            .contains(tokenizationTwoFactorAuthenticationCode)
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofTokenizationTwoFactorAuthenticationCodeRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationTwoFactorAuthenticationCode(
                TokenizationTwoFactorAuthenticationCodeWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .activationMethod(
                        TokenizationTwoFactorAuthenticationCodeWebhookEvent.ActivationMethod
                            .builder()
                            .type(
                                TokenizationTwoFactorAuthenticationCodeWebhookEvent.ActivationMethod
                                    .Type
                                    .TEXT_TO_CARDHOLDER_NUMBER
                            )
                            .value("+15555555555")
                            .build()
                    )
                    .authenticationCode("123456")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                    .eventType(
                        TokenizationTwoFactorAuthenticationCodeWebhookEvent.EventType
                            .TOKENIZATION_TWO_FACTOR_AUTHENTICATION_CODE
                    )
                    .tokenizationToken("00000000-0000-0000-0000-000000000003")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofTokenizationTwoFactorAuthenticationCodeSent() {
        val tokenizationTwoFactorAuthenticationCodeSent =
            TokenizationTwoFactorAuthenticationCodeSentWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .activationMethod(
                    TokenizationTwoFactorAuthenticationCodeSentWebhookEvent.ActivationMethod
                        .builder()
                        .type(
                            TokenizationTwoFactorAuthenticationCodeSentWebhookEvent.ActivationMethod
                                .Type
                                .TEXT_TO_CARDHOLDER_NUMBER
                        )
                        .value("+15555555555")
                        .build()
                )
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                .eventType(
                    TokenizationTwoFactorAuthenticationCodeSentWebhookEvent.EventType
                        .TOKENIZATION_TWO_FACTOR_AUTHENTICATION_CODE_SENT
                )
                .tokenizationToken("00000000-0000-0000-0000-000000000003")
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationTwoFactorAuthenticationCodeSent(
                tokenizationTwoFactorAuthenticationCodeSent
            )

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent())
            .contains(tokenizationTwoFactorAuthenticationCodeSent)
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofTokenizationTwoFactorAuthenticationCodeSentRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationTwoFactorAuthenticationCodeSent(
                TokenizationTwoFactorAuthenticationCodeSentWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .activationMethod(
                        TokenizationTwoFactorAuthenticationCodeSentWebhookEvent.ActivationMethod
                            .builder()
                            .type(
                                TokenizationTwoFactorAuthenticationCodeSentWebhookEvent
                                    .ActivationMethod
                                    .Type
                                    .TEXT_TO_CARDHOLDER_NUMBER
                            )
                            .value("+15555555555")
                            .build()
                    )
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                    .eventType(
                        TokenizationTwoFactorAuthenticationCodeSentWebhookEvent.EventType
                            .TOKENIZATION_TWO_FACTOR_AUTHENTICATION_CODE_SENT
                    )
                    .tokenizationToken("00000000-0000-0000-0000-000000000003")
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofTokenizationUpdated() {
        val tokenizationUpdated =
            TokenizationUpdatedWebhookEvent.builder()
                .accountToken("00000000-0000-0000-0000-000000000002")
                .cardToken("00000000-0000-0000-0000-000000000001")
                .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                .eventType(TokenizationUpdatedWebhookEvent.EventType.TOKENIZATION_UPDATED)
                .tokenization(
                    Tokenization.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .dpan("dpan")
                        .status(Tokenization.Status.ACTIVE)
                        .tokenRequestorName(Tokenization.TokenRequestorName.AMAZON_ONE)
                        .tokenUniqueReference("token_unique_reference")
                        .tokenizationChannel(Tokenization.TokenizationChannel.DIGITAL_WALLET)
                        .updatedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .deviceId("device_id")
                        .digitalCardArtToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .addEvent(
                            Tokenization.TokenizationEvent.builder()
                                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                .result(
                                    Tokenization.TokenizationEvent.TokenizationEventOutcome.APPROVED
                                )
                                .addRuleResult(
                                    TokenizationRuleResult.builder()
                                        .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                        .explanation("explanation")
                                        .name("name")
                                        .result(TokenizationRuleResult.Result.APPROVED)
                                        .build()
                                )
                                .addTokenizationDeclineReason(
                                    TokenizationDeclineReason.ACCOUNT_SCORE_1
                                )
                                .addTokenizationTfaReason(
                                    TokenizationTfaReason.WALLET_RECOMMENDED_TFA
                                )
                                .type(Tokenization.TokenizationEvent.Type.TOKENIZATION_2_FA)
                                .build()
                        )
                        .paymentAccountReferenceId("payment_account_reference_id")
                        .build()
                )
                .build()

        val parsedWebhookEvent = ParsedWebhookEvent.ofTokenizationUpdated(tokenizationUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).contains(tokenizationUpdated)
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofTokenizationUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofTokenizationUpdated(
                TokenizationUpdatedWebhookEvent.builder()
                    .accountToken("00000000-0000-0000-0000-000000000002")
                    .cardToken("00000000-0000-0000-0000-000000000001")
                    .created(OffsetDateTime.parse("2020-01-01T00:00:00Z"))
                    .eventType(TokenizationUpdatedWebhookEvent.EventType.TOKENIZATION_UPDATED)
                    .tokenization(
                        Tokenization.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .dpan("dpan")
                            .status(Tokenization.Status.ACTIVE)
                            .tokenRequestorName(Tokenization.TokenRequestorName.AMAZON_ONE)
                            .tokenUniqueReference("token_unique_reference")
                            .tokenizationChannel(Tokenization.TokenizationChannel.DIGITAL_WALLET)
                            .updatedAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .deviceId("device_id")
                            .digitalCardArtToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .addEvent(
                                Tokenization.TokenizationEvent.builder()
                                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                    .createdAt(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                                    .result(
                                        Tokenization.TokenizationEvent.TokenizationEventOutcome
                                            .APPROVED
                                    )
                                    .addRuleResult(
                                        TokenizationRuleResult.builder()
                                            .authRuleToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                                            .explanation("explanation")
                                            .name("name")
                                            .result(TokenizationRuleResult.Result.APPROVED)
                                            .build()
                                    )
                                    .addTokenizationDeclineReason(
                                        TokenizationDeclineReason.ACCOUNT_SCORE_1
                                    )
                                    .addTokenizationTfaReason(
                                        TokenizationTfaReason.WALLET_RECOMMENDED_TFA
                                    )
                                    .type(Tokenization.TokenizationEvent.Type.TOKENIZATION_2_FA)
                                    .build()
                            )
                            .paymentAccountReferenceId("payment_account_reference_id")
                            .build()
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofThreeDSAuthenticationApprovalRequest() {
        val threeDSAuthenticationApprovalRequest =
            ThreeDSAuthenticationApprovalRequestWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .accountType(ThreeDSAuthentication.AccountType.CREDIT)
                .authenticationResult(ThreeDSAuthentication.AuthenticationResult.DECLINE)
                .cardExpiryCheck(ThreeDSAuthentication.CardExpiryCheck.MATCH)
                .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .cardholder(
                    ThreeDSAuthentication.Cardholder.builder()
                        .addressMatch(true)
                        .addressOnFileMatch(
                            ThreeDSAuthentication.Cardholder.AddressMatchResult.MATCH
                        )
                        .billingAddress(
                            ThreeDSAuthentication.Cardholder.BillingAddress.builder()
                                .address1("address1")
                                .address2("address2")
                                .address3("address3")
                                .city("city")
                                .country("xxx")
                                .postalCode("postal_code")
                                .build()
                        )
                        .email("x")
                        .name("x")
                        .phoneNumberHome("x")
                        .phoneNumberMobile("x")
                        .phoneNumberWork("x")
                        .shippingAddress(
                            ThreeDSAuthentication.Cardholder.ShippingAddress.builder()
                                .address1("address1")
                                .address2("address2")
                                .address3("address3")
                                .city("city")
                                .country("xxx")
                                .postalCode("postal_code")
                                .build()
                        )
                        .build()
                )
                .channel(ThreeDSAuthentication.Channel.APP_BASED)
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .merchant(
                    ThreeDSAuthentication.Merchant.builder()
                        .riskIndicator(
                            ThreeDSAuthentication.Merchant.RiskIndicator.builder()
                                .deliveryEmailAddress("delivery_email_address")
                                .deliveryTimeFrame(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.DeliveryTimeFrame
                                        .ELECTRONIC_DELIVERY
                                )
                                .giftCardAmount(0L)
                                .giftCardCount(0L)
                                .giftCardCurrency("xxx")
                                .orderAvailability(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.OrderAvailability
                                        .FUTURE_AVAILABILITY
                                )
                                .preOrderAvailableDate(
                                    OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                )
                                .reorderItems(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.ReorderItems
                                        .FIRST_TIME_ORDERED
                                )
                                .shippingMethod(
                                    ThreeDSAuthentication.Merchant.RiskIndicator.ShippingMethod
                                        .DIGITAL_GOODS
                                )
                                .build()
                        )
                        .id("id")
                        .country("xxx")
                        .mcc("xxxx")
                        .name("name")
                        .build()
                )
                .messageCategory(ThreeDSAuthentication.MessageCategory.NON_PAYMENT_AUTHENTICATION)
                .threeDSRequestorChallengeIndicator(
                    ThreeDSAuthentication.ThreeDSRequestorChallengeIndicator.NO_PREFERENCE
                )
                .additionalData(
                    ThreeDSAuthentication.AdditionalData.builder()
                        .networkDecision(
                            ThreeDSAuthentication.AdditionalData.NetworkDecision.LOW_RISK
                        )
                        .networkRiskScore(0L)
                        .build()
                )
                .app(
                    ThreeDSAuthentication.App.builder()
                        .device("device")
                        .deviceInfo("device_info")
                        .ip("ip")
                        .latitude(-90.0)
                        .locale("locale")
                        .longitude(-180.0)
                        .os("os")
                        .platform("platform")
                        .screenHeight(0L)
                        .screenWidth(0L)
                        .timeZone("time_zone")
                        .build()
                )
                .authenticationRequestType(ThreeDSAuthentication.AuthenticationRequestType.ADD_CARD)
                .browser(
                    ThreeDSAuthentication.Browser.builder()
                        .acceptHeader("accept_header")
                        .ip("ip")
                        .javaEnabled(true)
                        .javascriptEnabled(true)
                        .language("language")
                        .timeZone("time_zone")
                        .userAgent("user_agent")
                        .build()
                )
                .challengeMetadata(
                    ThreeDSAuthentication.ChallengeMetadata.builder()
                        .methodType(ThreeDSAuthentication.ChallengeMetadata.MethodType.SMS_OTP)
                        .status(ThreeDSAuthentication.ChallengeMetadata.Status.SUCCESS)
                        .phoneNumber("phone_number")
                        .build()
                )
                .challengeOrchestratedBy(ThreeDSAuthentication.ChallengeOrchestratedBy.LITHIC)
                .decisionMadeBy(ThreeDSAuthentication.DecisionMadeBy.LITHIC_RULES)
                .threeRiRequestType(ThreeDSAuthentication.ThreeRiRequestType.ACCOUNT_VERIFICATION)
                .transaction(
                    ThreeDSAuthentication.Transaction.builder()
                        .amount(0.0)
                        .cardholderAmount(0.0)
                        .currency("xxx")
                        .currencyExponent(0.0)
                        .dateTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .type(ThreeDSAuthentication.Transaction.Type.ACCOUNT_FUNDING)
                        .build()
                )
                .eventType(
                    ThreeDSAuthenticationApprovalRequestWebhookEvent.EventType
                        .THREE_DS_AUTHENTICATION_APPROVAL_REQUEST
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofThreeDSAuthenticationApprovalRequest(
                threeDSAuthenticationApprovalRequest
            )

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest())
            .contains(threeDSAuthenticationApprovalRequest)
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofThreeDSAuthenticationApprovalRequestRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofThreeDSAuthenticationApprovalRequest(
                ThreeDSAuthenticationApprovalRequestWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .accountType(ThreeDSAuthentication.AccountType.CREDIT)
                    .authenticationResult(ThreeDSAuthentication.AuthenticationResult.DECLINE)
                    .cardExpiryCheck(ThreeDSAuthentication.CardExpiryCheck.MATCH)
                    .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .cardholder(
                        ThreeDSAuthentication.Cardholder.builder()
                            .addressMatch(true)
                            .addressOnFileMatch(
                                ThreeDSAuthentication.Cardholder.AddressMatchResult.MATCH
                            )
                            .billingAddress(
                                ThreeDSAuthentication.Cardholder.BillingAddress.builder()
                                    .address1("address1")
                                    .address2("address2")
                                    .address3("address3")
                                    .city("city")
                                    .country("xxx")
                                    .postalCode("postal_code")
                                    .build()
                            )
                            .email("x")
                            .name("x")
                            .phoneNumberHome("x")
                            .phoneNumberMobile("x")
                            .phoneNumberWork("x")
                            .shippingAddress(
                                ThreeDSAuthentication.Cardholder.ShippingAddress.builder()
                                    .address1("address1")
                                    .address2("address2")
                                    .address3("address3")
                                    .city("city")
                                    .country("xxx")
                                    .postalCode("postal_code")
                                    .build()
                            )
                            .build()
                    )
                    .channel(ThreeDSAuthentication.Channel.APP_BASED)
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .merchant(
                        ThreeDSAuthentication.Merchant.builder()
                            .riskIndicator(
                                ThreeDSAuthentication.Merchant.RiskIndicator.builder()
                                    .deliveryEmailAddress("delivery_email_address")
                                    .deliveryTimeFrame(
                                        ThreeDSAuthentication.Merchant.RiskIndicator
                                            .DeliveryTimeFrame
                                            .ELECTRONIC_DELIVERY
                                    )
                                    .giftCardAmount(0L)
                                    .giftCardCount(0L)
                                    .giftCardCurrency("xxx")
                                    .orderAvailability(
                                        ThreeDSAuthentication.Merchant.RiskIndicator
                                            .OrderAvailability
                                            .FUTURE_AVAILABILITY
                                    )
                                    .preOrderAvailableDate(
                                        OffsetDateTime.parse("2019-12-27T18:11:19.117Z")
                                    )
                                    .reorderItems(
                                        ThreeDSAuthentication.Merchant.RiskIndicator.ReorderItems
                                            .FIRST_TIME_ORDERED
                                    )
                                    .shippingMethod(
                                        ThreeDSAuthentication.Merchant.RiskIndicator.ShippingMethod
                                            .DIGITAL_GOODS
                                    )
                                    .build()
                            )
                            .id("id")
                            .country("xxx")
                            .mcc("xxxx")
                            .name("name")
                            .build()
                    )
                    .messageCategory(
                        ThreeDSAuthentication.MessageCategory.NON_PAYMENT_AUTHENTICATION
                    )
                    .threeDSRequestorChallengeIndicator(
                        ThreeDSAuthentication.ThreeDSRequestorChallengeIndicator.NO_PREFERENCE
                    )
                    .additionalData(
                        ThreeDSAuthentication.AdditionalData.builder()
                            .networkDecision(
                                ThreeDSAuthentication.AdditionalData.NetworkDecision.LOW_RISK
                            )
                            .networkRiskScore(0L)
                            .build()
                    )
                    .app(
                        ThreeDSAuthentication.App.builder()
                            .device("device")
                            .deviceInfo("device_info")
                            .ip("ip")
                            .latitude(-90.0)
                            .locale("locale")
                            .longitude(-180.0)
                            .os("os")
                            .platform("platform")
                            .screenHeight(0L)
                            .screenWidth(0L)
                            .timeZone("time_zone")
                            .build()
                    )
                    .authenticationRequestType(
                        ThreeDSAuthentication.AuthenticationRequestType.ADD_CARD
                    )
                    .browser(
                        ThreeDSAuthentication.Browser.builder()
                            .acceptHeader("accept_header")
                            .ip("ip")
                            .javaEnabled(true)
                            .javascriptEnabled(true)
                            .language("language")
                            .timeZone("time_zone")
                            .userAgent("user_agent")
                            .build()
                    )
                    .challengeMetadata(
                        ThreeDSAuthentication.ChallengeMetadata.builder()
                            .methodType(ThreeDSAuthentication.ChallengeMetadata.MethodType.SMS_OTP)
                            .status(ThreeDSAuthentication.ChallengeMetadata.Status.SUCCESS)
                            .phoneNumber("phone_number")
                            .build()
                    )
                    .challengeOrchestratedBy(ThreeDSAuthentication.ChallengeOrchestratedBy.LITHIC)
                    .decisionMadeBy(ThreeDSAuthentication.DecisionMadeBy.LITHIC_RULES)
                    .threeRiRequestType(
                        ThreeDSAuthentication.ThreeRiRequestType.ACCOUNT_VERIFICATION
                    )
                    .transaction(
                        ThreeDSAuthentication.Transaction.builder()
                            .amount(0.0)
                            .cardholderAmount(0.0)
                            .currency("xxx")
                            .currencyExponent(0.0)
                            .dateTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .type(ThreeDSAuthentication.Transaction.Type.ACCOUNT_FUNDING)
                            .build()
                    )
                    .eventType(
                        ThreeDSAuthenticationApprovalRequestWebhookEvent.EventType
                            .THREE_DS_AUTHENTICATION_APPROVAL_REQUEST
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDisputeTransactionCreated() {
        val disputeTransactionCreated =
            DisputeTransactionCreatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .caseId("case_id")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("USD")
                .disposition(DisputeV2.Disposition.WON)
                .addEvent(
                    DisputeV2.Event.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .data(
                            DisputeV2.Event.Data.WorkflowEventData.builder()
                                .action(DisputeV2.Event.Data.WorkflowEventData.Action.OPENED)
                                .amount(0L)
                                .disposition(DisputeV2.Event.Data.WorkflowEventData.Disposition.WON)
                                .reason("reason")
                                .stage(DisputeV2.Event.Data.WorkflowEventData.Stage.CLAIM)
                                .type(DisputeV2.Event.Data.WorkflowEventData.Type.WORKFLOW)
                                .build()
                        )
                        .type(DisputeV2.Event.Type.WORKFLOW)
                        .build()
                )
                .liabilityAllocation(
                    DisputeV2.LiabilityAllocation.builder()
                        .deniedAmount(0L)
                        .originalAmount(0L)
                        .recoveredAmount(0L)
                        .remainingAmount(0L)
                        .writtenOffAmount(0L)
                        .build()
                )
                .merchant(
                    Merchant.builder()
                        .acceptorId("333301802529120")
                        .acquiringInstitutionId("191231")
                        .city("NEW YORK")
                        .country("USA")
                        .descriptor("COFFEE SHOP")
                        .mcc("5812")
                        .state("NY")
                        .build()
                )
                .network(DisputeV2.Network.VISA)
                .status(DisputeV2.Status.OPEN)
                .transactionSeries(
                    DisputeV2.TransactionSeries.builder()
                        .relatedTransactionEventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .relatedTransactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .type(DisputeV2.TransactionSeries.Type.DISPUTE)
                        .build()
                )
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventType(
                    DisputeTransactionCreatedWebhookEvent.EventType.DISPUTE_TRANSACTION_CREATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDisputeTransactionCreated(disputeTransactionCreated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated())
            .contains(disputeTransactionCreated)
        assertThat(parsedWebhookEvent.disputeTransactionUpdated()).isEmpty
    }

    @Test
    fun ofDisputeTransactionCreatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDisputeTransactionCreated(
                DisputeTransactionCreatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .caseId("case_id")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("USD")
                    .disposition(DisputeV2.Disposition.WON)
                    .addEvent(
                        DisputeV2.Event.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .data(
                                DisputeV2.Event.Data.WorkflowEventData.builder()
                                    .action(DisputeV2.Event.Data.WorkflowEventData.Action.OPENED)
                                    .amount(0L)
                                    .disposition(
                                        DisputeV2.Event.Data.WorkflowEventData.Disposition.WON
                                    )
                                    .reason("reason")
                                    .stage(DisputeV2.Event.Data.WorkflowEventData.Stage.CLAIM)
                                    .type(DisputeV2.Event.Data.WorkflowEventData.Type.WORKFLOW)
                                    .build()
                            )
                            .type(DisputeV2.Event.Type.WORKFLOW)
                            .build()
                    )
                    .liabilityAllocation(
                        DisputeV2.LiabilityAllocation.builder()
                            .deniedAmount(0L)
                            .originalAmount(0L)
                            .recoveredAmount(0L)
                            .remainingAmount(0L)
                            .writtenOffAmount(0L)
                            .build()
                    )
                    .merchant(
                        Merchant.builder()
                            .acceptorId("333301802529120")
                            .acquiringInstitutionId("191231")
                            .city("NEW YORK")
                            .country("USA")
                            .descriptor("COFFEE SHOP")
                            .mcc("5812")
                            .state("NY")
                            .build()
                    )
                    .network(DisputeV2.Network.VISA)
                    .status(DisputeV2.Status.OPEN)
                    .transactionSeries(
                        DisputeV2.TransactionSeries.builder()
                            .relatedTransactionEventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .relatedTransactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .type(DisputeV2.TransactionSeries.Type.DISPUTE)
                            .build()
                    )
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .eventType(
                        DisputeTransactionCreatedWebhookEvent.EventType.DISPUTE_TRANSACTION_CREATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    @Test
    fun ofDisputeTransactionUpdated() {
        val disputeTransactionUpdated =
            DisputeTransactionUpdatedWebhookEvent.builder()
                .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                .caseId("case_id")
                .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .currency("USD")
                .disposition(DisputeV2.Disposition.WON)
                .addEvent(
                    DisputeV2.Event.builder()
                        .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                        .data(
                            DisputeV2.Event.Data.WorkflowEventData.builder()
                                .action(DisputeV2.Event.Data.WorkflowEventData.Action.OPENED)
                                .amount(0L)
                                .disposition(DisputeV2.Event.Data.WorkflowEventData.Disposition.WON)
                                .reason("reason")
                                .stage(DisputeV2.Event.Data.WorkflowEventData.Stage.CLAIM)
                                .type(DisputeV2.Event.Data.WorkflowEventData.Type.WORKFLOW)
                                .build()
                        )
                        .type(DisputeV2.Event.Type.WORKFLOW)
                        .build()
                )
                .liabilityAllocation(
                    DisputeV2.LiabilityAllocation.builder()
                        .deniedAmount(0L)
                        .originalAmount(0L)
                        .recoveredAmount(0L)
                        .remainingAmount(0L)
                        .writtenOffAmount(0L)
                        .build()
                )
                .merchant(
                    Merchant.builder()
                        .acceptorId("333301802529120")
                        .acquiringInstitutionId("191231")
                        .city("NEW YORK")
                        .country("USA")
                        .descriptor("COFFEE SHOP")
                        .mcc("5812")
                        .state("NY")
                        .build()
                )
                .network(DisputeV2.Network.VISA)
                .status(DisputeV2.Status.OPEN)
                .transactionSeries(
                    DisputeV2.TransactionSeries.builder()
                        .relatedTransactionEventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .relatedTransactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                        .type(DisputeV2.TransactionSeries.Type.DISPUTE)
                        .build()
                )
                .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventType(
                    DisputeTransactionUpdatedWebhookEvent.EventType.DISPUTE_TRANSACTION_UPDATED
                )
                .build()

        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDisputeTransactionUpdated(disputeTransactionUpdated)

        assertThat(parsedWebhookEvent.accountHolderCreated()).isEmpty
        assertThat(parsedWebhookEvent.kybPayload()).isEmpty
        assertThat(parsedWebhookEvent.kycPayload()).isEmpty
        assertThat(parsedWebhookEvent.legacyPayload()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderVerification()).isEmpty
        assertThat(parsedWebhookEvent.accountHolderDocumentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardAuthorizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationDecisioningRequest()).isEmpty
        assertThat(parsedWebhookEvent.authRulesBacktestReportCreated()).isEmpty
        assertThat(parsedWebhookEvent.balanceUpdated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.bookTransferTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardConverted()).isEmpty
        assertThat(parsedWebhookEvent.cardRenewed()).isEmpty
        assertThat(parsedWebhookEvent.cardReissued()).isEmpty
        assertThat(parsedWebhookEvent.cardShipped()).isEmpty
        assertThat(parsedWebhookEvent.cardUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataCreated()).isEmpty
        assertThat(parsedWebhookEvent.cardTransactionEnhancedDataUpdated()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCode())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationTwoFactorAuthenticationCodeSent())
            .isEmpty
        assertThat(parsedWebhookEvent.digitalWalletTokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.disputeEvidenceUploadFailed()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalBankAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentCreated()).isEmpty
        assertThat(parsedWebhookEvent.externalPaymentUpdated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountCreated()).isEmpty
        assertThat(parsedWebhookEvent.financialAccountUpdated()).isEmpty
        assertThat(parsedWebhookEvent.fundingEventCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeCreated()).isEmpty
        assertThat(parsedWebhookEvent.loanTapeUpdated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationCreated()).isEmpty
        assertThat(parsedWebhookEvent.managementOperationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.internalTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalCreated()).isEmpty
        assertThat(parsedWebhookEvent.networkTotalUpdated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.paymentTransactionUpdated()).isEmpty
        assertThat(parsedWebhookEvent.settlementReportUpdated()).isEmpty
        assertThat(parsedWebhookEvent.statementsCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationCreated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationChallenge()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationResult()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCode()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationTwoFactorAuthenticationCodeSent()).isEmpty
        assertThat(parsedWebhookEvent.tokenizationUpdated()).isEmpty
        assertThat(parsedWebhookEvent.threeDSAuthenticationApprovalRequest()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionCreated()).isEmpty
        assertThat(parsedWebhookEvent.disputeTransactionUpdated())
            .contains(disputeTransactionUpdated)
    }

    @Test
    fun ofDisputeTransactionUpdatedRoundtrip() {
        val jsonMapper = jsonMapper()
        val parsedWebhookEvent =
            ParsedWebhookEvent.ofDisputeTransactionUpdated(
                DisputeTransactionUpdatedWebhookEvent.builder()
                    .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .accountToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .cardToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                    .caseId("case_id")
                    .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .currency("USD")
                    .disposition(DisputeV2.Disposition.WON)
                    .addEvent(
                        DisputeV2.Event.builder()
                            .token("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .created(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                            .data(
                                DisputeV2.Event.Data.WorkflowEventData.builder()
                                    .action(DisputeV2.Event.Data.WorkflowEventData.Action.OPENED)
                                    .amount(0L)
                                    .disposition(
                                        DisputeV2.Event.Data.WorkflowEventData.Disposition.WON
                                    )
                                    .reason("reason")
                                    .stage(DisputeV2.Event.Data.WorkflowEventData.Stage.CLAIM)
                                    .type(DisputeV2.Event.Data.WorkflowEventData.Type.WORKFLOW)
                                    .build()
                            )
                            .type(DisputeV2.Event.Type.WORKFLOW)
                            .build()
                    )
                    .liabilityAllocation(
                        DisputeV2.LiabilityAllocation.builder()
                            .deniedAmount(0L)
                            .originalAmount(0L)
                            .recoveredAmount(0L)
                            .remainingAmount(0L)
                            .writtenOffAmount(0L)
                            .build()
                    )
                    .merchant(
                        Merchant.builder()
                            .acceptorId("333301802529120")
                            .acquiringInstitutionId("191231")
                            .city("NEW YORK")
                            .country("USA")
                            .descriptor("COFFEE SHOP")
                            .mcc("5812")
                            .state("NY")
                            .build()
                    )
                    .network(DisputeV2.Network.VISA)
                    .status(DisputeV2.Status.OPEN)
                    .transactionSeries(
                        DisputeV2.TransactionSeries.builder()
                            .relatedTransactionEventToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .relatedTransactionToken("182bd5e5-6e1a-4fe4-a799-aa6d9a6ab26e")
                            .type(DisputeV2.TransactionSeries.Type.DISPUTE)
                            .build()
                    )
                    .updated(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                    .eventType(
                        DisputeTransactionUpdatedWebhookEvent.EventType.DISPUTE_TRANSACTION_UPDATED
                    )
                    .build()
            )

        val roundtrippedParsedWebhookEvent =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(parsedWebhookEvent),
                jacksonTypeRef<ParsedWebhookEvent>(),
            )

        assertThat(roundtrippedParsedWebhookEvent).isEqualTo(parsedWebhookEvent)
    }

    enum class IncompatibleJsonShapeTestCase(val value: JsonValue) {
        BOOLEAN(JsonValue.from(false)),
        STRING(JsonValue.from("invalid")),
        INTEGER(JsonValue.from(-1)),
        FLOAT(JsonValue.from(3.14)),
        ARRAY(JsonValue.from(listOf("invalid", "array"))),
    }

    @ParameterizedTest
    @EnumSource
    fun incompatibleJsonShapeDeserializesToUnknown(testCase: IncompatibleJsonShapeTestCase) {
        val parsedWebhookEvent =
            jsonMapper().convertValue(testCase.value, jacksonTypeRef<ParsedWebhookEvent>())

        val e = assertThrows<LithicInvalidDataException> { parsedWebhookEvent.validate() }
        assertThat(e).hasMessageStartingWith("Unknown ")
    }
}
